[
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My agent policy\",\"enabled\":true,\"hostTags\":[\"env:staging\"],\"name\":\"testupdateaworkloadprotectionagentrulereturnsnotfoundresponse1760630600\"},\"type\":\"policy\"}}"
      },
      "headers": {},
      "method": "POST",
      "path": "/api/v2/remote_config/products/cws/policy",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"data\":{\"id\":\"9yd-fit-o2r\",\"type\":\"policy\",\"attributes\":{\"blockingRulesCount\":0,\"datadogManaged\":false,\"description\":\"My agent policy\",\"disabledRulesCount\":1,\"enabled\":true,\"hostTagsLists\":[[\"env:staging\"]],\"monitoringRulesCount\":7,\"name\":\"testupdateaworkloadprotectionagentrulereturnsnotfoundresponse1760630600\",\"pinned\":false,\"policyVersion\":\"1\",\"ruleCount\":8,\"updateDate\":1760630601105,\"updater\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"}}}}",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 200,
      "reasonPhrase": "OK"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "08f6646f-316b-0234-e1cd-a4cdde5b4b57"
  },
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name == \\\"sh\\\"\",\"policy_id\":\"9yd-fit-o2r\",\"product_tags\":[]},\"id\":\"non-existent-rule-id\",\"type\":\"agent_rule\"}}"
      },
      "headers": {},
      "method": "PATCH",
      "path": "/api/v2/remote_config/products/cws/agent_rules/non-existent-rule-id",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"errors\":[{\"title\":\"failed to update rule\"}]}\n",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 404,
      "reasonPhrase": "Not Found"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "dc9e589a-7937-fe03-22c1-fe6ea94e10c1"
  },
  {
    "httpRequest": {
      "headers": {},
      "method": "DELETE",
      "path": "/api/v2/remote_config/products/cws/policy/9yd-fit-o2r",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 204,
      "reasonPhrase": "No Content"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "8c5e1a2b-6108-14db-18e0-92a612c35f6b"
  }
]