[
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My agent policy\",\"enabled\":true,\"hostTags\":[\"env:staging\"],\"name\":\"testupdateaworkloadprotectionagentrulereturnsbadrequestresponse1749644133\"},\"type\":\"policy\"}}"
      },
      "headers": {},
      "method": "POST",
      "path": "/api/v2/remote_config/products/cws/policy",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"data\":{\"id\":\"kle-vun-qmy\",\"type\":\"policy\",\"attributes\":{\"blockingRulesCount\":0,\"datadogManaged\":false,\"description\":\"My agent policy\",\"disabledRulesCount\":1,\"enabled\":true,\"hostTags\":[\"env:staging\"],\"monitoringRulesCount\":225,\"name\":\"testupdateaworkloadprotectionagentrulereturnsbadrequestresponse1749644133\",\"policyVersion\":\"1\",\"priority\":1000000013,\"ruleCount\":226,\"updateDate\":1749644133394,\"updater\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"}}}}",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 200,
      "reasonPhrase": "OK"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "4a4039ce-b3fd-7b7a-22a8-bba87e77ea57"
  },
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"actions\":[{\"hash\":{},\"set\":{\"name\":\"test_set\",\"scope\":\"process\",\"value\":\"test_value\"}}],\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name == \\\"sh\\\"\",\"name\":\"testupdateaworkloadprotectionagentrulereturnsbadrequestresponse1749644133\",\"policy_id\":\"kle-vun-qmy\",\"product_tags\":[\"security:attack\",\"technique:T1059\"]},\"type\":\"agent_rule\"}}"
      },
      "headers": {},
      "method": "POST",
      "path": "/api/v2/remote_config/products/cws/agent_rules",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"data\":{\"id\":\"dbf-bvb-57b\",\"type\":\"agent_rule\",\"attributes\":{\"actions\":[{\"hash\":{},\"set\":{\"name\":\"test_set\",\"value\":\"test_value\",\"scope\":\"process\"},\"disabled\":false}],\"category\":\"Process Activity\",\"creationDate\":1749644133847,\"creator\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"},\"defaultRule\":false,\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name == \\\"sh\\\"\",\"filters\":[\"os == \\\"linux\\\"\"],\"monitoring\":[\"kle-vun-qmy\"],\"name\":\"testupdateaworkloadprotectionagentrulereturnsbadrequestresponse1749644133\",\"product_tags\":[\"security:attack\",\"technique:T1059\"],\"updateDate\":1749644133847,\"updater\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"}}}}",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 200,
      "reasonPhrase": "OK"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "a55482d7-2805-ad42-2b99-703fc4494728"
  },
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name == \\\"sh\\\"\",\"policy_id\":\"kle-vun-qmy\",\"product_tags\":[]},\"id\":\"invalid-agent-rule-id\",\"type\":\"agent_rule\"}}"
      },
      "headers": {},
      "method": "PATCH",
      "path": "/api/v2/remote_config/products/cws/agent_rules/dbf-bvb-57b",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"errors\":[{\"title\":\"failed to update rule\"}]}\n",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 400,
      "reasonPhrase": "Bad Request"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "da7fa472-1c3b-b2bc-88a4-7970884e3249"
  },
  {
    "httpRequest": {
      "headers": {},
      "method": "DELETE",
      "path": "/api/v2/remote_config/products/cws/agent_rules/dbf-bvb-57b",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 204,
      "reasonPhrase": "No Content"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "77029a50-9654-cd79-7b8f-6ecf21885e42"
  },
  {
    "httpRequest": {
      "headers": {},
      "method": "DELETE",
      "path": "/api/v2/remote_config/products/cws/policy/kle-vun-qmy",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 204,
      "reasonPhrase": "No Content"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "30192b88-7a8a-4081-025e-ed4ef2881ab8"
  }
]