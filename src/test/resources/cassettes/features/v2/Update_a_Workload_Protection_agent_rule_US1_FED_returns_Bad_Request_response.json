[
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name == \\\"sh\\\"\",\"name\":\"testupdateaworkloadprotectionagentruleus1fedreturnsbadrequestresponse1748342045\"},\"type\":\"agent_rule\"}}"
      },
      "headers": {},
      "method": "POST",
      "path": "/api/v2/security_monitoring/cloud_workload_security/agent_rules",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"data\":{\"id\":\"q58-cpj-dtw\",\"attributes\":{\"version\":1,\"name\":\"testupdateaworkloadprotectionagentruleus1fedreturnsbadrequestresponse1748342045\",\"description\":\"My Agent rule\",\"expression\":\"exec.file.name == \\\"sh\\\"\",\"category\":\"Process Activity\",\"defaultRule\":false,\"enabled\":true,\"creationAuthorUuId\":\"3ad549bf-eba0-11e9-a77a-0705486660d0\",\"creationDate\":1748342046325,\"updateAuthorUuId\":\"3ad549bf-eba0-11e9-a77a-0705486660d0\",\"updateDate\":1748342046325,\"filters\":[\"os == \\\"linux\\\"\"],\"actions\":[],\"agentConstraint\":\"\",\"creator\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"},\"updater\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"}},\"type\":\"agent_rule\"}}\n",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 200,
      "reasonPhrase": "OK"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "df2a89a9-53a5-2e52-e11f-6336eeef6ae0"
  },
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name\"},\"id\":\"q58-cpj-dtw\",\"type\":\"agent_rule\"}}"
      },
      "headers": {},
      "method": "PATCH",
      "path": "/api/v2/security_monitoring/cloud_workload_security/agent_rules/q58-cpj-dtw",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"errors\":[\"input_validation_error(Field 'expression' is invalid: rule `testupdateaworkloadprotectionagentruleus1fedreturnsbadrequestresponse1748342045` error: rule syntax error: bool expected: 1:1: exec.file.name\\n^)\"]}\n",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 400,
      "reasonPhrase": "Bad Request"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "41b73a56-8de9-33f8-a008-5563e6480511"
  },
  {
    "httpRequest": {
      "headers": {},
      "method": "DELETE",
      "path": "/api/v2/security_monitoring/cloud_workload_security/agent_rules/q58-cpj-dtw",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "headers": {},
      "statusCode": 204,
      "reasonPhrase": "No Content"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "bc04a17a-c603-a789-de9d-e3426c6e934d"
  }
]