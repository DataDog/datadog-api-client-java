[
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name == \\\"sh\\\"\",\"name\":\"testupdateaworkloadprotectionagentruleus1fedreturnsbadrequestresponse1747319690\"},\"type\":\"agent_rule\"}}"
      },
      "headers": {},
      "method": "POST",
      "path": "/api/v2/security_monitoring/cloud_workload_security/agent_rules",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"data\":{\"id\":\"qny-a5d-mul\",\"attributes\":{\"version\":1,\"name\":\"testupdateaworkloadprotectionagentruleus1fedreturnsbadrequestresponse1747319690\",\"description\":\"My Agent rule\",\"expression\":\"exec.file.name == \\\"sh\\\"\",\"category\":\"Process Activity\",\"defaultRule\":false,\"enabled\":true,\"creationAuthorUuId\":\"3ad549bf-eba0-11e9-a77a-0705486660d0\",\"creationDate\":1747319690855,\"updateAuthorUuId\":\"3ad549bf-eba0-11e9-a77a-0705486660d0\",\"updateDate\":1747319690855,\"filters\":[\"os == \\\"linux\\\"\"],\"actions\":[],\"agentConstraint\":\"\",\"creator\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"},\"updater\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"}},\"type\":\"agent_rule\"}}\n",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 200,
      "reasonPhrase": "OK"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "de32e4a7-c5db-021a-7243-d04f578629ee"
  },
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name\"},\"id\":\"qny-a5d-mul\",\"type\":\"agent_rule\"}}"
      },
      "headers": {},
      "method": "PATCH",
      "path": "/api/v2/security_monitoring/cloud_workload_security/agent_rules/qny-a5d-mul",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"errors\":[\"input_validation_error(Field 'expression' is invalid: rule `testupdateaworkloadprotectionagentruleus1fedreturnsbadrequestresponse1747319690` error: rule syntax error: bool expected: 1:1: exec.file.name\\n^)\"]}\n",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 400,
      "reasonPhrase": "Bad Request"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "f4568639-7bcd-2446-5f0f-cede781ec74f"
  },
  {
    "httpRequest": {
      "headers": {},
      "method": "DELETE",
      "path": "/api/v2/security_monitoring/cloud_workload_security/agent_rules/qny-a5d-mul",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "headers": {},
      "statusCode": 204,
      "reasonPhrase": "No Content"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "de15ac51-ce62-296a-f85b-56266b54bec7"
  }
]