[
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"description\":\"My agent policy\",\"enabled\":true,\"hostTags\":[\"env:staging\"],\"name\":\"testdeleteaworkloadprotectionagentrulereturnsokresponse1760109657\"},\"type\":\"policy\"}}"
      },
      "headers": {},
      "method": "POST",
      "path": "/api/v2/remote_config/products/cws/policy",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"data\":{\"id\":\"xm5-r6n-xej\",\"type\":\"policy\",\"attributes\":{\"blockingRulesCount\":0,\"datadogManaged\":false,\"description\":\"My agent policy\",\"disabledRulesCount\":1,\"enabled\":true,\"hostTagsLists\":[[\"env:staging\"]],\"monitoringRulesCount\":7,\"name\":\"testdeleteaworkloadprotectionagentrulereturnsokresponse1760109657\",\"pinned\":false,\"policyVersion\":\"1\",\"ruleCount\":8,\"updateDate\":1760109657799,\"updater\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"}}}}",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 200,
      "reasonPhrase": "OK"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "07d04524-e719-9bb0-c2e0-70df47a1df0d"
  },
  {
    "httpRequest": {
      "body": {
        "type": "JSON",
        "json": "{\"data\":{\"attributes\":{\"actions\":[{\"set\":{\"name\":\"test_set\",\"scope\":\"process\",\"value\":\"test_value\"}},{\"hash\":{}}],\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name == \\\"sh\\\"\",\"name\":\"testdeleteaworkloadprotectionagentrulereturnsokresponse1760109657\",\"policy_id\":\"xm5-r6n-xej\",\"product_tags\":[\"security:attack\",\"technique:T1059\"]},\"type\":\"agent_rule\"}}"
      },
      "headers": {},
      "method": "POST",
      "path": "/api/v2/remote_config/products/cws/agent_rules",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"data\":{\"id\":\"tpa-28k-utt\",\"type\":\"agent_rule\",\"attributes\":{\"actions\":[{\"set\":{\"name\":\"test_set\",\"value\":\"test_value\",\"scope\":\"process\",\"inherited\":false},\"disabled\":false},{\"hash\":{},\"disabled\":false}],\"category\":\"Process Activity\",\"creationDate\":1760109658753,\"creator\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"},\"defaultRule\":false,\"description\":\"My Agent rule\",\"enabled\":true,\"expression\":\"exec.file.name == \\\"sh\\\"\",\"filters\":[\"os == \\\"linux\\\"\"],\"monitoring\":[\"xm5-r6n-xej\"],\"name\":\"testdeleteaworkloadprotectionagentrulereturnsokresponse1760109657\",\"product_tags\":[\"security:attack\",\"technique:T1059\"],\"updateDate\":1760109658753,\"updater\":{\"name\":\"frog\",\"handle\":\"frog@datadoghq.com\"}}}}",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 200,
      "reasonPhrase": "OK"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "c51a1f05-9552-b3bf-5605-2b8e160538d0"
  },
  {
    "httpRequest": {
      "headers": {},
      "method": "DELETE",
      "path": "/api/v2/remote_config/products/cws/agent_rules/tpa-28k-utt",
      "queryStringParameters": {
        "policy_id": [
          "xm5-r6n-xej"
        ]
      },
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 204,
      "reasonPhrase": "No Content"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "dcbbdf77-372b-cefb-a9ec-ee7d58be98b8"
  },
  {
    "httpRequest": {
      "headers": {},
      "method": "DELETE",
      "path": "/api/v2/remote_config/products/cws/agent_rules/tpa-28k-utt",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "body": "{\"errors\":[{\"title\":\"failed to delete rule\"}]}\n",
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 404,
      "reasonPhrase": "Not Found"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "10229f44-9e9c-9aae-e93f-d931988dec62"
  },
  {
    "httpRequest": {
      "headers": {},
      "method": "DELETE",
      "path": "/api/v2/remote_config/products/cws/policy/xm5-r6n-xej",
      "keepAlive": false,
      "secure": true
    },
    "httpResponse": {
      "headers": {
        "Content-Type": [
          "application/json"
        ]
      },
      "statusCode": 204,
      "reasonPhrase": "No Content"
    },
    "times": {
      "remainingTimes": 1
    },
    "timeToLive": {
      "unlimited": true
    },
    "id": "fd029db4-c8a5-504b-52ce-b03f9053bb73"
  }
]