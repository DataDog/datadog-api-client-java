[{
  "id" : "51676b60-51fc-499e-99eb-126c0994954b",
  "httpRequest" : {
    "method" : "POST",
    "path" : "/api/v2/security_monitoring/rules",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "createSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "364" ]
    },
    "keepAlive" : false,
    "secure" : true,
    "body" : {
      "type" : "JSON",
      "json" : "{\"cases\":[{\"condition\":\"rule > 0\",\"name\":\"rule-case\",\"status\":\"info\"}],\"isEnabled\":true,\"message\":\"Rule message\",\"name\":\"java-rulesCrudTest-local-1606218304-0\",\"options\":{\"evaluationWindow\":0,\"keepAlive\":0,\"maxSignalDuration\":0},\"queries\":[{\"groupByFields\":[],\"name\":\"rule\",\"query\":\"java-rulesCrudTest-local-1606218304-0\"}],\"tags\":[\"datadog-api-client-test-java\"]}"
    }
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:06 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:06 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "FELlv8T8VRoaBxHjLbAG9Fvj68G6pP0FZF7JKMI72/5H4OtG/s8AVYiF1c9f4D6g" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "621" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218306750,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-0\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"j5h-rp0-iro\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-0\"}"
  }
}, {
  "id" : "d972d329-bed4-4c10-84d1-7f2fd1205c13",
  "httpRequest" : {
    "method" : "POST",
    "path" : "/api/v2/security_monitoring/rules",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "createSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "364" ]
    },
    "keepAlive" : false,
    "secure" : true,
    "body" : {
      "type" : "JSON",
      "json" : "{\"cases\":[{\"condition\":\"rule > 0\",\"name\":\"rule-case\",\"status\":\"info\"}],\"isEnabled\":true,\"message\":\"Rule message\",\"name\":\"java-rulesCrudTest-local-1606218304-1\",\"options\":{\"evaluationWindow\":0,\"keepAlive\":0,\"maxSignalDuration\":0},\"queries\":[{\"groupByFields\":[],\"name\":\"rule\",\"query\":\"java-rulesCrudTest-local-1606218304-1\"}],\"tags\":[\"datadog-api-client-test-java\"]}"
    }
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:07 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:07 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "92/tpeRQ0by9nn7WsSPyVyXsoLNu8gimYih2BuL6sJV2amfIFPaN8R5eGATyWG3E" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "621" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218307543,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-1\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"x9q-69c-tkx\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-1\"}"
  }
}, {
  "id" : "4139bf8f-1ad8-40d4-8d4c-7b103d833f4b",
  "httpRequest" : {
    "method" : "POST",
    "path" : "/api/v2/security_monitoring/rules",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "createSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "364" ]
    },
    "keepAlive" : false,
    "secure" : true,
    "body" : {
      "type" : "JSON",
      "json" : "{\"cases\":[{\"condition\":\"rule > 0\",\"name\":\"rule-case\",\"status\":\"info\"}],\"isEnabled\":true,\"message\":\"Rule message\",\"name\":\"java-rulesCrudTest-local-1606218304-2\",\"options\":{\"evaluationWindow\":0,\"keepAlive\":0,\"maxSignalDuration\":0},\"queries\":[{\"groupByFields\":[],\"name\":\"rule\",\"query\":\"java-rulesCrudTest-local-1606218304-2\"}],\"tags\":[\"datadog-api-client-test-java\"]}"
    }
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:08 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:08 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "mkUBxR9AT7fES9d8jomGHhjQo+QS6q6R/gxmujd5IzTAGUw8Yw9FrdECMNXXfuHz" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "621" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218308231,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-2\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ywc-kff-uw5\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-2\"}"
  }
}, {
  "id" : "01915eee-87ae-4312-bef1-a06294ec1971",
  "httpRequest" : {
    "method" : "POST",
    "path" : "/api/v2/security_monitoring/rules",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "createSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "364" ]
    },
    "keepAlive" : false,
    "secure" : true,
    "body" : {
      "type" : "JSON",
      "json" : "{\"cases\":[{\"condition\":\"rule > 0\",\"name\":\"rule-case\",\"status\":\"info\"}],\"isEnabled\":true,\"message\":\"Rule message\",\"name\":\"java-rulesCrudTest-local-1606218304-3\",\"options\":{\"evaluationWindow\":0,\"keepAlive\":0,\"maxSignalDuration\":0},\"queries\":[{\"groupByFields\":[],\"name\":\"rule\",\"query\":\"java-rulesCrudTest-local-1606218304-3\"}],\"tags\":[\"datadog-api-client-test-java\"]}"
    }
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:08 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:08 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "DMzWnlnvmcVWit+nOzgpRgMecUZPFvENKg8LkKYn4Tsj68gJTKm0BuKxCJH0FFN4" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "621" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218308743,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-3\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"k5k-uzk-gr8\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-3\"}"
  }
}, {
  "id" : "7b6f9720-2869-499f-939f-ce1fcae544f2",
  "httpRequest" : {
    "method" : "POST",
    "path" : "/api/v2/security_monitoring/rules",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "createSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "364" ]
    },
    "keepAlive" : false,
    "secure" : true,
    "body" : {
      "type" : "JSON",
      "json" : "{\"cases\":[{\"condition\":\"rule > 0\",\"name\":\"rule-case\",\"status\":\"info\"}],\"isEnabled\":true,\"message\":\"Rule message\",\"name\":\"java-rulesCrudTest-local-1606218304-4\",\"options\":{\"evaluationWindow\":0,\"keepAlive\":0,\"maxSignalDuration\":0},\"queries\":[{\"groupByFields\":[],\"name\":\"rule\",\"query\":\"java-rulesCrudTest-local-1606218304-4\"}],\"tags\":[\"datadog-api-client-test-java\"]}"
    }
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:09 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:09 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "1yK3PnBzCoxF/WGKEJeJqS2Jb9mutr3xDuvLdPbJCfX1HVDqeCXkaWYDO6wQpQhO" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "621" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218309270,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-4\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dcp-y6y-mpk\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-4\"}"
  }
}, {
  "id" : "130e25b8-e238-4503-84f6-f9fa0905c1b5",
  "httpRequest" : {
    "method" : "GET",
    "path" : "/api/v2/security_monitoring/rules/j5h-rp0-iro",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "getSecurityMonitoringRule" ],
      "Connection" : [ "close" ],
      "content-length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:09 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:09 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "8uM7lo6fgdRC0R8G89u29ss3GmR5rKsxJfYvyjSE9oa+oPL40dVup+1mn/0Ku0bY" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "621" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218306750,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-0\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"j5h-rp0-iro\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-0\"}"
  }
}, {
  "id" : "0c06d611-60f6-46b0-abdf-cc11683c07df",
  "httpRequest" : {
    "method" : "GET",
    "path" : "/api/v2/security_monitoring/rules",
    "queryStringParameters" : {
      "page[size]" : [ "1" ],
      "page[number]" : [ "0" ]
    },
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "listSecurityMonitoringRules" ],
      "Connection" : [ "close" ],
      "content-length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:10 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:10 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "kU8oLj3zrGL/NsMXNRXUrvjc5SX7m5Zi20YpnuFt2mcszekWqSDwHwhFasJc2aus" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "1827" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"meta\":{\"page\":{\"total_filtered_count\":1,\"total_count\":460}},\"data\":[{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0007-discovery\",\"technique:T1069-permission-groups-discovery\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is enumerating IAM principals.\\n\\n### Strategy\\nThis rule lets you leverage GuardDuty to detect when an attacker is enumerating IAM principals. The GuardDuty Findings which trigger this signal:\\n\\n* [Recon:IAMUser/NetworkPermissions][1]\\n* [Recon:IAMUser/ResourcePermissions][2]\\n* [Recon:IAMUser/UserPermissions][3] \\n\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon7\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon8\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon9\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276065,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(Recon\\\\:IAMUser\\\\/NetworkPermissions OR Recon\\\\:IAMUser\\\\/ResourcePermissions OR Recon\\\\:IAMUser\\\\/UserPermissions)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"u2j-xph-kc7\",\"isDefault\":true,\"name\":\"AWS IAM principal enumeration\"}]}"
  }
}, {
  "id" : "3ed66fac-519d-4a3f-9dfe-782dd860bdaf",
  "httpRequest" : {
    "method" : "GET",
    "path" : "/api/v2/security_monitoring/rules",
    "queryStringParameters" : {
      "page[size]" : [ "460" ]
    },
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "listSecurityMonitoringRules" ],
      "Connection" : [ "close" ],
      "content-length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:11 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:11 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "RquGBod+QwJwo5jKyeuGJHvfWvWfZ0hMpUnxtqqEEEpqySzsuyt8sx6iN5riB0bK" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "748127" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"meta\":{\"page\":{\"total_filtered_count\":460,\"total_count\":460}},\"data\":[{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0007-discovery\",\"technique:T1069-permission-groups-discovery\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is enumerating IAM principals.\\n\\n### Strategy\\nThis rule lets you leverage GuardDuty to detect when an attacker is enumerating IAM principals. The GuardDuty Findings which trigger this signal:\\n\\n* [Recon:IAMUser/NetworkPermissions][1]\\n* [Recon:IAMUser/ResourcePermissions][2]\\n* [Recon:IAMUser/UserPermissions][3] \\n\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon7\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon8\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon9\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276065,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(Recon\\\\:IAMUser\\\\/NetworkPermissions OR Recon\\\\:IAMUser\\\\/ResourcePermissions OR Recon\\\\:IAMUser\\\\/UserPermissions)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"u2j-xph-kc7\",\"isDefault\":true,\"name\":\"AWS IAM principal enumeration\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1496-resource-hijacking\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is communicating with a cryptocurrency server\\n\\n### Strategy\\nThis rule lets you leverage GuardDuty to detect when an EC2 instance has made a DNS request or is communicating with an IP that is associated with cryptocurrency operations. The following GuardDuty Findings trigger this signal:\\n\\n* [CryptoCurrency:EC2/BitcoinTool.B!DNS][1]\\n* [CryptoCurrency:EC2/BitcoinTool.B][2]\\n\\n\\n### Triage & Response\\n1. Determine which domain name or IP address triggered the signal. This can be found in the samples. \\n2. If the domain or IP address should not have been requested, open a security investigation, and determine which process requested the domain name or IP address.\\n\\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_crypto.html#crypto3\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_crypto.html#crypto4\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276326,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(CryptoCurrency\\\\:EC2\\\\/BitcoinTool.B\\\\!DNS OR CryptoCurrency\\\\:EC2\\\\/BitcoinTool.B)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ky3-ds4-ipb\",\"isDefault\":true,\"name\":\"AWS EC2 instance communicating with a cryptocurrency server\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1485-data-destruction\",\"source:cloudtrail\",\"scope:rds\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is destroying a RDS Cluster.\\n\\n### Strategy\\nThis rule lets you monitor this CloudTrail API call to detect if an attacker is deleting a RDS cluster:\\n\\n* [DeleteDBCluster][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/cli/latest/reference/rds/delete-db-cluster.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276546,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:DeleteDBCluster\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"6ng-pk1-ukh\",\"isDefault\":true,\"name\":\"AWS RDS Cluster deleted\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0006-credential-access\",\"technique:T1110-brute-force\",\"scope:template\"],\"isEnabled\":false,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect Account Take Over (ATO) through brute force attempts\\n\\n### Strategy\\nTo determine a successful attempt: Detect a high amount of failed logins and at least one successful login for a given user. This will generate a `HIGH` severity signal.\\nTo determine an attempt: Detect a high amount of failed logins. This will generate an `INFO` severity signal.\\n\\n### Triage & Response\\n1. Inspect the logs to see if this was a valid login attempt.\\n2. See if 2FA was authenticated.\\n3. If the user was compromised, rotate user credentials.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":7200,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276794,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"failed_login\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.name\"],\"query\":\"@evt.name:authentication @evt.outcome:failure @usr.name:*\",\"trackType\":\"logs\"},{\"distinctFields\":[],\"name\":\"successful_login\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.name\"],\"query\":\"@evt.name:authentication @evt.outcome:success @usr.name:*\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[\"@slack-secops\"],\"name\":\"Successful\",\"condition\":\"failed_login > 50 && successful_login > 0\"},{\"status\":\"info\",\"notifications\":[\"@slack-secops\"],\"name\":\"Attempt\",\"condition\":\"failed_login > 5\"}],\"type\":\"threshold\",\"id\":\"jhi-klp-smm\",\"isDefault\":true,\"name\":\"TEMPLATE - Brute Force Attack Grouped By User\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0005-defense-evasion\",\"technique:T1089-disabling-security-tools\",\"source:cloudtrail\",\"scope:eventbridge\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is trying to evade defenses by deleting or disabling EventBridge rules.\\n\\n### Strategy\\nThis rule lets you monitor these CloudTrail API calls to detect if an attacker is modifying or disabling EventBridge rules:\\n\\n* [DeleteRule][1]\\n* [DisableRule][2]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_DeleteRule.html\\n[2]: https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_DisableRule.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870277044,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(DeleteRule OR DisableRule)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"mq6-cjx-h9o\",\"isDefault\":true,\"name\":\"AWS EventBridge rule disabled or deleted\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0005-defense-evasion\",\"technique:T1066-indicator-removal-from-tools\",\"source:cloudtrail\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is removing FlowLogs to cover their tracks.\\n\\n### Strategy\\nThis rule lets you monitor this CloudTrail API call to detect if an attacker is deleting FlowLogs:\\n\\n* [DeleteFlowLogs][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteFlowLogs.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870278493,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:DeleteFlowLogs\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"cws-b4f-uoh\",\"isDefault\":true,\"name\":\"AWS FlowLogs removed\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0005-defense-evasion\",\"technique:T1089-disabling-security-tools\",\"source:cloudtrail\",\"scope:guardduty\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is trying to evade defenses by deleting a GuardDuty detector.\\n\\n### Strategy\\nThis rule lets you monitor this CloudTrail API call to detect if an attacker is deleting a GuardDuty Detector:\\n\\n* [DeleteDetector][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/delete-detector.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870279177,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:DeleteDetector\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"pzi-led-yyc\",\"isDefault\":true,\"name\":\"AWS GuardDuty detector deleted\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1485-data-destruction\",\"source:cloudtrail\",\"scope:ecs\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is destroying an ECS Cluster\\n\\n### Strategy\\nThis rule lets you monitor this CloudTrail API call to detect if an ECS cluster is deleted:\\n\\n* [DeleteCluster][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_DeleteCluster.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870279810,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:DeleteCluster\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"vwu-6id-9lz\",\"isDefault\":true,\"name\":\"AWS ECS cluster deleted\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"source:cloudtrail\",\"scope:s3\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when the S3 Public Access Block configuration has been removed \\n\\n### Strategy\\nThis rule lets you monitor this CloudTrail API call to detect if an attacker is deleting the S3 Public Access Block configuration:\\n\\n* [DeleteAccountPublicAccessBlock][1]\\n\\n### Triage & Response\\n1. Determine who the user was who made this API call.\\n2. Contact the user and inform them of best practices of enabling Public Access Block on S3 buckets.\\n3. Re-enable Public Access Block on the S3 bucket.\\n\\nMore details on S3 Public Block Public Access can be found [here][2].\\n\\n[1]: https://docs.aws.amazon.com/cli/latest/reference/s3api/delete-public-access-block.html\\n[2]: https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870280316,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:DeleteAccountPublicAccessBlock\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"uxr-5wk-8hk\",\"isDefault\":true,\"name\":\"AWS S3 Public Access Block removed\"},{\"creationAuthorId\":0,\"tags\":[\"security:threat-intel\",\"source:gsuite\",\"scope:gsuite\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a user attempts to log in with a password which is known to be compromised.\\n\\n### Strategy\\nThis rule allows you to monitor this Google Activity API call to detect if an attacker is trying to login with a leaked password: \\n\\n* [Leaked password][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the compromised password.\\n2. Contact the user and ensure they rotate the password on Google and any other accounts where they may have reused this password. Ensure the user is aware of strong password guidelines.\\n\\n[1]: https://developers.google.com/admin-sdk/reports/v1/appendix/activity/login#account_disabled_password_leak\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870280553,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@actor.email\"],\"query\":\"source:gsuite @event.type:account_warning @event.name:account_disabled_password_leak\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"9zi-bom-nmh\",\"isDefault\":true,\"name\":\"User attempted login with leaked password\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.14\",\"source:cloudtrail\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is destroying a VPC.\\n\\n### Strategy\\nThis rule lets you monitor this CloudTrail API call to detect if an attacker is deleting a VPC:\\n\\n* [DeleteVpc][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/cli/latest/reference/ec2/delete-vpc.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1585870280906,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(DeleteVpc OR CreateVpc OR ModifyVpcAttribute OR AcceptVpcPeeringConnection OR CreateVpcPeeringConnection OR DeleteVpcPeeringConnection OR RejectVpcPeeringConnection OR  AttachClassicLinkVpc OR  DetachClassicLinkVpc OR DisableVpcClassicLink OR EnableVpcClassicLink)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"igj-dr4-ico\",\"isDefault\":true,\"name\":\"AWS VPC created or modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0007-discovery\",\"technique:T1083-file-and-directory-discovery\",\"source:cloudtrail\",\"scope:s3\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance makes an API call to AWS to list all of the S3 Buckets.\\n\\n### Strategy\\nThis rule lets you monitor CloudTrail to detect a [ListBuckets][1] API call with the session name prefixed with `i-`. A session name prefixed with `i-` typically indicates that it is an EC2 instance using an [Instance Profile][2] to communicate with other AWS services, which is a common attacker technique to see the full list of S3 buckets in your AWS account.\\n Determine if the EC2 instance should be making this API call. \\n* If not, rotate the credentials, verify what else may have been accessed and open an investigation into how this instance was compromised.\\n   * If the application or legitimate user on the EC2 instance is making the `ListBuckets` API call, consider whether this API call is really needed.  \\n\\n[1]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListBuckets.html\\n[2]: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html#ec2-instance-profile\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870281123,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @userIdentity.session_name:i-* @evt.name:ListBuckets\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"t6r-kqt-hxb\",\"isDefault\":true,\"name\":\"AWS S3 Buckets enumerated\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.3\",\"source:cloudtrail\",\"scope:amazon\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect AWS root user activity. \\n\\n### Strategy\\nMonitor CloudTrail and detect when any `@userIdentity.type` has a value of `Root`, but is not invoked by an AWS service.\\n\\n### Triage & Response\\n1. Reach out to the user to determine if the login was legitimate. \\n2. If the login wasn't legitimate, rotate the credentials, enable 2FA, and open an investigation. \\n\\nFor best practices, check out the [AWS Root Account Best Practices][1] documentation.\\n\\n[1]: https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html\",\"options\":{\"evaluationWindow\":900,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":3,\"createdAt\":1585870281964,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:cloudtrail @userIdentity.type:Root  -@userIdentity.invokedBy:*  -@eventType:AwsServiceEvent\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"2kn-z6k-6kf\",\"isDefault\":true,\"name\":\"AWS root account activity\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1485-data-destruction\",\"source:cloudtrail\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is destroying an EC2 subnet.\\n\\n### Strategy\\nThis rule lets you monitor this CloudTrail API call to detect if an attacker is deleting an EC2 subnet.\\n\\n* [DeleteSubnet][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/cli/latest/reference/ec2/delete-subnet.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870282197,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:DeleteSubnet\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ygi-fi5-qns\",\"isDefault\":true,\"name\":\"AWS EC2 subnet deleted\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.9\",\"source:cloudtrail\",\"scope:amazon-config\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is trying to evade defenses by disabling an AWS configuration.\\n\\n### Strategy\\nThis rule lets you monitor these CloudTrail API calls to detect if an attacker is trying to stop recording configurations of your AWS resources or trying to delete a delivery channel:\\n\\n* [StopConfigurationRecorder][1] \\n* [DeleteDeliveryChannel][2] \\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html\\n[2]: https://docs.aws.amazon.com/config/latest/APIReference/API_DeleteDeliveryChannel.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1585870283149,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(StopConfigurationRecorder OR DeleteDeliveryChannel OR PutDeliveryChannel OR PutConfigurationRecorder)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"p1b-9np-rw1\",\"isDefault\":true,\"name\":\"AWS config modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:threat-intel\",\"scope:template\"],\"isEnabled\":false,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a stolen laptop has been connected to the network.\\n\\n### Strategy\\nUsing the Datadog [Lookup Processor](https://docs.datadoghq.com/logs/processing/processors/?tab=ui#lookup-processor) you can maintain a blocklist of MAC addresses.\\nWhen a MAC address connects to the network, the @threat.stolen_laptop attribute is set to `true`.\\nThis threat detection rule queries for `@threat.stolen_laptop:true` and generates a security signal. \\n\\n### Triage & Response\\nEnter your triage and response process for when a stolen laptop has connected to your network to help users responding to the security signal quickly triage and respond to the signal. \\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870283379,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.mac\"],\"query\":\"@threat.stolen_laptop:true @network.client.mac:*\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ap3-xy9-tsm\",\"isDefault\":true,\"name\":\"TEMPLATE - Stolen Laptop Connected to Network\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0006-credential-access\",\"technique:T1110-brute-force\"],\"isEnabled\":false,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect an account take over (ATO) through brute force attempts.\\n\\n### Strategy\\nTo determine a successful attempt: Detect a high amount of failed logins and at least one successful login for a given IP address. This will generate a `HIGH` severity signal.\\nTo determine an attempt: Detect a high amount of failed logins for a given IP address. This will generate an `INFO severity signal.\\n\\n### Triage & Response\\n1. Inspect the logs to see if this was a valid login attempt.\\n2. See if 2FA was authenticated.\\n3. If the user was compromised, rotate user credentials.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":7200,\"keepAlive\":3600},\"version\":1,\"createdAt\":1585870283641,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.name\"],\"query\":\"@evt.name:authentication @evt.outcome:failure\",\"trackType\":\"logs\"},{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.name\"],\"query\":\"@evt.name:authentication @evt.outcome:success\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[\"@slack-secops\"],\"name\":\"Successful\",\"condition\":\"a>5 && b>0\"},{\"status\":\"info\",\"notifications\":[],\"name\":\"Attempted\",\"condition\":\"a>5\"}],\"type\":\"threshold\",\"id\":\"wce-cxo-pe4\",\"isDefault\":true,\"name\":\"TEMPLATE - Brute Force Attack Grouped By IP\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.5\",\"source:cloudtrail\",\"scope:cloudtrail\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is trying to evade defenses by disabling or modifying CloudTrail.\\n\\n### Strategy\\nThis rule lets you monitor these CloudTrail API calls to detect if an attacker is modifying or disabling CloudTrail:\\n\\n* [DeleteTrail][1]\\n* [UpdateTrail][2]\\n* [StopLogging][3]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_DeleteTrail.html\\n[2]: https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_UpdateTrail.html\\n[3]: https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_StopLogging.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1585870283907,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(DeleteTrail OR UpdateTrail OR StopLogging OR CreateTrail OR StartLogging)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"4hv-083-miw\",\"isDefault\":true,\"name\":\"AWS CloudTrail configuration modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0006-credential-access\",\"technique:T1110-brute-force\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect Brute Force Attacks\\n\\n### Strategy\\nLeverage GuardDuty and detect when an attacker is performing a brute force attack. The following are GuardDuty findings trigger this signal:\\n\\n* [UnauthorizedAccess:EC2/SSHBruteForce][1]\\n* [UnauthorizedAccess:EC2/RDPBruteForce][2]\\n\\n\\n### Triage & Response\\n1. Inspect the role of the EC2 instance in the attack. Find the role in the signal name - either `ACTOR` or `TARGET`.\\n   * If you are the `TARGET` and the instance is available on the internet, expect to see IPs scanning your systems.\\n   * If you are the `TARGET` and the instance is **not** available on the internet, this means a host on your internal network is scanning your EC2 instance. Open an investigation.\\n   * If you are the `ACTOR`, this means that your instance is performing brute force attacks on other systems. Open an investigation.\\n\\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized9\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized10\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870284202,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:EC2\\\\/SSHBruteForce OR UnauthorizedAccess\\\\:EC2\\\\/RDPBruteForce) @detail.service.resourceRole:ACTOR\",\"trackType\":\"logs\"},{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:EC2\\\\/SSHBruteForce OR UnauthorizedAccess\\\\:EC2\\\\/RDPBruteForce) @detail.service.resourceRole:TARGET\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"ACTOR\",\"condition\":\"a > 0\"},{\"status\":\"info\",\"notifications\":[],\"name\":\"TARGET\",\"condition\":\"b > 0\"}],\"type\":\"threshold\",\"id\":\"vyl-ylc-3io\",\"isDefault\":true,\"name\":\"AWS EC2 instance involved in brute force attack\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"source:cloudtrail\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EBS encryption is disabled by default. \\n\\n### Strategy\\nMonitor CloudTrail and detect when EBS encryption is disabled by default via the following API call:\\n\\n* [DisableEbsEncryptionByDefault][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user and let them know that it is best practice to enable EBS encryption by default.\\n3. Re-enable EBS encryption by default.\\n\\nFor more information about Amazon EBS Encryption, check out the [Amazon EBS Encryption][2] documentation.\\n\\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html\\n[2]: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870284527,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:DisableEbsEncryptionByDefault\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"4s7-uuu-lo8\",\"isDefault\":true,\"name\":\"AWS EBS default encryption disabled\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.2\",\"source:cloudtrail\",\"scope:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when any user logs in to your AWS console without multi-factor authentication.\\n\\n### Strategy\\nThis rule monitors CloudTrail and detects when any `@evt.name` has a value of  `Console Login`, and `@additionalEventData.MFAUsed` has a value of `no`. \\n\\n**Note:** This rule ignores logins using SAML because 2FA is implemented on the IdP and not through AWS.\\n\\n### Triage & Response\\n1. Reach out to the user to determine if the login was legitimate. \\n2. If the login was legitimate, request that the user enables 2FA. \\n3. If the login wasn't legitimate, rotate the credentials. \\n4. Review all user accounts to ensure MFA is enabled. \\n\\n**Note:** There is a separate rule to detect [Root Login without MFA][1]. \\n\\n[1]: /security_monitoring/default_rules/cloudtrail-aws-root-login-without-mfa/\",\"options\":{\"evaluationWindow\":900,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":3,\"createdAt\":1585870278209,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"user_login_without_mfa\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.accountId\",\"@usr.name\"],\"query\":\"source:cloudtrail @evt.name:ConsoleLogin @additionalEventData.MFAUsed:No @responseElements.ConsoleLogin:Success -@userIdentity.type:Root -@additionalEventData.SamlProviderArn:*\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"user_login_without_mfa > 0\"}],\"type\":\"threshold\",\"id\":\"wkk-muq-vg8\",\"isDefault\":true,\"name\":\"AWS Console login without MFA\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.2\",\"source:cloudtrail\",\"scope:amazon\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a root user logs into the AWS console without multi-factor authentication.\\n\\n### Strategy\\nMonitor CloudTrail and detect when any `@evt.name` has a value of `Console Login`, `@userIdentity.type` has a value of `Root`, and `@additionalEventData.MFAUsed` has a value of `no`. \\n\\n**Note:** This rule ignores logins using SAML because 2FA is implemented on the IdP and not through AWS.\\n\\n### Triage & Response\\n1. Reach out to the user to determine if the login was legitimate. \\n2. If the login was legitimate, request that the user enables 2FA on the root account. \\n3. If the login wasn't legitimate, rotate the credentials. \\n4. Review all root user accounts to ensure MFA is enabled. \\n\\n**Note:** There is a separate rule to detect [Login without MFA for non-root users][1]. \\n\\n[1]: /security_monitoring/default_rules/cloudtrail-aws-login-without-mfa/\",\"options\":{\"evaluationWindow\":900,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":3,\"createdAt\":1585870278956,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"root_login_without_mfa\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.accountId\"],\"query\":\"source:cloudtrail @evt.name:ConsoleLogin @additionalEventData.MFAUsed:No @responseElements.ConsoleLogin:Success @userIdentity.type:Root -@additionalEventData.SamlProviderArn:*\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"root_login_without_mfa > 0\"}],\"type\":\"threshold\",\"id\":\"miy-rjb-9wq\",\"isDefault\":true,\"name\":\"AWS Console root login without MFA\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.7\",\"source:cloudtrail\",\"scope:kms\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a CMK is deleted or scheduled for deletion.\\n\\n### Strategy\\nThis rule lets you monitor these CloudTrail API calls to detect if an attacker is deleting CMKs:\\n* [DisableKey][1]\\n* [ScheduleKeyDeletion][2]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/kms/latest/APIReference/API_DisableKey.html\\n[2]: https://docs.aws.amazon.com/kms/latest/APIReference/API_ScheduleKeyDeletion.html \",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1584475576501,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(DisableKey OR ScheduleKeyDeletion)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"iff-hhm-bd3\",\"isDefault\":true,\"name\":\"AWS CMK deleted or scheduled for deletion\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.8\",\"source:cloudtrail\",\"scope:s3\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a S3 Bucket policy is modified.\\n\\n### Strategy\\nMonitor CloudTrail and detect when S3 policies are being modified via one of the following API calls:\\n* [PutBucketAcl][1]\\n* [PutBucketPolicy][2]\\n* [PutBucketCors][3]\\n* [PutBucketLifecycle][4]\\n* [PutBucketReplication][5]\\n* [DeleteBucketPolicy][6]\\n* [DeleteBucketCors][7]\\n* [DeleteBucketLifecycle][8]\\n* [DeleteBucketReplication][9]\\n\\n### Triage & Response\\n1. Determine who the user was who made this API call.\\n2. Contact the user and see if this was an API call which was made by the user.\\n3. If the API call was not made by the user:\\n   * Rotate the user credentials and investigate what other API calls.\\n   * Determine what other API calls the user made which were not made by the user.\\n\\n[1]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketAcl.html\\n [2]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketPolicy.html\\n [3]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketCors.html\\n [4]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLifecycle.html\\n [5]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketReplication.html\\n [6]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketPolicy.html\\n [7]:  https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketCors.html\\n [8]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketLifecycle.html\\n [9]: https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketReplication.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1584475579499,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(PutBucketAcl OR PutBucketPolicy OR PutBucketCors OR PutBucketLifecycle OR PutBucketReplication OR DeleteBucketPolicy OR DeleteBucketCors OR DeleteBucketLifecycle OR DeleteBucketReplication)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"nl3-oht-jhi\",\"isDefault\":true,\"name\":\"AWS S3 Bucket policy modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.11\",\"source:cloudtrail\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS Network Access Control List (NACL) has been created or modified.\\n\\n### Strategy\\nThis rule lets you monitor CloudTrail and detect when an AWS NACL has been created or modified with one of the following API calls:\\n* [CreateNetworkAcl][1] \\n* [CreateNetworkAclEntry][2] \\n* [DeleteNetworkAcl][3] \\n* [DeleteNetworkAclEntry][4] \\n* [ReplaceNetworkAclEntry][5] \\n* [ReplaceNetworkAclAssociation][6]\\n\\n### Triage & Response\\n1. Determine who the user was who made this API call.\\n2. Contact the user and see if this was an API call which was made by the user.\\n3. If the API call was not made by the user:\\n   * Rotate the user credentials and investigate what other API calls.\\n   * Determine what other API calls the user made which were not made by the user.\\n\\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateNetworkAcl.html\\n[2]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateNetworkAclEntry.html\\n[3]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteNetworkAcl.html\\n[4]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteNetworkAclEntry.html\\n[5]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ReplaceNetworkAclEntry.html\\n[6]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ReplaceNetworkAclAssociation.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1584475579808,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(CreateNetworkAcl OR CreateNetworkAclEntry OR DeleteNetworkAcl OR DeleteNetworkAclEntry OR ReplaceNetworkAclEntry OR ReplaceNetworkAclAssociation)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"pcs-k05-rbc\",\"isDefault\":true,\"name\":\"AWS Network Access Control List created or modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.12\",\"source:cloudtrail\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS Network Gateway has been created or modified.\\n\\n### Strategy\\nMonitor CloudTrail and detect when an AWS Network Gateway has been created or modified with one of the following API calls:\\n* [CreateCustomerGateway][1] \\n* [DeleteCustomerGateway][2] \\n* [AttachInternetGateway][3] \\n* [CreateInternetGateway][4]\\n* [DeleteInternetGateway][5] \\n* [DetachInternetGateway][6]\\n\\n### Triage & Response\\n1. Determine who the user was who made this API call.\\n2. Contact the user and see if this was an API call which was made by the user.\\n3. If the API call was not made by the user:\\n   * Rotate the user credentials and investigate what other API calls.\\n   * Determine what other API calls the user made which were not made by the user.\\n\\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateCustomerGateway \\n [2]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteCustomerGateway \\n [3]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_AttachInternetGateway \\n [4]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateInternetGateway \\n [5]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteInternetGateway \\n [6]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DetachInternetGateway.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1584475581301,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(CreateCustomerGateway OR DeleteCustomerGateway OR AttachInternetGateway OR CreateInternetGateway OR DeleteInternetGateway OR DetachInternetGateway)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"umr-47s-eyj\",\"isDefault\":true,\"name\":\"AWS Network Gateway created or modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.6\",\"source:cloudtrail\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a user is a victim of an Account Take Over (ATO) by a brute force attack.\\n\\n### Strategy\\n This rule monitors CloudTrail and detects when any `@evt.name` has a value of `Console Login`, and `@responseElements.ConsoleLogin` has a value of `Failure`.\\n\\n### Triage & Response\\n1. Determine if the user logged in with 2FA.\\n2. Reach out to the user and ensure the login was legitimate.\",\"options\":{\"evaluationWindow\":900,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":6,\"createdAt\":1584475581986,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"failed_login\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.accountId\",\"@usr.name\"],\"query\":\"source:cloudtrail @evt.name:ConsoleLogin @responseElements.ConsoleLogin:Failure\",\"trackType\":\"logs\"},{\"distinctFields\":[],\"name\":\"successful_login_without_mfa\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.accountId\",\"@usr.name\"],\"query\":\"source:cloudtrail @evt.name:ConsoleLogin @responseElements.ConsoleLogin:Success @additionalEventData.MFAUsed:No\",\"trackType\":\"logs\"},{\"distinctFields\":[],\"name\":\"successful_login_with_mfa\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.accountId\",\"@usr.name\"],\"query\":\"source:cloudtrail @evt.name:ConsoleLogin @responseElements.ConsoleLogin:Success @additionalEventData.MFAUsed:Yes\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Potentially Successful - NO MFA\",\"condition\":\"failed_login > 5 && successful_login_without_mfa > 0\"},{\"status\":\"info\",\"notifications\":[],\"name\":\"Potentially Successful - MFA Used\",\"condition\":\"failed_login > 5 && successful_login_with_mfa > 0\"},{\"status\":\"info\",\"notifications\":[],\"name\":\"Unsuccessful\",\"condition\":\"failed_login > 5\"}],\"type\":\"threshold\",\"id\":\"csj-nez-h1v\",\"isDefault\":true,\"name\":\"AWS Console brute force login\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.13\",\"source:cloudtrail\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS Route Table has been created or modified.\\n\\n### Strategy\\nThis rule lets you monitor CloudTrail and detect when an AWS Route Table has been created or modified with one of the following API calls:\\n* [CreateRoute][1] \\n* [CreateRouteTable][2] \\n* [ReplaceRoute][3] \\n* [ReplaceRouteTableAssociation][4] \\n* [DeleteRouteTable][5] \\n* [DeleteRoute][6] \\n* [DisassociateRouteTable][7]\\n\\n### Triage & Response\\n1. Determine who the user was who made this API call.\\n2. Contact the user and see if this was an API call which was made by the user.\\n3. If the API call was not made by the user:\\n   * Rotate the user credentials and investigate what other API calls.\\n   * Determine what other API calls the user made which were not made by the user.\\n\\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateRoute.html \\n [2]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateRouteTable \\n [3]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ReplaceRoute.html \\n [4]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ReplaceRouteTableAssociation \\n [5]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteRouteTable.html \\n [6]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteRoute.html \\n [7]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisassociateRouteTable.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1584475582644,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(CreateRoute OR CreateRouteTable OR ReplaceRoute OR ReplaceRouteTableAssociation OR DeleteRouteTable OR DeleteRoute OR DisassociateRouteTable)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"qgo-jqs-03x\",\"isDefault\":true,\"name\":\"AWS Route Table created or modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.1\",\"source:cloudtrail\",\"scope:amazon\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when unauthorized activity is detected in AWS.\\n\\n### Strategy\\nThis rule lets you monitor CloudTrail to detect when the error message of `AccessDenied` is returned.\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\",\"options\":{\"evaluationWindow\":900,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":7,\"createdAt\":1584475582956,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail \\\"AccessDenied\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"greater than 1000 failed attempts\",\"condition\":\"a > 1000\"},{\"status\":\"medium\",\"notifications\":[],\"name\":\"greater than 100 failed attempts\",\"condition\":\"a > 100\"},{\"status\":\"low\",\"notifications\":[],\"name\":\"greater than 10 failed attempts\",\"condition\":\"a > 10\"}],\"type\":\"threshold\",\"id\":\"3d9-oev-jbm\",\"isDefault\":true,\"name\":\"AWS unauthorized activity\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.10\",\"source:cloudtrail\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS security group has been modified.\\n\\n### Strategy\\nMonitor CloudTrail and detect when an AWS security group has been created or modified with one of the following API calls:\\n* [AuthorizeSecurityGroupIngress][1] \\n* [AuthorizeSecurityGroupEgress][2] \\n* [RevokeSecurityGroupIngress][3] \\n* [RevokeSecurityGroupEgress][4] \\n* [CreateSecurityGroup][5] \\n* [DeleteSecurityGroup][6]\\n\\n### Triage & Response\\n1. Determine who the user was who made this API call.\\n2. Contact the user and see if this was an API call which was made by the user.\\n3. If the API call was not made by the user:\\n   * Rotate the user credentials and investigate what other API calls.\\n   * Determine what other API calls the user made which were not made by the user.\\n\\n[1]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_AuthorizeSecurityGroupIngress.html \\n [2]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_AuthorizeSecurityGroupEgress.html \\n [3]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_RevokeSecurityGroupIngress.html \\n [4]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_RevokeSecurityGroupEgress.html \\n [5]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateSecurityGroup.html \\n [6]: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteSecurityGroup.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1584475583507,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(AuthorizeSecurityGroupIngress OR AuthorizeSecurityGroupEgress OR RevokeSecurityGroupIngress OR RevokeSecurityGroupEgress OR CreateSecurityGroup OR DeleteSecurityGroup)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"bax-btp-3ct\",\"isDefault\":true,\"name\":\"AWS security group created or modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.4\",\"source:cloudtrail\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect a change to an AWS IAM Policy.\\n\\n### Strategy\\nThis rule lets you monitor CloudTrail and detect when any event pertaining to an AWS IAM policy is detected with one of the following API calls:\\n* [DeleteGroupPolicy][1]\\n* [DeleteRolePolicy](https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteRolePolicy.html)\\n* [DeleteUserPolicy][2]\\n* [PutGroupPolicy][3]\\n* [PutRolePolicy]\\n* [PutUserPolicy][5]\\n* [CreatePolicy]\\n* [DeletePolicy][7]\\n* [CreatePolicyVersion][8]\\n* [DeletePolicyVersion][9]\\n* [AttachRolePolicy][10]\\n* [DetachRolePolicy][11]\\n* [AttachUserPolicy][12]\\n* [DetachUserPolicy][13]\\n* [AttachGroupPolicy][14]\\n* [DetachGroupPolicy][15]\\n\\n### Triage & Response\\n1. Review the IAM Policy change and ensure it does not negatively impact your risk in relation to authentication or authorization controls.\\n\\n[1]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteGroupPolicy.html\\n[2]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteUserPolicy.html\\n[3]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_PutGroupPolicy.html\\n[4]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_PutRolePolicy.html\\n[5]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_PutUserPolicy.html\\n[6]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreatePolicy.html\\n[7]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeletePolicy.html\\n[8]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreatePolicyVersion.html\\n[9]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeletePolicyVersion.html\\n[10]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachRolePolicy.html\\n[11]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_DetachRolePolicy.html\\n[12]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachUserPolicy.html\\n[13]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_DetachUserPolicy.html\\n[14]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachGroupPolicy.html\\n[15]: https://docs.aws.amazon.com/IAM/latest/APIReference/API_DetachGroupPolicy.html\",\"options\":{\"evaluationWindow\":900,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":4,\"createdAt\":1584475584008,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:(DeleteGroupPolicy OR DeleteRolePolicy OR DeleteUserPolicy OR PutGroupPolicy OR PutRolePolicy OR PutUserPolicy OR CreatePolicy OR DeletePolicy OR CreatePolicyVersion OR DeletePolicyVersion OR AttachRolePolicy OR DetachRolePolicy OR AttachUserPolicy OR DetachUserPolicy OR AttachGroupPolicy OR DetachGroupPolicy)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"z8s-u06-ctu\",\"isDefault\":true,\"name\":\"AWS IAM policy changed\"},{\"creationAuthorId\":0,\"tags\":[\"source:twistlock\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect vulnerabilities in container images.\\n\\n### Strategy\\nThis rule lets you monitor Twistlock logs to detect `Critical` severity vulnerabilities in a container image. \\n\\n### Triage & Response\\n1. Determine the impact of this vulnerability.\\n2. Update the container image in the registry with a patched version of the software.\\n3. Deploy the new image to all containers running the vulnerable image.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870278701,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@vulnerability.cve\",\"@vulnerability.package.name\",\"@vulnerability.image_name\"],\"query\":\"source:twistlock @vulnerability.log_type:vulnerability @vulnerability.severity:critical\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"d7s-rex-gjv\",\"isDefault\":true,\"name\":\"Container image vulnerability detected\"},{\"creationAuthorId\":0,\"tags\":[\"source:twistlock\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a container is not running within compliance standards.\\n\\n### Strategy\\nThis rule lets you monitor Twistlock logs to detect when `Critical` severity compliance issues are discovered in a running container. \\n\\n### Triage & Response\\n1. Determine the impact of the compliance finding.\\n2. Remediate the compliance finding.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870281390,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@vulnerability.compliance_id\",\"@vulnerability.container_name\"],\"query\":\"source:twistlock @vulnerability.log_type:compliance @vulnerability.severity:critical\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"9vp-d1j-kwp\",\"isDefault\":true,\"name\":\"Container violated compliance standards\"},{\"creationAuthorId\":0,\"tags\":[\"source:signal_sciences\",\"scope:signal_sciences\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an IP is flagged by Signal Sciences.\\n\\n### Strategy\\nThis rule lets you monitor Signal Sciences events submitted through the Signal Sciences [integration][1] to detect when an IP is flagged. \\n\\n### Triage & Response\\n1. Determine whether the attack is a false positive.\\n2. Determine whether the attack was successful.\\n3. If the attack exploited a vulnerability in the application, triage the vulnerability.\\n\\n[1]: https://app.datadoghq.com/account/settings#integrations/sigsci\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":2,\"createdAt\":1584993292228,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"source:signal_sciences @title:*flag\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"bmg-ftn-dzo\",\"isDefault\":true,\"name\":\"Signal Sciences flagged an IP\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.service.account\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a new service account is created.\\n\\n### Strategy\\nThis rule lets you monitor GCP admin activity audit logs to determine when a service account is created. \\n\\n### Triage & Response\\n1. Contact the user who created the service account and ensure that the account is needed and that the role is scoped properly.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585870281733,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:gcp.service.account @evt.name:google.iam.admin.v1.CreateServiceAccount\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"szx-4kh-eqs\",\"isDefault\":true,\"name\":\"GCP service account created\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.service.account\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a new service account key is created.  An attacker could use this key as a backdoor to your account. \\n\\n### Strategy\\nThis rule lets you monitor GCP admin activity audit logs to detect the creation of a service account key. \\n\\n### Triage & Response\\n1. Contact the user who created the service account key to ensure they're managing the key securely.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585870277946,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:gcp.service.account @evt.name:google.iam.admin.v1.CreateServiceAccountKey\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"79j-4wh-xlq\",\"isDefault\":true,\"name\":\"GCP service account key created\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.project\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect a change to the IAM policy. \\n\\n### Strategy\\nThis rule lets you monitor GCP admin activity audit logs to determine when the `SetIamPolicy` method is invoked. \\n\\n### Triage & Response\\n1. Review the log and inspect the policy deltas (`@data.protoPayload.serviceData.policyDelta.bindingDeltas`) and ensure none of the actions are `REMOVE`.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585870280073,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:gcp.project @evt.name:SetIamPolicy\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"fgm-8w4-cgx\",\"isDefault\":true,\"name\":\"GCP IAM policy modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.project\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a change to a GCP logging sink has been made. This could stop audit logs from being sent to Datadog.\\n\\n### Strategy\\nMonitor GCP admin activity audit logs to determine when any of the following methods are invoked:\\n\\n* `google.logging.v2.ConfigServiceV2.UpdateSink`\\n* `google.logging.v2.ConfigServiceV2.DeleteSink`\\n\\n### Triage & Response\\n1. Review the sink and ensure the sink is properly configured.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585871191688,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\",\"@data.protoPayload.resourceName\"],\"query\":\"source:gcp.project @evt.name:(google.logging.v2.ConfigServiceV2.UpdateSink OR google.logging.v2.ConfigServiceV2.DeleteSink)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"hil-rl3-yxs\",\"isDefault\":true,\"name\":\"GCP logging sink modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.gce.route\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a VPC network is created. \\n\\n### Strategy\\nThis rule lets you monitor GCP GCE activity audit logs to determine when the following method is invoked to create a new VPC network:\\n\\n* `beta.compute.networks.insert`\\n\\n### Triage & Response\\n1. Review the VPC network.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585871193403,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"project_id\",\"@data.protoPayload.resourceName\",\"@usr.id\"],\"query\":\"source:gcp.gce.route @evt.name:beta.compute.networks.insert\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"a9z-oic-grb\",\"isDefault\":true,\"name\":\"GCP GCE VPC network modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.gcs.bucket\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when permissions have changed on a GCS Bucket.\\n\\n### Strategy\\nMonitor GCS bucket admin activity audit logs to determine the following method is invoked:\\n\\n* `storage.setIamPermissions`\\n\\n### Triage & Response\\n1. Review the bucket permissions and ensure they are not overly permissive.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585871193842,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"project_id\",\"bucket_name\",\"@usr.id\"],\"query\":\"source:gcp.gcs.bucket @evt.name:storage.setIamPermissions\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"fdk-tly-4qr\",\"isDefault\":true,\"name\":\"GCP Bucket permissions modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.gce.firewall.rule\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a firewall rule is created, modified or deleted. \\n\\n### Strategy\\nMonitor GCP GCE activity audit logs to determine when any of the following methods are invoked:\\n\\n* `v1.compute.firewalls.delete`\\n* `v1.compute.firewalls.insert`\\n* `v1.compute.firewalls.patch` \\n\\n### Triage & Response\\n1. Review the log and role and ensure the permissions are scoped properly.\\n2. Review the users associated with the role and ensure they should have the permissions attached to the role.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585870279610,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"project_id\",\"@data.protoPayload.resourceOriginalState.name\",\"@usr.id\"],\"query\":\"source:gcp.gce.firewall.rule @evt.name:(v1.compute.firewalls.delete OR v1.compute.firewalls.insert OR v1.compute.firewalls.patch)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"n1w-sql-apl\",\"isDefault\":true,\"name\":\"GCP GCE Firewall rule modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.iam.role\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a custom role is created or modified. \\n\\n### Strategy\\nMonitor GCP IAM activity audit logs to determine when any of the following methods are invoked:\\n\\n* `google.iam.admin.v1.CreateRole`\\n* `google.iam.admin.v1.UpdateRole` \\n\\n### Triage & Response\\n1. Review the log and role and ensure the permissions are scoped properly.\\n2. Review the users associated with the role and ensure they should have the permissions attached to the role.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585870282410,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:gcp.iam.role @evt.name:(google.iam.admin.v1.CreateRole OR google.iam.admin.v1.UpdateRole)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"rhy-fzm-gwl\",\"isDefault\":true,\"name\":\"GCP IAM custom role created or modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.cloudsql.database\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a Cloud SQL DB has been modified.\\n\\n### Strategy\\nThis rule lets you monitor GCP Cloud SQL admin activity audit logs to determine when one of the following methods are invoked:\\n\\n* `cloudsql.instances.create`\\n* `cloudsql.instances.create`\\n* `cloudsql.users.update`\\n\\n### Triage & Response\\n1. Review the Cloud SQL DB and ensure it is configured properly with the correct permissions.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585871198921,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"project_id\",\"database_id\",\"@usr.id\"],\"query\":\"source:gcp.cloudsql.database @evt.name:(cloudsql.instances.create OR cloudsql.instances.create OR cloudsql.users.create OR cloudsql.users.update)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ikf-ye8-cnu\",\"isDefault\":true,\"name\":\"GCP Cloud SQL database modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.gce.route\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a firewall rule is created or modified. \\n\\n### Strategy\\nThis rule lets you monitor GCP GCE activity audit logs to determine if a firewall is being adjusted by showing you when any of the following methods are invoked:\\n\\n* `beta.compute.routes.insert`\\n* `beta.compute.routes.patch`\\n\\n### Triage & Response\\n1. Veirify that the GCP route is configured properly and that the user intended to modify the firewall.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585870282924,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"project_id\",\"@data.protoPayload.resourceName\",\"@usr.id\"],\"query\":\"source:gcp.gce.route @evt.name(beta.compute.routes.insert OR beta.compute.routes.patch)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"lht-ml8-u6r\",\"isDefault\":true,\"name\":\"GCP GCE network route created or modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.gcs.bucket\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an administrative change to a GCS Bucket has been made. This could change the retention policy or bucket lock. For more information, see the [GCS Bucket Lock docs][1].\\n\\n### Strategy\\nThis rule lets you monitor GCS bucket admin activity audit logs to determine if a bucket has been updated with the following method:\\n\\n* `storage.buckets.update`\\n\\n### Triage & Response\\n1. Review the bucket to ensure that it is properly configured.\\n\\n[1]: https://cloud.google.com/storage/docs/bucket-lock\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1585871279860,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"project_id\",\"bucket_name\",\"@usr.id\"],\"query\":\"source:gcp.gcs.bucket @evt.name:storage.buckets.update\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"iz3-sc4-ryy\",\"isDefault\":true,\"name\":\"GCP Bucket modified\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0007-discovery\",\"technique:T1046-network-service-scanning\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is conducting a port scan.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [Recon:EC2/Portscan][2]\\n\\n\\n### Triage & Response\\n1. Determine why traffic from the EC2 instance appears to be conducting a port scan.\\n2. If the instance is compromised:\\n   * Review the AWS [documentation][3] on remediating a compromised EC2 instance.\\n \\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon5\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525376478,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(Recon\\\\:EC2\\\\/Portscan)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"y1y-h5t-gnp\",\"isDefault\":true,\"name\":\"AWS EC2 instance conducting a port scan\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS IAM user disables [S3 Block Public Access][1]\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][2] finding:\\n\\n* [Policy:IAMUser/S3BlockPublicAccessDisabled][3]\\n\\n\\n### Triage & Response\\n1. Determine which user triggered the signal. This can be found in the signal.\\n2. Contact the user and determine why the user disabled the S3 Block Access feature.   \\n3. Re-enable S3 Block Public Access.\\n\\n[1]: https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html\\n[2]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_policy.html#policy2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525377921,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(Policy\\\\:IAMUser\\\\/S3BlockPublicAccessDisabled)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"loc-nk4-pkc\",\"isDefault\":true,\"name\":\"AWS IAM user disabled S3 Block Public Access\"},{\"creationAuthorId\":0,\"tags\":[\"security:threat-intel\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS API call is made from a non EC2 IP for a credential which is scoped to an EC2 Instance.  \\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration][2]\\n\\n\\n### Triage & Response\\n1. Determine the EC2 instance this credential is scoped to. This can be found in the samples. \\n2. Determine if the EC2 instance credentials are compromised.  \\n3. If the instance is compromised:\\n   * Review the AWS [documentation][3] on remediating a compromised EC2 instance.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized11\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525378639,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:IAMUser\\\\/InstanceCredentialExfiltration)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"iaa-n0t-0jz\",\"isDefault\":true,\"name\":\"AWS EC2 instance credential exfiltrated\"},{\"creationAuthorId\":0,\"tags\":[\"security:threat-intel\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS IAM user makes API requests from a malicious IP.\\n\\n### Strategy\\nThis rule lets you monitor these [GuardDuty integration][1] findings:\\n\\n* [Recon:IAMUser/TorIPCaller][2]\\n* [Recon:IAMUser/MaliciousIPCaller.Custom][3]\\n* [Recon:IAMUser/MaliciousIPCaller][4]\\n* [UnauthorizedAccess:IAMUser/MaliciousIPCaller][5]\\n\\n\\n### Triage & Response\\n1. Determine which user triggered the signal. This can be found in the signal.\\n2. Determine if the user's credentials are compromised.  \\n3. If the user's credentials are compromised:\\n  * Review the AWS [documentation][6] on remediating compromised AWS credentials.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon1\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon2\\n[4]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon3\\n[5]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized5\\n[6]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525380153,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(Recon\\\\:IAMUser\\\\/TorIPCaller OR Recon\\\\:IAMUser\\\\/MaliciousIPCaller.Custom OR Recon\\\\:IAMUser\\\\/MaliciousIPCaller OR UnauthorizedAccess\\\\:IAMUser\\\\/MaliciousIPCaller)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"8w7-aaz-ojp\",\"isDefault\":true,\"name\":\"AWS IAM user requests from malicious IP\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0007-discovery\",\"technique:T1046-network-service-scanning\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is being probed by a scanner.\\n\\n### Strategy\\nThis rule lets you monitor these [GuardDuty integration][1] findings:\\n\\n* [Recon:EC2/PortProbeUnprotectedPort][2]\\n* [Recon:EC2/PortProbeEMRUnprotectedPort][3]\\n\\n\\n### Triage & Response\\n1. This is typically an informative signal. However, if this instance should not be publicly available, you should review the security group for this instance. \\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon6\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#PortProbeEMRUnprotectedPort\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525381084,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(Recon\\\\:EC2\\\\/PortProbeUnprotectedPort OR Recon\\\\:EC2\\\\/PortProbeEMRUnprotectedPort)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"mrq-h3x-jus\",\"isDefault\":true,\"name\":\"AWS EC2 instance probed by scanner\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0011-command-and-control\",\"technique:T1188-multi-hop-proxy\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance makes an outbound network connection from TOR.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [UnauthorizedAccess:EC2/TorClient][2]\\n\\n\\n### Triage & Response\\n1. Determine if the EC2 instance should be making requests to TOR. \\n2. If the instance is compromised:\\n   * Review the AWS [documentation][3] on remediating a compromised EC2 instance. \\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized13\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525381864,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:EC2\\\\/TorClient)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ihd-q9p-mwx\",\"isDefault\":true,\"name\":\"AWS EC2 instance outbound connections to TOR\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1496-resource-hijacking\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS IAM user is launching compute resources and has no prior history of invoking this API.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [ResourceConsumption:IAMUser/ComputeResources][2]\\n\\n\\n### Triage & Response\\n1. Determine which user triggered the signal. This can be found in the signal.\\n2. Determine if the user's credentials are compromised.  \\n3. If the user's credentials are compromised:\\n  * Review the AWS [documentation][3] on remediating compromised AWS credentials.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_resource.html#resourceconsumption\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525382816,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(ResourceConsumption\\\\:IAMUser\\\\/ComputeResources)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"fwu-iey-ovx\",\"isDefault\":true,\"name\":\"AWS IAM user anomalous resource consumption\"},{\"creationAuthorId\":0,\"tags\":[\"security:threat-intel\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance receives an inbound network connection from TOR.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [UnauthorizedAccess:EC2/TorIPCaller][2]\\n\\n\\n### Triage & Response\\n1. This is typically an informative signal. However, if this instance should not be publicly available, you should review the security group for this instance. \\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized7\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525383148,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:EC2\\\\/TorIPCaller)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"1ew-u8i-att\",\"isDefault\":true,\"name\":\"AWS EC2 instance inbound connections from TOR\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1496-resource-hijacking\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is participating in a Denial of Service (DoS) attack.\\n\\n### Strategy\\nThis rule lets you monitor these [GuardDuty integration][1] findings:\\n\\n* [Backdoor:EC2/DenialOfService.Tcp][2]\\n* [Backdoor:EC2/DenialOfService.Udp][3]\\n* [Backdoor:EC2/DenialOfService.Dns][4]\\n* [Backdoor:EC2/DenialOfService.UdpOnTcpPorts][5]\\n* [Backdoor:EC2/DenialOfService.UnusualProtocol][6]\\n\\n\\n### Triage & Response\\n1. Determine if the EC2 instance is compromised and participating in a DoS attack.\\n2. If the instance is compromised:\\n   * Review the AWS [documentation][7] on remediating a compromised EC2 instance.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor8\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor9\\n[4]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor10\\n[5]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor11\\n[6]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor12\\n[7]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525383757,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(Backdoor\\\\:EC2\\\\/DenialOfService.Tcp OR Backdoor\\\\:EC2\\\\/DenialOfService.Udp OR Backdoor\\\\:EC2\\\\/DenialOfService.Dns OR Backdoor\\\\:EC2\\\\/DenialOfService.UdpOnTcpPorts OR Backdoor\\\\:EC2\\\\/DenialOfService.UnusualProtocol)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"3l6-vrm-iyn\",\"isDefault\":true,\"name\":\"AWS EC2 instance participating in a DoS attack\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0004-privilege-escalation\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS IAM user is attempting to escalate permissions.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [PrivilegeEscalation:IAMUser/AdministrativePermissions][2]\\n\\n\\n### Triage & Response\\n1. Determine which user triggered the signal. This can be found in the signal.\\n2. Determine if the user's credentials are compromised.  \\n3. If the user's credentials are compromised:\\n  * Review the AWS [documentation][3] on remediating compromised AWS credentials.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_privilegeescalation.html#privilegeescalation1\\n[5]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525384559,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(PrivilegeEscalation\\\\:IAMUser\\\\/AdministrativePermissions)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"dsb-ciq-vrt\",\"isDefault\":true,\"name\":\"AWS IAM user escalating privileges\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0005-defense-evasion\",\"technique:T1089-disabling-security-tools\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS IAM user is changing sensitive configurations and has no prior history of invoking these APIs.\\n\\n### Strategy\\nThis rule lets you monitor these [GuardDuty integration][1] findings:\\n\\n* [Stealth:IAMUser/S3ServerAccessLoggingDisabled][2]\\n* [Stealth:IAMUser/PasswordPolicyChange][3]\\n* [Stealth:IAMUser/CloudTrailLoggingDisabled][4]\\n* [Stealth:IAMUser/LoggingConfigurationModified][5]\\n\\n\\n### Triage & Response\\n1. Determine which user triggered the signal. This can be found in the signal.\\n2. Determine if the user's credentials are compromised.  \\n3. If the user's credentials are compromised:\\n  * Review the AWS [documentation][6] on remediating compromised AWS credentials.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_stealth.html#stealth4\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_stealth.html#stealth1\\n[4]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_stealth.html#stealth2\\n[5]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_stealth.html#stealth3\\n[6]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525385196,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(Stealth\\\\:IAMUser\\\\/S3ServerAccessLoggingDisabled OR Stealth\\\\:IAMUser\\\\/PasswordPolicyChange OR Stealth\\\\:IAMUser\\\\/CloudTrailLoggingDisabled OR Stealth\\\\:IAMUser\\\\/LoggingConfigurationModified)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"48o-8me-0mo\",\"isDefault\":true,\"name\":\"AWS IAM user changing sensitive configurations\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1496-resource-hijacking\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is compromised and sending spam emails.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [Backdoor:EC2/Spambot][2]\\n\\n\\n### Triage & Response\\n1. Determine if the EC2 should be sending out email over port 25. \\n2. If the instance is compromised:\\n   * Review the AWS [documentation][3] on remediating a compromised EC2 instance.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor6\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525385866,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(Backdoor\\\\:EC2\\\\/Spambot)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ecn-gew-dg2\",\"isDefault\":true,\"name\":\"AWS EC2 instance Sending spam emails\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0003-persistence\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS IAM user is attempting to gain persistence within an AWS account.\\n\\n### Strategy\\nThis rule lets you monitor these [GuardDuty integration][1] findings:\\n\\n* [Persistence:IAMUser/NetworkPermissions][2]\\n* [Persistence:IAMUser/ResourcePermissions][3]\\n* [Persistence:IAMUser/UserPermissions][4]\\n\\n\\n### Triage & Response\\n1. Determine which user triggered the signal. This can be found in the signal.\\n2. Determine if the user's credentials are compromised.  \\n3. If the user's credentials are compromised:\\n  * Review the AWS [documentation][5] on remediating compromised AWS credentials.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_persistence.html#persistence1\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_persistence.html#persistence2\\n[4]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_persistence.html#persistence3\\n[5]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525386519,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(Persistence\\\\:IAMUser\\\\/NetworkPermissions OR Persistence\\\\:IAMUser\\\\/ResourcePermissions OR Persistence\\\\:IAMUser\\\\/UserPermissions)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"4ho-oxn-reh\",\"isDefault\":true,\"name\":\"AWS IAM user attempting to gain persistence\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0006-credential-access\",\"technique:T1522-cloud-instance-metadata-api\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance makes a DNS request and resolves to the AWS metadata IP address (169.254.169.254).\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [UnauthorizedAccess:EC2/MetadataDNSRebind][2]\\n\\n\\n### Triage & Response\\n1. Determine which process made the DNS request. The DNS request can be found in the samples.\\n2. Ensure the process is not a victim of an SSRF attack to steal the AWS EC2 Instance profile's STS credentials.  \\n2. If the STS credentials are compromised:\\n   * Review the AWS [documentation][3] on revoking the session.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#ec2-metadatadnsrebind\\n[3]: https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_revoke-sessions.html\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":1,\"createdAt\":1587525387807,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:EC2\\\\/MetadataDNSRebind)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"aad-vqz-7tk\",\"isDefault\":true,\"name\":\"AWS EC2 Instance Victim to Metadata DNS Rebind Attack\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1496-resource-hijacking\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is being used as a TOR relay.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [UnauthorizedAccess:EC2/TorRelay][2]\\n\\n\\n### Triage & Response\\n1. Determine if the EC2 instance should be uses as a TOR relay. \\n2. If the instance is compromised:\\n   * Review the AWS [documentation][3] on remediating a compromised EC2 instance. \\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized14\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525388119,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:EC2\\\\/TorRelay)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"tpv-3qf-v90\",\"isDefault\":true,\"name\":\"AWS EC2 instance connecting to TOR as a relay\"},{\"creationAuthorId\":0,\"tags\":[\"security:anomaly\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS IAM user login is suspicious.\\n\\n### Strategy\\nThis rule lets you monitor these [GuardDuty integration][1] findings:\\n\\n* [UnauthorizedAccess:IAMUser/ConsoleLoginSuccess.B][2]\\n* [UnauthorizedAccess:IAMUser/ConsoleLogin][3]\\n\\n\\n### Triage & Response\\n1. Determine which user triggered the signal. This can be found in the signal.\\n2. Determine if the user's credentials are compromised.  \\n3. If the user's credentials are compromised:\\n  * Review the AWS [documentation][4] on remediating compromised AWS credentials.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized4\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized12\\n[4]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525388403,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:IAMUser\\\\/ConsoleLoginSuccess.B OR UnauthorizedAccess\\\\:IAMUser\\\\/ConsoleLogin)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"kme-i0z-ylv\",\"isDefault\":true,\"name\":\"AWS IAM user suspicious login\"},{\"creationAuthorId\":0,\"tags\":[\"security:threat-intel\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance makes an outbound network connection to a malcious IP address.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [UnauthorizedAccess:EC2/MaliciousIPCaller.Custom][2]\\n\\n\\n### Triage & Response\\n1. Determine which IP address triggered the signal. This can be found in the sample.\\n2. If the instance is compromised:\\n   * Review the AWS [documentation][3] on remediating a compromised EC2 instance.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_unauthorized.html#unauthorized5\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525389461,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(UnauthorizedAccess\\\\:EC2\\\\/MaliciousIPCaller.Custom)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"22j-qk6-qv3\",\"isDefault\":true,\"name\":\"AWS EC2 instance communicating with malicious IP\"},{\"creationAuthorId\":0,\"tags\":[\"security:anomaly\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is communicating over an unusual port.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [Behavior:EC2/NetworkPortUnusual][2]\\n\\n\\n### Triage & Response\\n1. Determine which port triggered the signal. This can be found in the samples.\\n2. If the instance is compromised:\\n   * Review the AWS [documentation][3] on remediating a compromised EC2 instance.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_behavior.html#behavior3\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525391873,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(Behavior\\\\:EC2\\\\/NetworkPortUnusual)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"qfd-ned-cjn\",\"isDefault\":true,\"name\":\"AWS EC2 instance communicating over unusual port\"},{\"creationAuthorId\":0,\"tags\":[\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an AWS IAM user makes API requests with hacking tools.\\n\\n### Strategy\\nThis rule lets you monitor these [GuardDuty integration][1] findings:\\n\\n* [PenTest:IAMUser/KaliLinux][2]\\n* [PenTest:IAMUser/ParrotLinux][3]\\n* [PenTest:IAMUser/PentooLinux][4]\\n\\n\\n### Triage & Response\\n1. Determine which user triggered the signal. This can be found in the signal.\\n2. Determine if the user's credentials are compromised.  \\n3. If the user's credentials are compromised:\\n  * Review the AWS [documentation][5] on remediating compromised AWS credentials.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_pentest.html#pentest1\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_pentest.html#pentest2\\n[4]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_pentest.html#pentest3\\n[5]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525392995,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(PenTest\\\\:IAMUser\\\\/KaliLinux OR PenTest\\\\:IAMUser\\\\/ParrotLinux OR PenTest\\\\:IAMUser\\\\/PentooLinux)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ocf-ys6-78v\",\"isDefault\":true,\"name\":\"AWS IAM user making API requests with hacking tools\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is communicating with a malicious server.\\n\\n### Strategy\\nThis rule lets you monitor these [GuardDuty integration][1] findings:\\n\\n* [Backdoor:EC2/C&CActivity.B!DNS][2]\\n* [Trojan:EC2/BlackholeTraffic][3]\\n* [Trojan:EC2/DropPoint][4]\\n* [Trojan:EC2/BlackholeTraffic!DNS][5]\\n* [Trojan:EC2/DriveBySourceTraffic!DNS][6]\\n* [Trojan:EC2/DropPoint!DNS][7]\\n* [Trojan:EC2/DGADomainRequest.B][8]\\n* [Trojan:EC2/DGADomainRequest.C!DNS][9]\\n* [Trojan:EC2/DNSDataExfiltration][10]\\n* [Trojan:EC2/PhishingDomainRequest!DNS][11]\\n\\n\\n### Triage & Response\\n1. Determine which domain name or IP address triggered the signal. This can be found in the samples.\\n2. If the instance is compromised:\\n   * Review the AWS [documentation][12] on remediating a compromised EC2 instance.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_backdoor.html#backdoor6\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan4\\n[4]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan5\\n[5]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan6\\n[6]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan7\\n[7]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan8\\n[8]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan9\\n[9]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan95\\n[10]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan10\\n[11]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_trojan.html#trojan11\\n[12]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525393367,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(Trojan\\\\:EC2\\\\/BlackholeTraffic OR Trojan\\\\:EC2\\\\/DropPoint OR Trojan\\\\:EC2\\\\/BlackholeTraffic\\\\!DNS OR Trojan\\\\:EC2\\\\/DriveBySourceTraffic\\\\!DNS OR Trojan\\\\:EC2\\\\/DropPoint\\\\!DNS OR Trojan\\\\:EC2\\\\/DGADomainRequest.B OR Trojan\\\\:EC2\\\\/DGADomainRequest.C\\\\!DNS OR Backdoor\\\\:EC2\\\\/C&CActivity.B\\\\!DNS OR Trojan\\\\:EC2\\\\/PhishingDomainRequest\\\\!DNS)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"9du-jhn-b4f\",\"isDefault\":true,\"name\":\"AWS EC2 instance communicated with a malicious server\"},{\"creationAuthorId\":0,\"tags\":[\"security:compliance\",\"framework:cis-aws\",\"control:cis-3.3\",\"control:cis-1.1\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when the AWS root user credentials are used.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [Policy:IAMUser/RootCredentialUsage][2]\\n\\n\\n### Triage & Response\\n1. Determine whether the root account activity was legitimate. \\n * Review the sample for context. \\n * Review CloudTrail logs for a full investigation. \\n3. If the root user's credentials are compromised:\\n * Review the AWS [documentation][3] on remediating compromised AWS credentials.\\n\\n**[Root Account Best Practices][4]**\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_policy.html#policy1\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-creds\\n[4]: https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":4,\"createdAt\":1587525393683,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"source:guardduty @evt.name:(Policy\\\\:IAMUser\\\\/RootCredentialUsage)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"cjm-gyr-zxb\",\"isDefault\":true,\"name\":\"AWS Root credential activity\"},{\"creationAuthorId\":0,\"tags\":[\"security:anomaly\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance network traffic volume is unusual.\\n\\n### Strategy\\nThis rule lets you monitor this [GuardDuty integration][1] finding:\\n\\n* [Behavior:EC2/TrafficVolumeUnusual][2]\\n\\n\\n### Triage & Response\\n1. Determine which port triggered the signal. This can be found in the samples.\\n2. If the instance is compromised:\\n   * Review the AWS [documentation][3] on remediating a compromised EC2 instance.\\n\\n[1]: https://docs.datadoghq.com/integrations/amazon_guardduty/\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_behavior.html#behavior4\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html#compromised-ec2\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1587525393982,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(Behavior\\\\:EC2\\\\/TrafficVolumeUnusual)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ipt-dpt-t69\",\"isDefault\":true,\"name\":\"AWS EC2 instance network traffic volume unusual\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0001-initial-access\",\"technique:T1190-exploit-public-facing-application\",\"source:apache\",\"scope:apache\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a web application is being scanned. This identifies attacker IP addresses who are not trying to hide their attempt to attack your system. More advanced hackers will use an inconspicuous user agent. \\n\\n### Strategy\\nInspect the user agent in the HTTP headers to determine if an IP is scanning your application and generate an `INFO` signal. \\n\\n### Triage and Response\\n1. Determine if this IP is making authenticated requests to the application.\\n2. If the IP is making authenticated requests to the application:\\n * Investigate the HTTP logs and determine if the user is attacking your application.\\n\\nThe HTTP headers in the query are from [darkqusar][1]'s [gist][2] \\n\\n[1]: https://gist.github.com/darkquasar\\n[2]: https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":6,\"createdAt\":1587530038000,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:apache @http.useragent:(*burp* OR *burpcollaborator.net* OR *qualys* OR *nexpose* OR *OpenVAS* OR *Nikto* OR *Meterpreter* OR *IceWeasel* OR *DirB* OR *Comodo* OR *Tripwire* OR *Retina* OR *MBSA* OR *ImmuniWeb* OR *Netsparker* OR *Acunetix* OR *Intruder* OR *nmap* OR *CVE* OR *base64* OR *eval* OR *javascript* OR *alert*)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ipl-oaz-eqf\",\"isDefault\":true,\"name\":\"Apache HTTP requests from security scanner\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0001-initial-access\",\"technique:T1190-exploit-public-facing-application\",\"source:elb\",\"scope:elb\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a web application is being scanned. This will identify attacker IP addresses who are not trying to hide their attempt to attack your system. More advanced hackers will use an inconspicuous User Agent. \\n\\n### Strategy\\nInspect the user agent in the HTTP headers to determine if an IP is scanning your application and generate an INFO signal.  \\n\\n### Triage and Response\\n1. Determine if this IP is making authenticated requests to the application.\\n2. If the IP is making authenticated requests to the application:\\n * Investigate the HTTP logs and determine if the user is attacking your application.\\n\\nThe HTTP headers in the query are from [darkqusar][1]'s [gist][2] \\n\\n[1]: https://gist.github.com/darkquasar\\n[2]: https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":6,\"createdAt\":1587530043452,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:elb @http.useragent:(*burp* OR *burpcollaborator.net* OR *qualys* OR *nexpose* OR *OpenVAS* OR *Nikto* OR *Meterpreter* OR *IceWeasel* OR *DirB* OR *Comodo* OR *Tripwire* OR *Retina* OR *MBSA* OR *ImmuniWeb* OR *Netsparker* OR *Acunetix* OR *Intruder* OR *nmap* OR *CVE* OR *base64* OR *eval* OR *javascript* OR *alert*)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"csd-1pb-wxh\",\"isDefault\":true,\"name\":\"AWS ELB HTTP requests from security scanner\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0001-initial-access\",\"technique:T1190-exploit-public-facing-application\",\"source:nginx\",\"scope:nginx\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a web application is being scanned. This will identify attacker IP addresses who are not trying to hide their attempt to attack your system. More advanced hackers will use an inconspicuous user agent. \\n\\n### Strategy\\nInspect the user agent in the HTTP headers to determine if an IP is scanning your application and generate an `INFO` signal. \\n\\n### Triage and Response\\n1. Determine if this IP is making authenticated requests to the application.\\n2. If the IP is making authenticated requests to the application:\\n * Investigate the HTTP logs and determine if the user is attacking your application.\\n\\nThe HTTP headers in the query are from [darkqusar][1]'s [gist][2] \\n\\n[1]: https://gist.github.com/darkquasar\\n[2]: https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":6,\"createdAt\":1587530047261,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:nginx @http.useragent:(*burp* OR *burpcollaborator.net* OR *qualys* OR *nexpose* OR *OpenVAS* OR *Nikto* OR *Meterpreter* OR *IceWeasel* OR *DirB* OR *Comodo* OR *Tripwire* OR *Retina* OR *MBSA* OR *ImmuniWeb* OR *Netsparker* OR *Acunetix* OR *Intruder* OR *nmap* OR *CVE* OR *base64* OR *eval* OR *javascript* OR *alert*)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"5jr-xi3-uto\",\"isDefault\":true,\"name\":\"NGINX HTTP requests from security scanner\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0001-initial-access\",\"technique:T1190-exploit-public-facing-application\",\"source:nginx-ingress-controller\",\"scope:nginx-ingress-controller\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a web application is being scanned. This will identify attacker IP addresses who are not trying to hide their attempt to attack your system. More advanced hackers will use an inconspicuous user agent. \\n\\n### Strategy\\nInspect the user agent in the HTTP headers to determine if an IP is scanning your application and generate an `INFO` signal. \\n\\n### Triage and Response\\n1. Determine if this IP is making authenticated requests to the application.\\n2. If the IP is making authenticated requests to the application:\\n * Investigate the HTTP logs and determine if the user is attacking your application.\\n\\nThe HTTP headers in the query are from [darkqusar][1]'s [gist][2] \\n\\n[1]: https://gist.github.com/darkquasar\\n[2]: https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":6,\"createdAt\":1587530154864,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:nginx-ingress-controller @http.useragent:(*burp* OR *burpcollaborator.net* OR *qualys* OR *nexpose* OR *OpenVAS* OR *Nikto* OR *Meterpreter* OR *IceWeasel* OR *DirB* OR *Comodo* OR *Tripwire* OR *Retina* OR *MBSA* OR *ImmuniWeb* OR *Netsparker* OR *Acunetix* OR *Intruder* OR *nmap* OR *CVE* OR *base64* OR *eval* OR *javascript* OR *alert*)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"oxj-rwr-gxq\",\"isDefault\":true,\"name\":\"NGINX ingress controller HTTP requests from security scanner\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0001-initial-access\",\"technique:T1190-exploit-public-facing-application\",\"source:fastly\",\"scope:fastly\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a web application is being scanned. This identifies attacker IP addresses who are not trying to hide their attempt to attack your system. More advanced hackers will use an inconspicuous user agent. \\n\\n### Strategy\\nInspect the user agent in the HTTP headers to determine if an IP is scanning your application and generate an `INFO` signal. \\n\\n### Triage and Response\\n1. Determine if this IP is making authenticated requests to the application.\\n2. If the IP is making authenticated requests to the application:\\n * Investigate the HTTP logs and determine if the user is attacking your application.\\n\\nThe HTTP headers in the query are from [darkqusar][1]'s [gist][2]. \\n\\n[1]: https://gist.github.com/darkquasar\\n[2]: https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":5,\"createdAt\":1587530162282,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:fastly @http.useragent:(*burp* OR *burpcollaborator.net* OR *qualys* OR *nexpose* OR *OpenVAS* OR *Nikto* OR *Meterpreter* OR *IceWeasel* OR *DirB* OR *Comodo* OR *Tripwire* OR *Retina* OR *MBSA* OR *ImmuniWeb* OR *Netsparker* OR *Acunetix* OR *Intruder* OR *nmap* OR *CVE* OR *base64* OR *eval* OR *javascript* OR *alert*)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"dqs-oru-107\",\"isDefault\":true,\"name\":\"Fastly HTTP Requests from Security Scanner\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0001-initial-access\",\"technique:T1190-exploit-public-facing-application\",\"source:iis\",\"scope:iis\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a web application is being scanned. This will identify attacker IP addresses who are not trying to hide their attempt to attack your system. More advanced hackers will use an inconspicuous user agent. \\n\\n### Strategy\\nInspect the user agent in the HTTP headers to determine if an IP is scanning your application and generate an `INFO` signal. \\n\\n### Triage and Response\\n1. Determine if this IP is making authenticated requests to the application.\\n2. If the IP is making authenticated requests to the application:\\n * Investigate the HTTP logs and determine if the user is attacking your application.\\n\\nThe HTTP headers in the query are from [darkqusar][1]'s [gist][2] \\n\\n[1]: https://gist.github.com/darkquasar\\n[2]: https://gist.github.com/darkquasar/84fb2cec6cc1668795bd97c02302d380\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1587530716843,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:iis @http.useragent:(*burp* OR *burpcollaborator.net* OR *qualys* OR *nexpose* OR *OpenVAS* OR *Nikto* OR *Meterpreter* OR *IceWeasel* OR *DirB* OR *Comodo* OR *Tripwire* OR *Retina* OR *MBSA* OR *ImmuniWeb* OR *Netsparker* OR *Acunetix* OR *Intruder* OR *nmap* OR *CVE* OR *base64* OR *eval* OR *javascript* OR *alert*)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ftm-iao-udy\",\"isDefault\":true,\"name\":\"IIS HTTP requests from security scanner\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when there is unauthorized activity by a service account in GCP\\n\\n### Strategy\\nMonitor GCP logs and detect when a service account makes an API request and the request returns the status code equal to `7` within the log attribute `@data.protoPayload.status.code`. The status code `7` indicates the service account did not have permission to make the API call.\\n\\n### Triage & Response\\n1. Determine the service account that made the unauthorized calls.\\n2. Investigate if there is a misconfiguration in IAM permissions or if an attacker compromised the service account\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":4,\"createdAt\":1587592191518,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:gcp.* @data.protoPayload.status.code:7 @usr.id:(*gserviceaccount.com OR *google.com)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"greater than 1000 failed attempts\",\"condition\":\"a > 1000\"},{\"status\":\"medium\",\"notifications\":[],\"name\":\"greater than 100 failed attempts\",\"condition\":\"a > 100\"},{\"status\":\"low\",\"notifications\":[],\"name\":\"greater than 10 failed attempts\",\"condition\":\"a > 10\"}],\"type\":\"threshold\",\"id\":\"89d-2v1-fvm\",\"isDefault\":true,\"name\":\"GCP unauthorized service account activity\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when unauthorized activity by a user is detected in GCP\\n\\n### Strategy\\nMonitor GCP logs and detect when a user account makes an API request and the request returns the status code equal to `7` within the log attribute `@data.protoPayload.status.code`. The status code `7` indicates the user account did not have permission to make the API call.\\n\\n### Triage & Response\\n1. Determine the user who made the unauthorized calls.\\n2. Determine if there is a misconfiguration in IAM permissions or whether an attacker has compromised the user account.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":4,\"createdAt\":1587592193834,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:gcp.* @data.protoPayload.status.code:7 -@usr.id:(*gserviceaccount.com OR *google.com)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"greater than 1000 failed attempts\",\"condition\":\"a > 1000\"},{\"status\":\"medium\",\"notifications\":[],\"name\":\"greater than 100 failed attempts\",\"condition\":\"a > 100\"},{\"status\":\"low\",\"notifications\":[],\"name\":\"greater than 10 failed attempts\",\"condition\":\"a > 10\"}],\"type\":\"threshold\",\"id\":\"stt-ows-yte\",\"isDefault\":true,\"name\":\"GCP unauthorized user activity\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.pubsub.topic\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a GCP Pub/Sub Subscribtion has been deleted. This could stop audit logs from being sent to Datadog.\\n\\n### Strategy\\nMonitor GCP admin activity audit logs to determine when the following method is invoked:\\n\\n* `google.pubsub.v1.Publisher.DeleteTopic`\\n\\n### Triage & Response\\n1. Review the subscribtion and ensure it is properly configured.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1587592198839,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\",\"@data.protoPayload.resourceName\"],\"query\":\"source:gcp.pubsub.topic @evt.name:google.pubsub.v1.Publisher.DeleteTopic\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"dp6-zom-jyv\",\"isDefault\":true,\"name\":\"GCP Pub/Sub topic deleted\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.gcs.bucket\",\"security:attack\",\"tactic:TA0007-discovery\",\"technique:T1083-file-and-directory-discovery\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a service account lists out GCS Buckets.\\n\\n### Strategy\\nThis rule lets you monitor GCS bucket admin activity audit logs to determine when a service account invokes the following method:\\n\\n* `storage.buckets.list`\\n\\n### Triage & Response\\n1. Determine whether this service account should be making list bucket calls.\\n * If the account was compromised, secure the account and investigate how it was compromised and if the account made other unauthorized calls.\\n * If the owner of the service account intended to make the `ListBuckets` API call, consider whether this API call is needed. It could cause a security issue for the application to know the name of the bucket it needs to access. If it's not needed, modify this rule's filter to stop generating signals for this specific service account.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1587592199858,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"project_id\",\"bucket_name\",\"@usr.id\"],\"query\":\"source:gcp.gcs.bucket @evt.name:storage.buckets.list @usr.id:*gserviceaccount.com\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"cnc-wi1-llf\",\"isDefault\":true,\"name\":\"GCP Bucket enumerated\"},{\"creationAuthorId\":0,\"tags\":[\"source:gcp\",\"scope:gcp.pubsub.subscription\",\"security:compliance\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a change to a GCP Pub/Sub Subscription has been made. This could stop audit logs from being sent to Datadog.\\n\\n### Strategy\\nMonitor GCP admin activity audit logs to determine when any of the following methods are invoked:\\n\\n* `google.pubsub.v1.Subscriber.UpdateSubscription`\\n* `google.pubsub.v1.Subscriber.DeleteSubscription`\\n\\n### Triage & Response\\n1. Review the subscribtion and ensure it is properly configured.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":300,\"keepAlive\":300},\"version\":3,\"createdAt\":1587592205917,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\",\"@data.protoPayload.resourceName\"],\"query\":\"source:gcp.pubsub.subscription @evt.name:(google.pubsub.v1.Subscriber.UpdateSubscription OR google.pubsub.v1.Subscriber.DeleteSubscription)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"tsj-mac-mdc\",\"isDefault\":true,\"name\":\"GCP Pub/Sub Subscriber modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:auth0\",\"security:attack\",\"tactic:TA0006-credential-access\",\"technique:T1110-brute-force\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## **Goal:**\\nDetect a brute force attack on a user. \\n\\n## **Strategy:**\\n**To determine a successful attempt:** Detect when the same user fails to login five times and then successfully logs in. This generates a `MEDIUM` severity signal.\\n\\n**To determine an unsuccessful attempt:** Detect when the same user fails to login five times. This generates an `INFO` severity signal.\\n\\n## **Triage & Response:**\\n1. Inspect the logs to see if this was a valid login attempt.\\n2. See if 2FA was authenticated\\n3. If the user was compromised, rotate user credentials.\\n\\n\",\"options\":{\"evaluationWindow\":600,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":3,\"createdAt\":1597422956269,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"failed_login\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:auth0 @evt.name:(failed_login_incorrect_password OR failed_login_invalid_email_or_username)\",\"trackType\":\"logs\"},{\"distinctFields\":[],\"name\":\"successful_login\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:auth0 @evt.name:success_login\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"Successful\",\"condition\":\"failed_login>5 && successful_login>=1\"},{\"status\":\"info\",\"notifications\":[],\"name\":\"Attempt\",\"condition\":\"failed_login>10\"}],\"type\":\"threshold\",\"id\":\"dde-oia-yjr\",\"isDefault\":true,\"name\":\"Brute force attack on an Auth0 user\"},{\"creationAuthorId\":0,\"tags\":[\"source:auth0\",\"security:attack\",\"tactic:TA0006-credential-access\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## **Goal:**\\nDetect log ins from the same user from multiple countries within a short time frame.\\n\\n## **Strategy:**\\nUtilize geo-ip data to detect when a user logs in from two IP addresses which are in different countries within a short time frame.\\n\\n## **Triage & Response:**\\n1. See if 2FA was used for authentication.\\n2. Contact the user and see if this behavior is expected.\\n3. If the user was compromised, rotate the user credentials.\\n\",\"options\":{\"evaluationWindow\":3600,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":4,\"createdAt\":1597422956982,\"filters\":[],\"queries\":[{\"distinctFields\":[\"@network.client.geoip.country.name\"],\"name\":\"successful_logins_by_country\",\"aggregation\":\"cardinality\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:auth0 @evt.name:success_login\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"successful_logins_by_country > 1\"}],\"type\":\"threshold\",\"id\":\"j6f-xqz-wig\",\"isDefault\":true,\"name\":\"Auth0 user authenticating from multiple countries\"},{\"creationAuthorId\":0,\"tags\":[\"source:auth0\",\"security:attack\",\"tactic:TA0001-initial-access\",\"technique:T1078-valid-accounts\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## **Goal:**\\nDetect when a user logs in with a breached password.\\n\\n## **Strategy:**\\nAuth0 logs an event when a user logs in with a breached password. When this event is detected, Datadog generates a `MEDIUM` severity Security Signal.\\n\\nYou can see more information on how Auth0 detects breached passwords on their [documentation][1].\\n\\n## **Triage & Response:**\\n1. Inspect the policy and user location to see if this was a login from approved location\\n2. See if 2FA was authenticated\\n3. If the user was compromised, rotate user credentials.\\n\\n[1][https://auth0.com/docs/anomaly-detection/brute-force-protection]\\n\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":4,\"createdAt\":1597422957145,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"breached_password\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.id\"],\"query\":\"source:auth0 @evt.name:breached_password\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"breached_password > 0\"}],\"type\":\"threshold\",\"id\":\"yhw-avf-dz0\",\"isDefault\":true,\"name\":\"Auth0 user logged in with a breached password\"},{\"creationAuthorId\":0,\"tags\":[\"source:auth0\",\"security:attack\",\"tactic:TA0006-credential-access\",\"technique:T1110-brute-force\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## **Goal:**\\nDetect Account Take Over (ATO) through credential stuffing attack.\\n\\n## **Strategy:**\\n**To determine a successful attempt:** Detect a high number of failed logins from at least ten unique users and at least one successful login for a user. This generates a `HIGH` severity signal.\\n\\n**To determine an unsuccessful attempt:** Detect a high number of failed logins from at least ten unique users. This generates an `INFO` severity signal.\\n\\n## **Triage & Response:**\\n1. Inspect the logs to see if this was a valid login attempt.\\n2. See if 2FA was authenticated\\n3. If the user was compromised, rotate user credentials.\\n\\n\",\"options\":{\"evaluationWindow\":600,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":4,\"createdAt\":1597422958108,\"filters\":[],\"queries\":[{\"distinctFields\":[\"@usr.id\"],\"name\":\"unique_users_failing_to_login\",\"aggregation\":\"cardinality\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:auth0 @evt.name:(failed_login_incorrect_password OR failed_login_invalid_email_or_username)\",\"trackType\":\"logs\"},{\"distinctFields\":[],\"name\":\"successful_login\",\"aggregation\":\"count\",\"groupByFields\":[\"@network.client.ip\"],\"query\":\"source:auth0 @evt.name:success_login\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Successful\",\"condition\":\"unique_users_failing_to_login>10 && successful_login>=1\"},{\"status\":\"info\",\"notifications\":[],\"name\":\"Attempt\",\"condition\":\"unique_users_failing_to_login>10\"}],\"type\":\"threshold\",\"id\":\"ryo-snu-uva\",\"isDefault\":true,\"name\":\"Credential stuffing attack on Auth0\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1158\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nHidden files may be used by attackers to hide from detection mechanisms on hosts and containers. This detection aims at finding the creation of any new hidden files.\\n\\n## Strategy\\nIn Linux, files are hidden from users by prepending `.` to the filename. For example `.some.file`. This detection will monitor for the creation of any file thats name begins with a `.`.\\n\\n## Triage & Response\\n1. Check to see which user or process created the new hidden file.\\n3. If these new files are not expected contain the host or container, roll back to a known good configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":3,\"createdAt\":1598443015169,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"hidden_file\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"irl-syq-8wf\",\"isDefault\":true,\"name\":\"A hidden file was created\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1070\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nMany attackers attempt to evade detection by deleting evidence of their presence on a host or container. A common way to do this is by deleting or modifying critical system logs that would otherwise log their activity. This detection aims to detect an attackers attempts to conceal themselves by destroying log data.\\n\\n## Strategy\\nThis detection monitors the deletion of any log files under `/var/log` which is where many critical Linux log files are stored.\\n\\n## Triage & Response\\n1. Check the name of the log file that was deleted.\\n2. Check which user or process deleted the log.\\n3. If this activity is not expected, contain the host or container, and roll back to a known good configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":3,\"createdAt\":1598516746158,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"logs_removed\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"t7t-jio-cms\",\"isDefault\":true,\"name\":\"A log file in /var/log/ was removed\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1070\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nMany attackers attempt to evade detection by deleting evidence of their presence on a host or container. A common way to do this is by deleting or modifying critical system logs that would otherwise log their activity. This detection aims to detect an attackers attempts to conceal themselves by destroying log data.\\n\\n## Strategy\\nThis detection monitors the truncation (like the clearing of data within) of any log files under `/var/log` which is where many critical Linux log files are stored.\\n\\n## Triage & Response\\n1. Check the name of the log file that was modified.\\n2. Check which user or process modified the log.\\n3. If this activity is not expected, contain the host or container, and roll back to a known good configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":3,\"createdAt\":1598516746163,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"logs_altered\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"llg-1g6-q0n\",\"isDefault\":true,\"name\":\"Log data in /var/log/ was deleted\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1003\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nAttackers looking for a specific mission target commonly gain access to a host or container adjacent to their mission target. To move laterally to the planned target, attackers commonly try to find credentials that would give them access to the host or container in question. A technique for finding these credentials is memory dumping. By dumping the contents of system memory to disk, an attacker can often find unencrypted credentials.\\n\\n## Strategy\\nThis detection monitors the access of memory and memory maps that can be accessed from the `/proc/` directory on Linux.\\n\\n## Triage & Response\\n1. If this activity is not expected, contain the host or container, and roll back to a known good configuration.\\n2. Consider rotating any credentials that were in use on the host/container.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":4,\"createdAt\":1598516746171,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"memory_dump\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"lhm-dok-amc\",\"isDefault\":true,\"name\":\"Memory files in /proc/ were accessed\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1215\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nKernel modules can be used to automatically execute code when a host starts up. Attackers sometimes use kernel modules to gain persistence on a particular host, ensuring that their code is executed even after a system reboot. Kernel modules also can help attackers gain elevated permissions on a system.\\n\\n## Strategy\\nKernel modules are loaded from the `/lib/modules` directory in Linux. This detection watches for all new files created under that directory.\\n\\n## Triage & Response\\n1. Check the name of the new kernel module created.\\n2. Check which user or process created the module.\\n3. If the new kernel module is not expected, contain the host or container, and roll back to a known good configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":4,\"createdAt\":1598516746168,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"kernel_module\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"jq9-m1m-spt\",\"isDefault\":true,\"name\":\"A kernel module was added to /lib/modules/\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1003\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nDetect modifications to sensitive credential files from non-standard processes.\\n\\n## Strategy\\nEspecially in production, all credentials should be either defined as code, or static. Drift and unmonitored changes to these credentials can open up attack vectors for adversaries, and cause your organization to be out of compliance with any frameworks or regulations that you are subject to. This detection watches for the modification of sensitive credential files which should not be changed outside of their definitions as code (or static definitions). The Linux commands `vipw` and `vigr` are the standard way to modify shadow and gshadow files respectively. Other processes interacting with these sensitive credential files is highly suspicious and should be investigated.\\n\\n## Triage & Response\\n1. Check to see which user or process changed the credential file(s).\\n2. Check what was changed in the credential files.\\n3. If these changes are not acceptable, roll back contain the host or container in question to an acceptable configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":4,\"createdAt\":1598516746271,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"credential_modified\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"srd-2ub-jov\",\"isDefault\":true,\"name\":\"Either /etc/shadow/ or /etc/gshadow was modified by a non-standard tool\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1222\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nTo access protected files and directories, attackers may attempt to change the permissions on these files and directories.\\n\\n## Strategy\\nThis detection monitors the permissions changes to sensitive files and directories such as `/etc/` and `/sbin/`.\\n\\n## Triage & Response\\n1. Check to see if the file or directory was made more permissive.\\n2. Check which user or process made the change.\\n3. If these changes are unexpected, contain the host or container and roll back to the last known good configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":3,\"createdAt\":1598516746259,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"permissions_changed\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"mj3-ucf-hr6\",\"isDefault\":true,\"name\":\"Permissions were changed on sensitive Linux files\"},{\"creationAuthorId\":1445416,\"tags\":[\"service:some-service\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"a\",\"options\":{\"evaluationWindow\":900,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1599126333230,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"*\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"eol-yqs-wbv\",\"isDefault\":false,\"name\":\"test-rule-matias\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599134105443,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599134103\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"vs6-pwt-gpj\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599134103\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599134159772,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599134158\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"cco-erf-p2w\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599134158\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599134254706,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599134248\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"nii-9xm-qnc\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599134248\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599134391783,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599134390\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"rrx-xzq-jrh\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599134390\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":5,\"createdAt\":1599153447571,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22929-1599153447\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"vcx-5wx-fwi\",\"isDefault\":false,\"name\":\"java-listSignals-22929-1599153447\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599153505396,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22929-1599153505\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ogt-z7b-ipx\",\"isDefault\":false,\"name\":\"java-searchSignals-22929-1599153505\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599153621941,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22929-1599153621\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dmr-vn6-huu\",\"isDefault\":false,\"name\":\"java-listSignals-22929-1599153621\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599153644552,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22929-1599153644\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"mft-vvk-aic\",\"isDefault\":false,\"name\":\"java-searchSignals-22929-1599153644\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599155869513,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22929-1599155869\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"wp6-rbi-qsh\",\"isDefault\":false,\"name\":\"java-listSignals-22929-1599155869\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599155891770,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22929-1599155891\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"hhq-b3x-ane\",\"isDefault\":false,\"name\":\"java-searchSignals-22929-1599155891\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599156011645,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22929-1599156011\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"vgh-yb3-hxr\",\"isDefault\":false,\"name\":\"java-searchSignals-22929-1599156011\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599159964419,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22929-1599159964\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"s4j-fgc-c8c\",\"isDefault\":false,\"name\":\"java-listSignals-22929-1599159964\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599160022693,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22929-1599160022\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"xbq-b3b-ksq\",\"isDefault\":false,\"name\":\"java-searchSignals-22929-1599160022\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599160037921,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22929-1599160037\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"cpy-qzi-hxr\",\"isDefault\":false,\"name\":\"java-listSignals-22929-1599160037\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599160059877,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22929-1599160059\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"bxg-qqs-ygx\",\"isDefault\":false,\"name\":\"java-searchSignals-22929-1599160059\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599161371031,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22929-1599161370\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"i1a-omd-oj9\",\"isDefault\":false,\"name\":\"java-listSignals-22929-1599161370\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599161428787,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22929-1599161428\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"wby-3fm-lyo\",\"isDefault\":false,\"name\":\"java-searchSignals-22929-1599161428\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599161547806,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22929-1599161547\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"htw-lz1-4iu\",\"isDefault\":false,\"name\":\"java-searchSignals-22929-1599161547\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599161579395,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22929-1599161579\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ihz-asy-sha\",\"isDefault\":false,\"name\":\"java-listSignals-22929-1599161579\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599162010583,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22939-1599162010\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"is4-hrp-k0t\",\"isDefault\":false,\"name\":\"java-listSignals-22939-1599162010\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599162074185,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-22939-1599162073\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"zdy-lmb-zab\",\"isDefault\":false,\"name\":\"java-searchSignals-22939-1599162073\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599162110473,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-22939-1599162110\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"brf-h17-5vs\",\"isDefault\":false,\"name\":\"java-listSignals-22939-1599162110\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599209950568,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599209949\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"cre-wha-1kx\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599209949\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599209995680,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599209994\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"7yd-4j9-8hw\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599209994\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599210025889,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599210024\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ixn-udh-thi\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599210024\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599210066243,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599210064\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"hbr-upb-ayd\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599210064\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599212622987,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599212621\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"1po-hv8-icu\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599212621\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599212701512,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599212700\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"htq-tk7-bf0\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599212700\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220004289,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220003\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"kgg-9o0-l6f\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220003\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220140863,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220139\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"n9o-qce-o54\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220139\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220172697,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220171\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dti-h8a-unw\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220171\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220323674,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220322\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"jws-t6c-g3n\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220322\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220519474,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220518\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"rwu-gvm-4wg\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220518\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220619570,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220618\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"eio-sao-ost\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220618\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220815963,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220814\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"6ao-qqi-ykf\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220814\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220882235,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220880\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"juw-hof-5oj\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220880\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599220951487,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599220950\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"q4c-zdg-pfd\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599220950\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599221043024,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599221041\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"xmf-f1t-svq\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599221041\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599221096959,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599221095\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"q2l-pim-k30\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599221095\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599221139696,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599221138\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"jpv-wet-sw2\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599221138\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599221198392,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599221196\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"wyu-byk-bmu\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599221196\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599221333434,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599221332\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"2ub-qsr-21s\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599221332\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599221505251,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599221503\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"3nu-0x9-l7v\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599221503\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599221982452,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599221981\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"wgq-kqo-lu1\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599221981\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599222046357,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599222044\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"5gd-a3o-ukq\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599222044\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599222089250,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599222087\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"o78-mgc-tsr\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599222087\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599222178397,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599222177\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"zpe-jk7-wit\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599222177\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599222521204,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599222519\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"xqw-j6g-5oq\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599222519\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599222833586,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599222832\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"bty-6ab-olv\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599222832\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599223092931,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599223091\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"9kx-ar0-hny\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599223091\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599223178953,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599223177\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"otx-kje-qfh\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599223177\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599223869207,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599223867\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"oxu-cxe-7ek\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599223867\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599223917365,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599223915\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"uaa-o8p-tra\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599223915\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599224633849,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599224632\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"x3r-2bb-qpo\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599224632\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599224840236,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599224839\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"xwk-enq-sfa\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599224839\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599224889639,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599224888\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"r63-i4o-1nw\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599224888\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599225645783,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-23010-1599225645\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"c9m-4oe-cle\",\"isDefault\":false,\"name\":\"java-listSignals-23010-1599225645\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599225673457,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-23010-1599225673\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"pte-bjs-grc\",\"isDefault\":false,\"name\":\"java-searchSignals-23010-1599225673\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599226479626,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599226477\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"vt5-fpr-xfw\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599226477\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599226514876,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599226514\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"unc-wuk-dfc\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599226514\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599227817243,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599227815\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"2dg-idc-6vu\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599227815\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599227879439,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599227879\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"stw-ved-pov\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599227879\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599229267595,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599229266\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"yg2-xyq-vwb\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599229266\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599229353977,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599229352\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"3ad-qri-dzg\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599229352\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599229394343,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599229394\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"n2k-uja-z3a\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599229394\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599468893293,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-23114-1599468893\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"m1y-hl2-raz\",\"isDefault\":false,\"name\":\"java-listSignals-23114-1599468893\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599468931131,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-23114-1599468930\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ckg-nqm-lpv\",\"isDefault\":false,\"name\":\"java-searchSignals-23114-1599468930\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599477695615,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599477694\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"lp2-80z-uk1\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599477694\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599477770145,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599477768\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"elf-ati-hnu\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599477768\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599478156239,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599478151\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"qu4-3s1-nlx\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599478151\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599478202471,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599478201\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ncn-y9i-vox\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599478201\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599478286505,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599478284\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"nzh-lr6-edt\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599478284\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599478322167,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599478321\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"zxz-zsn-rsu\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599478321\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599479003316,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1599479001\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"xrg-vrr-mhr\",\"isDefault\":false,\"name\":\"java-listSignals-local-1599479001\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599479043760,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-local-1599479043\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"epu-tzv-vcx\",\"isDefault\":false,\"name\":\"java-searchSignals-local-1599479043\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599480276003,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-23136-1599480275\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"7fi-riy-bhx\",\"isDefault\":false,\"name\":\"java-listSignals-23136-1599480275\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599480302020,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-23136-1599480301\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"nsz-oxg-tqz\",\"isDefault\":false,\"name\":\"java-searchSignals-23136-1599480301\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599481552607,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-23140-1599481552\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"aoq-ach-98h\",\"isDefault\":false,\"name\":\"java-listSignals-23140-1599481552\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599481579855,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-23140-1599481579\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dmm-nim-fpa\",\"isDefault\":false,\"name\":\"java-searchSignals-23140-1599481579\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:cloudtrail\",\"scope:cloudtrail\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure that AWS CloudTrail is enabled.\\n\\n### Rationale\\n\\nAWS CloudTrail enables you to configure regions from one location to maintain infrastructure security.\\n\\n### Remediation\\n\\n1. Run `aws cloudtrail describe-trails`\\n2. Run `update-trail` on any returned trail name above to [enable multi-region-trail][1].\\n\\n    ```\\n    aws cloudtrail update-trail\\n        --name GlobalTrailName\\n        --is-multi-region-trail\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-create-and-update-a-trail-by-using-the-aws-cli-update-trail.html\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":8,\"createdAt\":1599573999944,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudtrail -@is_multi_region_trail:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"v41-4ht-rxo\",\"isDefault\":true,\"name\":\"CloudTrail Multi-Region is not Enabled\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:redshift\",\"scope:redshift\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nConfirm [Redshift Clusters][1] are using the [AWS EC2-VPC platform][2] for better cluster security.\\n\\n### Rationale\\n\\nThe AWS EC2-VPC platform offers better security control and traffic routing for clusters than the outdated EC2-Classic platform.\\n\\n### Remediation\\n\\n1. Run `describe-clusters` with a `cluster-identifier` to [retrieve cluster metadata][2].\\n\\n    ```\\n    aws redshift describe-clusters\\n\\t    --cluster-identifier cluster-id\\n    ```\\n\\n2. Run `create-cluster` with the metadata to [launch a new cluster within a VPC][3].\\n\\n    ```\\n        aws redshift create-cluster\\n            --cluster-identifier cluster-id\\n            --vpc-security-group-ids id-012a3b4c\\n            --port 5439\\n            ...\\n    ```\\n\\n3. Re-run `describe-clusters` with a [custom query filter][4] to retrieve the database cluster endpoint.\\n\\n    ```\\n    aws redshift describe-clusters\\n\\t    --cluster-identifier cluster-id\\n\\t    --query 'Clusters[*].Endpoint.Address'\\n    ```\\n\\n4. Reload the old cluster data into the new database cluster with the [Unload Copy Utility][5].\\n\\n5. Run `delete-cluster` to [delete the old cluster][6].\\n\\n    ```\\n    aws redshift create-cluster\\n\\t    --cluster-identifier old-cluster-identifier\\n\\t    ...\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-clusters.html\\n[2]: https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.FindDefaultVPC.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/emr/create-cluster.html\\n[4]: https://docs.aws.amazon.com/documentdb/latest/developerguide/db-cluster-endpoints-find.html\\n[5]: https://github.com/awslabs/amazon-redshift-utils/tree/master/src/UnloadCopyUtility\\n[6]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/delete-cluster.html\\n\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999940,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_redshift @vpc_id:\\\"\\\"\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"goz-ys2-tll\",\"isDefault\":true,\"name\":\"Redshift Cluster In VPC\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.7\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nPassword policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure passwords are comprised of different character sets. It is recommended that the password policy require at least one symbol.\\n\\n## Rationale\\n\\nSetting a password complexity policy increases account resiliency against brute force login attempts.\\n\\n## Remediation\\n\\nPerform the following to set the password policy using the AWS Console:\\n\\n1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) \\n2. Go to IAM Service on the AWS Console \\n3. Click on Account Settings on the Left Pane \\n4. Check \\\"Require at least one non-alphanumeric character\\\" \\n5. Click \\\"Apply password policy\\\" Using the AWS CLI, run:\\n     ```\\n     aws iam update-account-password-policy --require-symbols \\n     ```\\n\\n**Note**: All commands starting with \\\"aws iam update-account-password-policy\\\" can be combined into a single command.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78905-7\\n\\n## CIS Controls\\n\\n16 Account Monitoring and Control Account Monitoring and Control                \\n\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999909,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_account_password_policy @require_symbols:false\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"dwv-hdv-vfe\",\"isDefault\":true,\"name\":\"Ensure IAM password policy require at least one symbol\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.2\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nMulti-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password, and for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.\\n\\n## Rationale\\n\\nEnabling MFA provides increased security for console access as it requires the authenticating principal to possess a device that emits a time-sensitive key and have knowledge of the credential.\\n\\n## Remediation\\n\\nPerform the following to enable MFA:\\n\\n1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/iam/][3]. \\n2. In the navigation pane, choose Users. \\n3. In the User Name list, choose the name of the intended MFA user. \\n4. Choose the Security Credentials tab, and then choose Manage MFA Device. \\n5. In the Manage MFA Device wizard, choose A virtual MFA device, and then choose Next Step. IAM generates and displays configuration information for the virtual MFA device, including a QR code graphic. The graphic represents the 'secret configuration key' that is available for manual entry on devices that do not support QR codes. \\n6. Open your virtual MFA application. (For a list of apps that you can use for hosting virtual MFA devices, see Virtual MFA Applications.) If the virtual MFA application supports multiple accounts (multiple virtual MFA devices), choose the option to create a new account (a new virtual MFA device). \\n7. Determine whether the MFA app supports QR codes, and then do one of the following: Use the app to scan the QR code. For example, you might choose the camera icon or choose an option similar to Scan code, and then use the device's camera to scan the code. In the Manage MFA Device wizard, choose Show secret key for manual configuration, and then type the secret configuration key into your MFA application. When you are finished, the virtual MFA device starts generating one-time passwords. \\n8. In the Manage MFA Device wizard, in the Authentication Code 1 box, type the one-time password that currently appears in the virtual MFA device. Wait up to 30 seconds for the device to generate a new one-time password. Then type the second one-time password into the Authentication Code 2 box. Choose Active Virtual MFA. Forced IAM User Self-Service Remediation Amazon has published a pattern that forces users to self-service setup MFA before they have access to their complete permissions set. Until they complete this step, they cannot access their full permissions. This pattern can be used on new AWS accounts. It can also be used on existing accounts - it is recommended users are given instructions and a grace period to accomplish MFA enrollment before active enforcement on existing AWS accounts. How to Delegate Management of Multi-Factor Authentication to AWS IAM Users\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. [http://tools.ietf.org/html/rfc6238][1]\\n2. [http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa.html][2]\\n3. CCE-78901-6 4. CIS CSC v6.0 #5.6, #11.4, #12.6, #16.11\\n\\n## CIS Controls\\n\\n4.5 Use Multifactor Authentication For All Administrative Access Use multi-factor authentication and encrypted channels for all administrative account access.\\n\\n[1]: http://tools.ietf.org/html/rfc6238\\n[2]: http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa.html\\n[3]: https://console.aws.amazon.com/iam/\\n\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999956,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_credential_report ((@password_enabled:true -@password_last_used:No_Information @password_last_used_age:*) OR (@password_enabled:true @password_last_used:No_Information @password_last_changed_age:*) OR (@access_key_1_active:true -@access_key_1_last_used_date:\\\"N/A\\\" @access_key_n_last_used_age:*) OR (@access_key_2_active:true -@access_key_2_last_used_date:\\\"N/A\\\" @access_key_n_last_used_age:*) OR (@access_key_1_active:true @access_key_1_last_used_date:\\\"N/A\\\" @access_key_1_last_rotated_age:*) OR (@access_key_2_active:true @access_key_2_last_used_date:\\\"N/A\\\" @access_key_2_last_rotated_age:*))\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"zd5-wvv-hv5\",\"isDefault\":true,\"name\":\"Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to host using the Internet Control Message Protocol (ICMP), a protocol commonly used to troubleshoot TCP/IP networks and deliver IP packets, and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) attacks and Smurf/Fraggle attacks, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `describe-security-groups` with a filter to [expose security groups][1] that allow access to host using ICMP.\\n\\n    ```\\n    aws ec2 describe-security-groups\\n\\t    --filters Name=ip-permission.protocol,Values=icmp Name=ip-permission.cidr,Values='192.0.2.0/24'\\n\\t    --query 'SecurityGroups[*].{Name:GroupName}'\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999911,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress  @to_port:ALL (@protocol:icmp OR @protocol:all) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"kyz-e99-tys\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound ICMP Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the possibility of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 445, commonly used by client/server applications, and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) or man-in-the-middle attacks (MITM), can occur when permitting unrestricted Common Internet File System (CIFS) access, the port commonly used by client/server applications as a means of communication between network nodes over TPC.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 445.\\n\\n    ```\\n        aws ec2 revoke-security-group-ingress\\n            --group-name group-name\\n            --protocol tcp\\n            --port 445\\n            --cidr 0.0.0.0/0\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict CIFS access.\\n\\n    ```\\n        aws ec2 authorize-security-group-ingress\\n            --group-name your-group-name\\n            --protocol tcp\\n            --port 445\\n            --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999953,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:445 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"l9k-64o-mzm\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound CIFS Access\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.9\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nPassword policies are, in part, used to enforce password complexity requirements. Use IAM password policies to ensure passwords are a minimum length. The password policy should require a minimum password length of 14 characters.\\n\\n## Rationale\\n\\nSetting a password complexity policy increases account resiliency against brute force login attempts.\\n\\n## Remediation\\n\\nPerform the following to set the password policy using the AWS console:\\n\\n1. Login to AWS Console with appropriate permissions to View Identity Access Management Account Settings: [https://console.aws.amazon.com/][1]\\n2. Go to IAM Service on the AWS Console \\n3. Click on Account Settings on the Left Pane \\n4. Set \\\"Minimum password length\\\" to 14 or greater. \\n5. Click \\\"Apply password policy\\\". Using the AWS CLI, run: \\n    ```\\n    aws iam update-account-password-policy --minimum-password-length 14\\n    ```\\n\\n**Note**: All commands starting with \\\"aws iam update-account-password-policy\\\" can be combined into a single command.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78907-3 2. CIS CSC v6.0 #5.7, #16.12\\n\\n## CIS Controls\\n\\n16 Account Monitoring and Control                \\n\\n[1]: https://console.aws.amazon.com/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999939,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_account_password_policy @minimum_password_length:false\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"fyg-ptq-tnx\",\"isDefault\":true,\"name\":\"Ensure IAM password policy requires minimum length of 14 or greater\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\nReduce the possibility of a breach by checking EC2 security groups for inbound rules that allow unfettered access to TCP and UDP port 53, commonly used during DNS resolution when a request is sent from DNS clients to DNS servers or between DNS servers.\\n\\n### Rationale\\n\\nMalicious activity, such as distributed denial-of-service (DDoS) attacks, can occur when permitting unfettered DNS access.\\n\\n### Remediation\\n\\n1. Run `describe-security-groups` with a filter to [expose security groups][1] that allow access to port 53.\\n\\n    ```\\n    aws ec2 revoke-security-group-egress\\n        --group-id your-group-id\\n        --ip-permissions '[{\\\"IpProtocol\\\": \\\"tcp\\\", \\\"FromPort\\\": 53, \\\"ToPort\\\": 53, \\\"IpRanges\\\": [{\\\"CidrIp\\\": \\\"192.0.2.0/24\\\"}]}]'\\n    ```\\n\\n[1]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/describe-clusters.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999958,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:53 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"kri-ci1-ymo\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound DNS Access\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.5\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nPassword policies are, in part, used to enforce password complexity requirements. Use IAM password policies to ensure passwords are comprised of different character sets. The password policy should require at least one uppercase letter.\\n\\n## Rationale\\n\\nSetting a password complexity policy increases account resiliency against brute force login attempts.\\n\\n## Remediation\\n\\nPerform the following to set the password policy:\\n\\n1. Login to AWS Console with appropriate permissions to View Identity Access Management Account Setting: [https://console.aws.amazon.com/][1] \\n2. Go to IAM Service on the AWS Console \\n3. Click on Account Settings on the Left Pane \\n4. Check \\\"Requires at least one uppercase letter\\\" \\n5. Click \\\"Apply password policy\\\". Using the AWS CLI, run: \\n    ```\\n    aws iam update-account-password-policy --require-uppercase-characters \\n    ```\\n\\n**Note**: All commands starting with \\\"aws iam update-account-password-policy\\\" can be combined into a single command.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78903-2\\n\\n## CIS Controls\\n\\n16 Account Monitoring and Control\\n\\n[1]: https://console.aws.amazon.com/\\n\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999945,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_account_password_policy @require_uppercase_characters:false\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"jfe-07v-m1n\",\"isDefault\":true,\"name\":\"Ensure IAM password policy requires at least one uppercase letter\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.13\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe root account is the most privileged user in an AWS account. MFA (multi-factor authentication) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they are prompted for their user name and password and an authentication code from their AWS MFA device. \\n\\n**Note**: When virtual MFA is used for root accounts, it should not be enabled on a personal device, but rather enable a dedicated and not personally owned mobile device (tablet or phone)(\\\"non-personal virtual MFA\\\"). This lessens the risks of losing access to the MFA due to device loss, device trade-in, or if the individual owning the device is no longer employed at the company.\\n\\n## Rationale\\n\\nEnabling MFA provides increased security for console access as it requires the authenticating principal to possess a device that emits a time-sensitive key and has knowledge of a credential.\\n\\n## Remediation\\n\\nPerform the following to establish MFA for the root account: \\n1. Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/iam/. \\n    **Note**: to manage MFA devices for the root AWS account, you must use your root account credentials to sign in to AWS. You cannot manage MFA devices for the root account using other credentials. \\n2. Choose Dashboard , and under Security Status , expand Activate MFA on your root account. \\n3. Choose Activate MFA \\n4. In the wizard, choose A virtual MFA device and then choose Next Step. \\n5. IAM generates and displays configuration information for the virtual MFA device, including a QR code graphic. The graphic is a representation of the 'secret configuration key' that is available for manual entry on devices that do not support QR codes. \\n6. Open your virtual MFA application. (For a list of apps that you can use for hosting virtual MFA devices, see Virtual MFA Applications.) If the virtual MFA application supports multiple accounts (multiple virtual MFA devices), choose the option to create a new account (a new virtual MFA device). \\n7. Determine whether the MFA app supports QR codes, and then do one of the following: \\n    - Use the app to scan the QR code. For example, you might choose the camera icon or choose an option similar to Scan code, and then use the device's camera to scan the code. \\n    - OR In the Manage MFA Device wizard, choose Show secret key for manual configuration, and then type the secret configuration key into your MFA application. \\n   When you are finished, the virtual MFA device starts generating one-time passwords. \\n\\nTo authenticate with MFA: \\n\\n1. In the Manage MFA Device wizard, in the Authentication Code 1 box, type the one-time password that currently appears in the virtual MFA device. Wait up to 30 seconds for the device to generate a new one-time password. \\n2. Type the second one-time password into the Authentication Code 2 box. Choose Active Virtual MFA.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78911-5 2. CIS CSC v6.0 #5.6, #11.4, #12.6, #16.11\\n\\n## CIS Controls\\n\\n4.5 Use Multifactor Authentication For All Administrative Access - Use multi-factor authentication and encrypted channels for all administrative account access.                \\n\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599573999963,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_account_summary @account_mfa_enabled:0 @account_name:\\\"<root account>\\\"\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"critical\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"dth-jwu-9zo\",\"isDefault\":true,\"name\":\"Ensure MFA is enabled for the \\\"root\\\" account\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:redshift\",\"scope:redshift\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nConfirm [Redshift clusters][1] are using a custom master user name, versus the default master user name.\\n\\n### Rationale\\n\\nDefault master user names for publicly accessible clusters can be a backdoor for hacking. While setting a customer master user name alone does not fully protect against attacks, restricting the root account only to privileged users and using additional password measures can add an additional layer of protection.\\n\\n### Remediation\\n\\n1. Run `describe-clusters` with a `cluster-identifier` to [retrieve cluster metadata][2].\\n\\n    ```\\n    aws redshift describe-clusters\\n\\t    --cluster-identifier cluster-name\\n    ```\\n\\n2. Run `create-cluster` with the returned cluster metadata to [launch a new cluster][3] with the existing metadata and a new master user name.\\n\\n    ```\\n    aws redshift create-cluster\\n\\t    --cluster-identifier old-cluster-identifier\\n\\t    --master-username awsmasterusr\\n        --vpc-security-group-ids id-012a3b4c\\n        ...\\n    ```\\n\\n3. Re-run `describe-clusters` with a [custom query filter][4] to retrieve the database cluster endpoint.\\n\\n    ```\\n    aws redshift describe-clusters\\n\\t    --cluster-identifier new-cluster-identifier\\n\\t    --query 'Clusters[*].Endpoint.Address'\\n    ```\\n\\n4. Reload the old cluster data into the new database cluster with the [Unload Copy Utility][5].\\n5. Use the returned new database cluster endpoint URL from step 3 to update your application's configuration to point to the new cluster endpoint.\\n6. Run `delete-cluster` to [delete the old cluster][6].\\n\\n    ```\\n    aws redshift create-cluster\\n\\t    --cluster-identifier old-cluster-identifier\\n\\t    ...\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-clusters.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ecs/describe-clusters.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/emr/create-cluster.html\\n[4]: https://docs.aws.amazon.com/documentdb/latest/developerguide/db-cluster-endpoints-find.html\\n[5]: https://github.com/awslabs/amazon-redshift-utils/tree/master/src/UnloadCopyUtility\\n[6]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/delete-cluster.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574001675,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_redshift @master_username:awsuser\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"ewv-jbb-gxa\",\"isDefault\":true,\"name\":\"Redshift Cluster Default Master Username\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:cloudfront\",\"scope:cloudfront\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nVerify that AWS CloudFront distributions have a security policy of TLS v1.1 or greater.\\n\\n### Rationale\\n\\nTLS v1.1, the minimum protocol recommended for AWS CloudFront, and the cipher used to encrypt this content, improve application security.\\n\\n### Remediation\\n\\n1. Run `get-distribution-config` with your AWS CloudFront distribution ID to retrieve your [distribution's configuration information][1].\\n\\n\\t```\\n    aws cloudfront get-distribution-config\\n        --id ID000000000000\\n    ```\\n\\n2. In a new JSON file, modify the returned configuration by setting the minimum protocol version to TLC v1.1 (2016) or v1.2 (2018).\\n\\n    ```\\n    {\\n      \\\"ETag\\\": \\\"ETAG0000000000\\\",\\n      \\\"DistributionConfig\\\": {\\n        ...\\n        \\\"ViewerCertificate\\\": {\\n          ...\\n          \\\"MinimumProtocolVersion\\\": \\\"TLSv1.1_2016\\\",\\n        },\\n        ...\\n      }\\n    }\\n    ```\\n\\n3. Run `update-distribution` to [update your distribution][2] with your distribution `id`, the path of the configuration file (created in step 2), and your `etag`.\\n\\n    ```\\n    aws cloudfront update-distribution\\n        --id ID000000000000\\n        --distribution-config tls-version.json\\n        --if-match ETAG0000000000\\n    ```\\n\\n[1]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudfront/get-distribution-config.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudfront/update-distribution.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574001774,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudfront (@distribution_config_viewer_certificate_minimum_protocol_version:\\\"TLSv1\\\" OR @distribution_config_viewer_certificate_minimum_protocol_version:\\\"TLSv1_2016\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"2np-sw5-cre\",\"isDefault\":true,\"name\":\"CloudFront Security Policy: Insecure Minimum Protocol Version\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:rds\",\"scope:rds\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nConfirm [Amazon RDS database instances][1] are not using default ports. This includes default ports such as MySQL/Aurora port 3306, SQL Server port 1433, and PostgreSQL port 5432.\\n\\n### Rationale\\n\\nUsing a custom port can protect against potential brute-force and dictionary attacks.\\n\\n### Remediation\\n\\n1. Run `create-db-snapshot` with your database instance and snapshot identifiers to [create a snapshot][2].\\n\\n    ```\\n    aws rds create-db-snapshot \\\\\\n        --db-instance-identifier database-mysql \\\\\\n        --db-snapshot-identifier snapshotidentifier\\n    ```\\n\\n2. Run `modify-db-instance` with a new, valid port number. A [list of port numbers are available][3].\\n\\n    ```\\n    aws rds modify-db-instance \\\\\\n        --db-instance-identifier database-identifier \\\\\\n        --option-group-name test-group-name \\\\\\n        --db-parameter-group-name test-sqlserver-name \\\\\\n        --apply-immediately\\n    ```\\n\\n\\n\\n[1]: https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/create-db-snapshot.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/modify-db-instance.html#options\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574001845,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_rds (@endpoint_port:3306 OR @endpoint_port:1433 OR @endpoint_port:5432 OR @endpoint_port:1521)\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"y0x-lgk-w1h\",\"isDefault\":true,\"name\":\"RDS Default Port\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP ports 20 and 21 (used by client/server applications for communication and file transfer) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as spoofing, brute-force, and FTP bounce attacks, can occur when permitting unfettered access to these ports.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 20 and 21.\\n\\n    ```\\n    aws ec2 revoke-security-group-egress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 20\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict FTP access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 20\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574002076,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress  (@to_port:20 OR  @to_port:21 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"9lv-1l3-vtp\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound FTP Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:cloudtrail\",\"scope:cloudtrail\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure that an AWS CloudTrail trail has file integration validation enabled.\\n\\n### Rationale\\n\\nAWS CloudTrail file integration validation can verify whether files were modified or changed once delivered to an S3 bucket.\\n\\n### Remediation\\n\\n1. Run `aws cloudtrail describe-trails`\\n2. Run `update-trail` on any returned trail name above to [enable-log-file-validation][1].\\n\\n    ```\\n    aws cloudtrail update-trail\\n        --name GlobalTrailName\\n        --enable-log-file-validation\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-enabling.html\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574002238,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudtrail -@log_file_validation_enabled:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"ubl-mrs-ket\",\"isDefault\":true,\"name\":\"CloudTrail Log File Integrity Validation Disabled\"},{\"creationAuthorId\":0,\"tags\":[\"control:2.8\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:2\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:kms\",\"scope:kms\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAWS Key Management Service (KMS) allows customers to rotate the backing key, the key material stored within the KMS. The KMS connects o the key ID of the customer created customer master key (CMK). This backing key is used to perform cryptographic operations such as encryption and decryption. Automatic key rotation currently retains all prior backing keys so that encrypted data can be decrypted transparently. You should enable CMK key rotation.\\n\\n## Rationale\\n\\nRotating encryption keys helps reduce the potential impact of a compromised key as data encrypted with a new key cannot be accessed with a previous key that may have been exposed.\\n\\n## Remediation\\n\\nVia the Management Console: \\n\\n1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/iam][1]. \\n2. In the left navigation pane, choose Encryption Keys. \\n3. Select a customer created master key (CMK)\\n4. Under the Key Policy section, move down to Key Rotation. \\n5. Check the Rotate this key every year checkbox. Via CLI 1. Run the following command to enable key rotation: \\n    ```\\n    aws kms enable-key-rotation --key-id <kms_key_id>\\n    ```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. [https://aws.amazon.com/kms/pricing/][2] \\n2. [http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57_part1_rev3_general.pdf][3] \\n3. CCE-78920-6\\n\\n## CIS Controls\\n\\n6 Maintenance, Monitoring, and Analysis of Audit Logs\\n\\n[1]: https://console.aws.amazon.com/iam\\n[2]: https://aws.amazon.com/kms/pricing/\\n[3]: http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57_part1_rev3_general.pdf\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574002243,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_kms @key_rotation_enabled:false\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"5xm-kxb-jxz\",\"isDefault\":true,\"name\":\"Ensure rotation for customer created CMKs is enabled\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:cloudtrail\",\"scope:cloudtrail\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure that AWS CloudTrail logs are encrypted.\\n\\n### Rationale\\n\\nEncrypting AWS CloudTrail logs with a KMS encryption key helps protect your data and ensures only certain IAM users can access these logs.\\n\\n### Remediation\\n\\n1. Create a new policy configuration file that enables CloudTrail [encrypting and decrypting permissions][1].\\n2. Run `create-key` using the policy file path.\\n\\n    ```\\n    aws kms create-key\\n        --policy new-policy-file.json\\n    ```\\n\\n3. Run `create-alias` with a [newly created alias name][2] and the `target-key-id` as the KMS key returned in step 2.\\n\\n    ```\\n    aws kms create-alias\\n        --alias-name alias/CloudTrailKSM\\n        --target-key-id 12345678-abcd-1a2b-1234-012345678901\\n    ```\\n\\n4. Run `update-trail` on [the trail name you wish to update][3] and the KMS key returned in step 2.\\n\\n    ```\\n    aws cloudtrail update-trail\\n        --name MyGlobalTrail\\n        --kms-key-id 12345678-abcd-1a2b-1234-012345678901\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/awscloudtrail/latest/userguide/create-kms-key-policy-for-cloudtrail.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/create-trail.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/update-trail.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574002335,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudtrail -@kms_key_id:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"cww-xfw-no7\",\"isDefault\":true,\"name\":\"CloudTrail Logs Not Encrypted\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 1521 (used by the Oracle Database Server) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) attacks and hacking, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 1521.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 1521\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 1521 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 1521\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574002369,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:1521 OR  @to_port:ALL) (@protocol:tcp OR @protocol:all) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"2wg-auf-5gz\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound Oracle Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:redshift\",\"scope:redshift\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nConfirm [Redshift clusters][1] are not publicly available.\\n\\n### Rationale\\n\\nPublicly available Redshift clusters have a public IP address, which gives any machine the opportunity to attempt to connect to your clusters. Malicious activity, such as SQL injections or distributed denial-of-service (DDoS) attacks, can occur if a connection is established.\\n\\n### Remediation\\n\\n[1]: https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-clusters.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574002373,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_redshift @publicly_accessible:true\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"syn-jic-zlu\",\"isDefault\":true,\"name\":\"Redshift Cluster Publicly Accessible\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"aws\",\"source:ec2\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 139 (used by services for NetBIOS name resolution) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as bad tunnel exploits or denial-of-service (DoS) and man-in-the-middle (MITM) attacks, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to TCP port 139.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 139\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574002491,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress   @to_port:139 @protocol:tcp (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"bls-coy-rpp\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound TCP NetBIOS Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 1433 (used by the Microsoft SQL Server) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) attacks and hacking, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 1433.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 1433\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 1433 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 1433\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003135,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:1433 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"5oc-hdq-fx7\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound MSSQL Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"source:cloudfront\",\"security:compliance\",\"scope:cloudfront\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure that the AWS CloudFront Content Delivery Network (CDN) for your distribution is using HTTPS to send and receive content.\\n\\n### Rationale\\n\\nHTTPS ensures encrypted communication for your AWS CloudFront distribution, alleviating the possibility of malicious attacks like packet interception.\\n\\n### Remediation\\n\\n1. Run `get-distribution-config` with your AWS CloudFront distribution ID to retrieve your [distribution's configuration information][1].\\n\\n\\t```\\n    aws cloudfront get-distribution-config\\n        --id ID000000000000\\n    ```\\n\\n2. In a new JSON file, modify the returned configuration. Set `ViewerProtocolPolicy` to `https-only` and save the configuration file.\\n\\n    ```\\n    {\\n      \\\"ETag\\\": \\\"ETAG0000000000\\\",\\n      \\\"DistributionConfig\\\": {\\n        \\\"Origins\\\": {\\n          \\\"ViewerProtocolPolicy\\\": \\\"https-only\\\",\\n          ...\\n        }\\n      }\\n    }\\n    ```\\n\\n3. Run `update-distribution` to [update your distribution][2] with your distribution `id`, the path of the configuration file (created in step 2), and your `etag`.\\n\\n    ```\\n    aws cloudfront update-distribution\\n        --id ID000000000000\\n        --distribution-config https-only.json\\n        --if-match ETAG0000000000\\n    ```\\n\\n[1]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudfront/get-distribution-config.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudfront/update-distribution.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003275,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudfront @dist_config_default_cache_behavior_viewer_protocol_policy:\\\"allow-all\\\"\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"fei-uz9-zhw\",\"isDefault\":true,\"name\":\"CloudFront Insecure Viewer Protocol Policy\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 135 (used by Microsoft Message Queuing (MSMQ) and other Windows software) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as backdoor command shell hacking and denial-of-service (DoS) attacks, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 135.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 135\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 135 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 135\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003256,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress   @to_port:135 (@protocol:tcp OR @protocol:all) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"7vm-6f7-nfs\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound RPC Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 443 (used by HTTP) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) attacks and hacking, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 443.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 443\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict TCP access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 443\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003526,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:443 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"vud-y9z-ucg\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound HTTPS Access\"},{\"creationAuthorId\":0,\"tags\":[\"control:4.3\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:2\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:ec2\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nA VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. \\n\\nSet up your default security group to restrict all traffic. The default VPC in every region should have its default security group updated to comply. Any newly created VPCs automatically contain a default security group that needs remediation to comply with this recommendation. \\n\\n**Note**: When implementing this recommendation, VPC flow logging is invaluable in determining the least privilege port access required by systems to work properly because it can log all packet acceptances and rejections occurring under the current security groups. This dramatically reduces the primary barrier to least privilege engineering - discovering the minimum ports required by systems in the environment. Even if the VPC flow logging recommendation in this benchmark is not adopted as a permanent security measure, it should be used during any period of discovery and engineering for least privileged security groups.\\n\\n## Rationale\\n\\nConfiguring all VPC default security groups to restrict all traffic will encourage the least privileged security group development and mindful placement of AWS resources into security groups, which will reduce the exposure of those resources.\\n\\n## Remediation\\n\\nSecurity Group Members Perform the following to implement the prescribed state: \\n\\n1. Identify AWS resources that exist within the default security group \\n2. Create a set of least privilege security groups for those resources \\n3. Place the resources in those security groups \\n4. Remove the resources noted in #1 from the default security group `Security Group State` by logging in to the AWS Management Console at [https://console.aws.amazon.com/vpc/home][1] and repeating these steps for all VPCs - including the default VPC in each AWS region. \\n5. In the left pane, click Security Groups \\n6. For each default security group, perform the following: \\n    1. Select the default security group \\n    2. Click the Inbound Rules tab \\n    3. Remove any inbound rules \\n    4. Click the Outbound Rules tab \\n    5. Remove any inbound rules \\n    6. Recommended: IAM groups allow you to edit the \\\"name\\\" field. After remediating default groups rules for all VPCs in all regions, edit this field to add text similar to \\\"DO NOT USE. DO NOT ADD RULES\\\"\\n\\n## Impact\\n\\nImplementing this recommendation in an existing VPC containing operating resources requires extremely careful migration planning as the default security groups are likely to be enabling many ports that are unknown. Enabling VPC flow logging (of accepts) in an existing environment that is known to be breach free will reveal the current pattern of ports being used for each instance to communicate successfully.\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-79201-0 \\n2. [http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html][2]\\n3. CIS CSC v6.0 #9.2\\n\\n## CIS Controls\\n\\n14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.                \\n\\n[1]: https://console.aws.amazon.com/vpc/home\\n[2]: http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003676,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:(ingress OR egress) @security_group_name:default*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"75q-ngx-snx\",\"isDefault\":true,\"name\":\"Ensure the default security group of every VPC restricts all traffic\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.11\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIAM password policies can require passwords to be rotated or expired after a given number of days. The password policy should expire passwords after 90 days or less.\\n\\n## Rationale\\n\\nReducing the password lifetime increases account resiliency against brute force login attempts. Additionally, requiring regular password changes help if a password is stolen or compromised without your knowledge. This can happen if your system is compromised, because of a software vulnerability, or if there is an internal threat. Certain corporate and government web filters or proxy servers have the ability to intercept and record traffic even if it's encrypted. Many people use the same password for many systems such as work, email, and personal. Compromised end-user workstations might have a keystroke logger.\\n\\n## Remediation\\n\\nPerform the following to set the password policy using the AWS console:\\n\\n1. Login to AWS Console with appropriate permissions to View Identity Access Management Account Settings: [https://console.aws.amazon.com/][1]\\n2. Go to IAM Service on the AWS Console \\n3. Click on Account Settings on the Left Pane \\n4. Check \\\"Enable password expiration\\\" \\n5. Set \\\"Password expiration period (in days):\\\" to 90 or less by using the AWS CLI:\\n    ```\\n    aws iam update-account-password-policy --max-password-age 90 \\n    ```\\n\\n**Note**: All commands starting with \\\"aws iam update-account-password-policy\\\" can be combined into a single command.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78909-9\\n\\n## CIS Controls\\n\\n16 Account Monitoring and Control               \\n\\n[1]: https://console.aws.amazon.com/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003696,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_account_password_policy @max_password_age > 90\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"nus-wps-5cc\",\"isDefault\":true,\"name\":\"Ensure IAM password policy expires passwords within 90 days or less\"},{\"creationAuthorId\":0,\"tags\":[\"control:2.2\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:2\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:cloudtrail\",\"scope:cloudtrail\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nCloudTrail log file validation creates a digitally signed digest file containing a hash of each log that CloudTrail writes to S3. Use these digest files to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log. You should enable file validation on all CloudTrails.\\n\\n## Rationale\\n\\nEnabling log file validation will provide additional integrity checking of CloudTrail logs.\\n\\n## Remediation\\n\\nPerform the following using the management console to enable log file validation on a given trail: \\n\\n1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/cloudtrail][1] \\n2. Click on Trails on the left navigation pane \\n3. Click on target trail \\n4. Within the S3 section click on the edit icon (pencil) \\n5. Click Advanced \\n6. Click on the Yes radio button in section Enable log file validation \\n7. Click Save\\n\\n To enable log file validation on a given trail using the AWS CLI: \\n    ```\\n    aws cloudtrail update-trail --name <trail_name> --enable-log-file-validation Note that periodic validation of logs using these digests can be performed by running the following command: aws cloudtrail validate-logs --trail-arn <trail_arn> --start-time <start_time> --end-time <end_time>\\n    ```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNot Enabled\\n\\n## References\\n\\n1. [http://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-enabling.html][2] \\n2. CCE-78914-9 3. CIS CSC v6.0 #6.3\\n\\n## CIS Controls\\n\\n6 Maintenance, Monitoring, and Analysis of Audit Logs\\n\\n[1]: https://console.aws.amazon.com/cloudtrail\\n[2]: http://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-enabling.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003762,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudtrail -@log_file_validation_enabled:true @log_file_validation_enabled:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"9we-gmy-kne\",\"isDefault\":true,\"name\":\"Ensure CloudTrail log file validation is enabled\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.4\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAccess keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. You should regularly rotate all access keys.\\n\\n## Rationale\\n\\nRotating access keys reduces the window of opportunity for an access key that is associated with a compromised or terminated account to be used. Access keys should be rotated to ensure that data cannot be accessed with an old key that might have been lost, cracked, or stolen.\\n\\n## Remediation\\n\\nPerform the following to rotate access keys: \\n\\n1. Log in to the AWS Management Console: [https://console.aws.amazon.com/][1]\\n2. Click Services \\n3. Click IAM \\n4. Click on Users \\n5. Click on Security Credentials \\n6. As an Administrator Click on Make Inactive for keys that have not been rotated in 90 Days \\n7. As an IAM User Click on Make Inactive or Delete for keys which have not been rotated or used in 90 Days \\n8. Click on `Create Access Key`\\n9. Update the programmatic call with new access key credentials using the AWS CLI:\\n     \\n     ```\\n     aws iam update-access-key aws iam create-access-key aws iam delete-access-key\\n     ```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78902-4\\n\\n## CIS Controls\\n\\n16 Account Monitoring and Control               \\n\\n[1]: https://console.aws.amazon.com/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003833,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_credential_report ((@access_key_1_active:true @access_key_1_last_rotated_age:*) OR (@access_key_2_active:true @access_key_2_last_rotated_age:*))\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"5se-kvq-6mk\",\"isDefault\":true,\"name\":\"Ensure access keys are rotated every 90 days or less\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.22\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIAM policies are how privileges are granted to users, groups, or roles. It is recommended and considered best practice to give only the permissions required to perform a task. Determine what users need to do and then craft policies that let the users perform only those tasks, instead of allowing full administrative privileges.\\n\\n## Rationale\\n\\nIt's more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions. IAM policies that have a statement with \\\"Effect\\\": \\\"Allow\\\" with \\\"Action\\\": \\\"*\\\" over \\\"Resource\\\": \\\"*\\\" should be removed.\\n\\n## Remediation\\n\\nUsing the GUI, perform the following to detach the policy that has full administrative privileges: \\n\\n1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/iam/][1]. \\n2. In the navigation pane, click Policies and search for the policy name found in the audit step. \\n3. Select the policy that needs to be deleted. \\n4. In the policy action menu, select first Detach \\n5. Select all Users, Groups, Roles that have this policy attached \\n6. Click Detach Policy \\n7. In the policy action menu, select Detach Using the CLI, perform the following to detach the policy that has full administrative privileges as found in the audit step: \\n    1. Lists all IAM users, groups, and roles that the specified managed policy is attached to: \\n        ```\\n        aws iam list-entities-for-policy --policy-arn <policy_arn> \\n        ```\\n    2. Detach the policy from all IAM Users: \\n        ```\\n        aws iam detach-user-policy --user-name <iam_user> --policy-arn <policy_arn>\\n        ```\\n    3. Detach the policy from all IAM Groups: \\n        ```\\n        aws iam detach-group-policy --group-name <iam_group> --policy-arn <policy_arn>\\n        ```\\n    4. Detach the policy from all IAM Roles: \\n        ```\\n        aws iam detach-role-policy --role-name <iam_role> --policy-arn <policy_arn>\\n        ```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. [http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html][2] \\n2. [http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html][3] \\n3. CCE-78912-3 \\n4. [http://docs.aws.amazon.com/cli/latest/reference/iam/index.html#cli-aws-iam][4]\\n\\n## CIS Controls\\n\\n4 Controlled Use of Administrative Privileges \\n\\n2 Logging This section contains recommendations for configuring AWS's account logging features\\n\\n[1]: https://console.aws.amazon.com/iam/\\n[2]: http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html\\n[3]: http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html\\n[4]: http://docs.aws.amazon.com/cli/latest/reference/iam/index.html#cli-aws-iam\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003839,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_policy_version_statement @effect:Allow @action:* @resource:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"critical\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"31y-0if-yxo\",\"isDefault\":true,\"name\":\"Ensure IAM policies that allow full \\\"*:*\\\" administrative privileges are not created\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.12\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.\\n\\n## Rationale\\n\\nRemoving access keys associated with the root account limits vectors by which the account can be compromised. Additionally, removing the root access keys encourages the creation and use of role based accounts that are least privileged.\\n\\n## Remediation\\n\\nPerform the following to delete or disable active root access keys using the AWS Console: \\n\\n1. Sign in to the AWS Management Console as Root and open the IAM console at [https://console.aws.amazon.com/iam/][1]. \\n2. Click on <Root_Account_Name> at the top right and select Security Credentials from the drop down list \\n3. On the pop out screen Click on Continue to Security Credentials \\n4. Click on Access Keys (Access Key ID and Secret Access Key) \\n5. Under the Status column if there are any Keys which are Active \\n    1. Click on Make Inactive - (Temporarily disable Key - may be needed again) \\n    2. Click Delete - (Deleted keys cannot be recovered)\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. [http://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html][2]\\n2. [http://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html][3]\\n3. [http://docs.aws.amazon.com/IAM/latest/APIReference/API_GetAccountSummary.html][4] \\n4. CCE-78910-7 5. CIS CSC v6.0 #5.1\\n\\n## CIS Controls\\n\\n4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities.                \\n\\n[1]: https://console.aws.amazon.com/iam/\\n[2]: http://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html\\n[3]: http://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html\\n[4]: http://docs.aws.amazon.com/IAM/latest/APIReference/API_GetAccountSummary.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574003908,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_credential_report @user:\\\"<root_account>\\\" (@access_key_1_active:true OR @access_key_2_active:true)\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"critical\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"snb-kjs-kgm\",\"isDefault\":true,\"name\":\"Ensure no root account access key exists\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:cloudtrail\",\"scope:cloudtrail\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure that an AWS CloudTrail trail has global service events enabled.\\n\\n### Rationale\\n\\nEasily troubleshoot security issues for global services that aren't region-specific.\\n\\n### Remediation\\n\\n1. Run `aws cloudtrail describe-trails`\\n2. Run `update-trail` on any returned trail name above to [include-global-service-events][1].\\n\\n    ```\\n    aws cloudtrail update-trail\\n        --name GlobalTrailName\\n        --include-global-service-events\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-create-and-update-a-trail-by-using-the-aws-cli-update-trail.html\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574004589,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudtrail  -@include_global_service_events:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"7ak-zke-f64\",\"isDefault\":true,\"name\":\"CloudTrail Global Services Disabled\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.20\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.\\n\\n## Rationale\\n\\nAn IAM Role will require an appropriate IAM Policy to allow Support Center Access to manage Incidents with AWS Support by implementing least privilege for access control.\\n\\n## Remediation\\n\\nUsing the Amazon unified command line interface: Create an IAM role for managing incidents with AWS: \\n\\n1. Create a trust relationship policy document that allows `<iam_user>` to manage AWS incidents, and save it locally as `/tmp/TrustPolicy.json`: \\n    ```\\n    { \\\"Version\\\": \\\"2012-10-17\\\", \\\"Statement\\\": [ { \\\"Effect\\\": \\\"Allow\\\", \\\"Principal\\\": { \\\"AWS\\\": \\\"<span style=\\\"font-style: italic;\\\"><iam_user></span>\\\" }, \\\"Action\\\": \\\"sts:AssumeRole\\\" } ] }\\n    ```\\n2. Create the IAM role using the above trust policy: \\n    ```\\n    aws iam create-role --role-name <aws_support_iam_role> --assume-role-policy-document file:///tmp/TrustPolicy.json o Attach 'AWSSupportAccess' managed policy to the created IAM role: aws iam attach-role-policy --policy-arn <iam_policy_arn> --role-name <aws_support_iam_role>\\n    ```\\n\\n## Impact\\n\\nAll AWS Support plans include an unlimited number of accounts and billing support cases, with no long-term contracts. Support billing calculations are performed on a per-account basis for all plans. Enterprise Support plan customers have the option to include multiple enabled accounts in an aggregated monthly billing calculation. Monthly charges for the Business and Enterprise support plans are based on each month's AWS usage charges, subject to a monthly minimum, billed in advance.\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. [http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html][1]\\n2. [https://aws.amazon.com/premiumsupport/pricing/][2] \\n3. [http://docs.aws.amazon.com/cli/latest/reference/iam/list-policies.html][3] \\n4. [http://docs.aws.amazon.com/cli/latest/reference/iam/attach-role-policy.html][4] \\n5. [http://docs.aws.amazon.com/cli/latest/reference/iam/list-entities-for-policy.html][5]\\n\\n## CIS Controls\\n\\nNone                \\n\\n[1]: http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html\\n[2]: https://aws.amazon.com/premiumsupport/pricing/\\n[3]: http://docs.aws.amazon.com/cli/latest/reference/iam/list-policies.html\\n[4]: http://docs.aws.amazon.com/cli/latest/reference/iam/attach-role-policy.html\\n[5]: http://docs.aws.amazon.com/cli/latest/reference/iam/list-entities-for-policy.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574004555,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_policy_entity_role @role_name:AWSSupportAccess -@policy_arn:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"7qn-b8q-jsj\",\"isDefault\":true,\"name\":\"Ensure a support role has been created to manage incidents with AWS Support\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:vpc\",\"scope:vpc\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nInvestigate AWS Network Access Control Lists (NACLs) for rules that utilize multiple ports and limit outbound traffic access to a specific port range.\\n\\n### Rationale\\n\\nEliminate the threat of unauthorized access by setting a specified port range.\\n\\n### Remediation\\n\\n1. Run `replace-network-acl-entry` to create a rule that sets a specific port range for egress traffic.\\n\\n    ```\\n    aws ec2 replace-network-acl-entry\\n        --network-acl-id id-01234567\\n        --egress\\n        --rule-number 02\\n        --protocol tcp\\n        --port-range From=000,To=000\\n        --rule-action allow\\n    ```\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574004771,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_network_acl_entry @egress:true @rule_action:\\\"allow\\\" -@port_range_from:* -@port_range_to:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"ykz-hrn-ev3\",\"isDefault\":true,\"name\":\"Unrestricted Network ACL Outbound Traffic\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:iam\",\"scope:iam\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nConfirm there are no [Amazon IAM users][1] (privileged users) with administrator permissions for your AWS account.\\n\\n### Rationale\\n\\nA privileged IAM user can access all AWS services and control resources through the [AdministratorAccess IAM managed policy][2]. Any user with administrator access that should not have access can potentially, whether unknowingly or purposefully, cause security issues or data leaks.\\n\\n### Remediation\\n\\n1. Run `list-users` to get [a list of current IAM users][3].\\n2. Run `list-user-policies` with an IAM `user-name` to find the [users attached policies][4].\\n\\n    ```\\n    aws iam list-user-policies --user-name Name\\n    ```\\n\\n3. Run `detach-user-policy` to [revoke Administrator access][5] for that user.\\n\\n    ```\\n    aws iam detach-user-policy --user-name Bob --policy-arn arn:aws:iam::123456789012:policy/TesterPolicy\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users.html\\n[2]: https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_administrator\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/list-users.html\\n[4]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/list-user-policies.html#examples\\n[5]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/detach-user-policy.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574005071,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_user_attached_policy @policy_name:AdministratorAccess\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"z8a-10r-rdq\",\"isDefault\":true,\"name\":\"AWS IAM Users with Admin Privileges\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:redshift\",\"scope:redshift\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure that AWS RedShift clusters are encrypted.\\n\\n### Rationale\\n\\nEncrypting Redshift clusters protects your sensitive data from unauthorized access.\\n\\n### Remediation\\n\\n1. Run `describe-clusters` with your [cluster identifier][1].\\n\\n    ```\\n    aws redshift describe-clusters\\n        --cluster-identifier cluster-name\\n    ```\\n\\n2. Run `create-cluster` using the configuration details returned in step 1 along with the [`encrypted` flag][2].\\n\\n    ```\\n    aws redshift create-cluster\\n        --cluster-identifier cluster-name\\n        ...\\n        --encrypted\\n    ```\\n\\n3. Run `describe-cluster` with a [query filter][1] to expose the new endpoint address.\\n\\n    ```\\n    aws redshift describe-clusters\\n        --cluster-identifier cluster-name\\n        --query 'Clusters[*].Endpoint.Address'\\n    ```\\n\\n4. Use the cluster endpoint URL with the [Amazon Redshift Unload/Copy][3] tool.\\n\\n5. Update your encrypted Redshift cluster configuration with the new Redshift cluster endpoint URL.\\n\\n6. Once the endpoint is changed, run `delete-cluster` to [remove the old unencrypted cluster][4].\\n\\n    ```\\n    aws redshift delete-cluster\\n        --cluster-identifier old-cluster\\n        --final-cluster-snapshot-identifier old-cluster-finalsnapshot\\n    ```\\n\\n[1]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/describe-clusters.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/create-cluster.html\\n[3]: https://github.com/awslabs/amazon-redshift-utils/tree/master/src/UnloadCopyUtility\\n[4]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/delete-cluster.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574004941,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_redshift -@encrypted:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"o5n-lxt-ayr\",\"isDefault\":true,\"name\":\"Redshift Cluster Unencrypted\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.1.4a\",\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\nReduce the probability of a breach by checking [EC2 security groups][1] for outbound rules that allow unfettered access to any TCP/UDP ports and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) and distributed denial-of-service (DDoS) attacks, can occur when permitting unfettered outbound access.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-egress` to remove IP permissions for the selected EC2 security group.\\n\\n    ```\\n    aws ec2 revoke-security-group-egress\\n        --group-id your-group-id\\n        --ip-permissions '[{\\\"IpProtocol\\\": \\\"tcp\\\", \\\"FromPort\\\": 22, \\\"ToPort\\\": 22, \\\"IpRanges\\\": [{\\\"CidrIp\\\": \\\"0.0.0.0/0\\\"}]}]'\\n    ```\\n\\n2. Run `authorize-security-group-egress` with new parameters to restrict outbound access to specific destinations.\\n\\n    ```\\n    aws ec2 authorize-security-group-egress\\n        --group-id your-group-id\\n        --ip-permissions '[{\\\"IpProtocol\\\": \\\"tcp\\\", \\\"FromPort\\\": 22, \\\"ToPort\\\": 22, \\\"IpRanges\\\": [{\\\"CidrIp\\\": \\\"0.0.0.0/0\\\"}]}]'\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574005188,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:egress  @to_port:ALL (ip_range:\\\"0.0.0.0/0\\\" OR ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"7lr-jfm-vcf\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Outbound Access on All Ports\"},{\"creationAuthorId\":0,\"tags\":[\"control:2.9\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:2\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:vpc\",\"scope:vpc\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nVPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. Enable VPC Flow Logs for packet \\\"Rejects\\\" for VPCs.\\n\\n## Rationale\\n\\nVPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect unusual traffic or insight during security workflows.\\n\\n## Remediation\\n\\nPerform the following with the management console to determine if VPC Flow logs are enabled:\\n\\n1. Sign in to the management console \\n2. Select Services then VPC \\n3. In the left navigation pane, select Your VPCs \\n4. Select a VPC 5. In the right pane, select the Flow Logs tab. \\n6. If no Flow Log exists, click Create Flow Log \\n7. For filter, select Reject \\n8. Enter in a Role and Destination Log Group \\n9. Click Create Log Flow \\n10. Click on CloudWatch Logs Group \\n    **Note**: Setting the filter to \\\"Reject\\\" will dramatically reduce the logging data accumulation for this recommendation and provide sufficient information for breach detection, research, and remediation. However, during periods of least privilege security group engineering, setting this the filter to \\\"All\\\" can help discover existing traffic flows required for proper operation of an already running environment.\\n\\n## Impact\\n\\nBy default, CloudWatch Logs will store Logs indefinitely unless you define a specific retention period for the log group. When choosing the number of days to retain, keep in mind that, on average, it takes an organization 210 days to detect a breach. Since additional time is required to research a breach, a minimum 365-day retention policy allows time for detection and research. You may also wish to archive the logs to a cheaper storage service rather than simply deleting them. See the following AWS resource to manage CloudWatch Logs retention periods: \\n\\n1. [http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/SettingLogRetention.html][1]\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-79202-8 \\n2. CIS CSC v6.0 #6.5, #12.9 \\n3. [http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html][2] \\n\\n## CIS Controls\\n\\n6.2 Activate audit logging - Enable local logging on all systems and networking devices. \\n\\n12.5 Configure Monitoring Systems to Record Network Packets - Configure monitoring systems to record network packets passing through the boundary at each of the organization's network boundaries. \\n\\n[1]: http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/SettingLogRetention.html\\n[2]: http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574005318,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_vpc_flowlog -@flow_log_status:ACTIVE\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"hw6-cqk-hrz\",\"isDefault\":true,\"name\":\"Ensure VPC flow logging is enabled in all VPCs\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.1.4a\",\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 22 (used for secure remote login) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as man-in-the-middle (MITM) and brute-force attacks, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 22.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 22\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 22 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 22\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574005407,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:22 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"jq1-v7m-jkf\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound SSH Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:rds\",\"scope:rds\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure that your AWS RDS database instances are encrypted.\\n\\n### Rationale\\n\\nEncrypting your AWS RDS clusters protects sensitive data from unauthorized access.\\n\\n### Remediation\\n\\n1. Run `describe-db-instances` with an instance identifier query to list RDS database names.\\n\\n    ```\\n    aws rds describe-db-instances\\n        --query 'DBInstances[*].DBInstanceIdentifier'\\n    ```\\n\\n2. Run `create-db-snapshot` with any returned database instance you wish to modify.\\n\\n    ```\\n    aws rds create-db-snapshot\\n        --db-snapshot-identifier my-db-snapshot\\n        --db-instance-identifier my-db-id\\n    ```\\n\\n3. Run `list-aliases` to list KMS keys aliases by region.\\n\\n    ```\\n    aws kms list-aliases\\n        --region us-west-1\\n    ```\\n\\n4. Run `copy-db-snapshot` with the `kms-key-id` returned in step 3.\\n\\n    ```\\n    aws rds copy-db-snapshot\\n        --region us-west-1\\n        --source-db-snapshot-identifier original-db-snapshot-id\\n        --target-db-snapshot-identifier encrypted-db-snapshot-id\\n        --copy-tags\\n        --kms-key-id 01234567-1a2b-1234a-b45c-abcdef123456\\n    ```\\n\\n5. Run `restore-db-instance-from-db-snapshot` to restore the previously created snapshot.\\n\\n    ```\\n    aws rds restore-db-instance-from-db-snapshot\\n        --region us-west-1\\n        --db-instance-identifier encrypted-db-id\\n        --db-snapshot-identifier encrypted-db-snapshot-id\\n    ```\\n\\n6. Run `describe-db-instances` with a query to ensure database encryption.\\n\\n    ```\\n    aws rds describe-db-instances\\n        --region us-west-1\\n        --db-instance-identifier encrypted-db-snapshot-id\\n        --query 'DBInstances[*].StorageEncrypted'\\n    ```\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574005316,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_rds -@storage_encrypted:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"han-1rs-ghe\",\"isDefault\":true,\"name\":\"RDS Encryption Disabled\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.8\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nPassword policies are, in part, used to enforce password complexity requirements. Use IAM password policies to ensure passwords are comprised of different character sets. The password policy should require at least one number.\\n\\n## Rationale\\n\\nSetting a password complexity policy increases account resiliency against brute force login attempts.\\n\\n## Remediation\\n\\nPerform the following to set the password policy using the AWS console: \\n\\n1. Login to AWS Console with appropriate permissions to View Identity Access Management Account Settings: [https://console.aws.amazon.com/][1]\\n2. Go to IAM Service on the AWS Console \\n3. Click on Account Settings on the Left Pane \\n4. Check \\\"Require at least one number\\\" \\n5. Click \\\"Apply password policy\\\". Using the AWS CLI, run:\\n    ```\\n    aws iam update-account-password-policy --require-numbers\\n    ```\\n**Note**: All commands starting with \\\"aws iam update-account-password-policy\\\" can be combined into a single command.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78906-5\\n\\n## CIS Controls\\n\\n16 Account Monitoring and Control                \\n\\n[1]: https://console.aws.amazon.com/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574005590,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_account_password_policy @require_numbers:false\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"ufg-4pj-olz\",\"isDefault\":true,\"name\":\"Ensure IAM password policy require at least one number\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.16\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nBy default, IAM users, groups, and roles have no access to AWS resources. IAM policies are how privileges are granted to users, groups, or roles. You should apply IAM policies directly to groups and roles but not to users.\\n\\n## Rationale\\n\\nAssigning privileges at the group or role level reduces access management's complexity as the number of users grows. Reducing access management complexity may in-turn, lessen the opportunity for a principal to receive or retain excessive privileges inadvertently.\\n\\n## Remediation\\n\\nPerform the following to create an IAM group and assign a policy to it: \\n\\n1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/iam/][1]. \\n2. In the navigation pane, click Groups and then click Create New Group. \\n3. In the Group Name box, type the name of the group and then click Next Step. \\n4. In the list of policies, select the checkbox for each policy that you want to apply to all members of the group. Then click Next Step. \\n5. Click Create Group \\n\\nPerform the following to add a user to a given group: \\n\\n1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/iam/][1] \\n2. In the navigation pane, click Groups \\n3. Select the group to add a user to \\n4. Click Add Users To Group \\n5. Select the users to be added to the group \\n6. Click Add Users \\n\\nPerform the following to remove a direct association between a user and policy: \\n1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/iam/][1]. \\n2. In the left navigation pane, click on Users \\n3. For each user: \\n    1. Select the user \\n    2. Click on the Permissions tab \\n    3. Expand Managed Policies \\n    4. Click Detach Policy for each policy \\n    5. Expand Inline Policies \\n    6. Click Remove Policy for each policy\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. [http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html][2] \\n2. [http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html][3] \\n3. CCE-78912-3\\n\\n## CIS Controls\\n\\n16 Account Monitoring and Control\\n\\n[1]: https://console.aws.amazon.com/iam/\\n[2]: http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html\\n[3]: http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574006153,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_user_attached_policy @policy_arn:\\\"arn:aws:iam::*:user/*\\\"\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"oys-6ti-vv4\",\"isDefault\":true,\"name\":\"Ensure IAM policies are attached only to groups or roles\"},{\"creationAuthorId\":0,\"tags\":[\"control:4.2\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:ec2\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 3389 (used to connect a remote Remote Desktop Protocol (RDP) client application with an RDP server) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as pass-the-hash (PtH) and man-in-the-middle attacks (MITM), can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 3389.\\n\\n   ```\\n   aws ec2 revoke-security-group-ingress\\n   --group-name group-name\\n   --protocol tcp\\n   --port 3389\\n   --cidr 192.0.2.0/24\\n   ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 3389 access.\\n\\n   ```\\n   aws ec2 authorize-security-group-ingress\\n   --group-name your-group-name\\n   --protocol tcp\\n   --port 3389\\n   --cidr 192.0.2.0/24\\n   ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574006239,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule   @direction:ingress   @to_port:(3389 OR ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"oia-snq-ar0\",\"isDefault\":true,\"name\":\"Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389\"},{\"creationAuthorId\":0,\"tags\":[\"control:2.7\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:2\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:cloudtrail\",\"scope:cloudtrail\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources per IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data. It uses Hardware Security Modules (HSMs) to protect the security of encryption keys. Configure your CloudTrail logs to leverage server-side encryption (SSE), and KMS customer-created master keys (CMK) to further protect CloudTrail logs. You should set up CloudTrail to use SSE-KMS.\\n\\n## Rationale\\n\\nConfiguring CloudTrail to use SSE-KMS provides additional confidentiality controls on log data. A given user must have S3 read permission on the corresponding log bucket and have decrypt permission by the CMK policy.\\n\\n## Remediation\\n\\nPerform the following in the management console to configure CloudTrail to use SSE-KMS: \\n\\n1. Sign in to the AWS Management Console and open the CloudTrail console at [https://console.aws.amazon.com/cloudtrail][1] \\n2. In the left navigation pane, choose Trails. \\n3. Click on a Trail\\n4. Under the S3 section click on the edit button (pencil icon) \\n5. Click Advanced \\n6. Select an existing CMK from the KMS key Id drop-down menu \\n    **Note**: Locate the CMK in the same region as the S3 bucket \\n    **Note**: You will need to apply a KMS Key policy on the selected CMK for CloudTrail as a service to encrypt and decrypt log files using the CMK provided. Steps are provided here for editing the selected CMK Key policy \\n7. Click Save \\n8. You will see a notification message stating that you need to have decrypt permissions on the specified KMS key to decrypt log files. \\n9. Click Yes using the AWS CLI: \\n    ```\\n    aws cloudtrail update-trail --name <trail_name> --kms-id <cloudtrail_kms_key> aws kms put-key-policy --key-id <cloudtrail_kms_key> --policy <cloudtrail_kms_key_policy>\\n    ```\\n\\n## Impact\\n\\nCustomer created keys incur an additional cost. See [https://aws.amazon.com/kms/pricing/][2] for more information.\\n\\n## Default Value\\n\\nNone\\n\\n## CIS Controls\\n\\n6 Maintenance, Monitoring, and Analysis of Audit Logs               \\n\\n[1]: https://console.aws.amazon.com/cloudtrail\\n[2]: https://aws.amazon.com/kms/pricing/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574006065,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudtrail_status -@kms_key_id:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"kah-ejb-3v1\",\"isDefault\":true,\"name\":\"Ensure CloudTrail logs are encrypted at rest using KMS CMKs\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 139 and UDP ports 137 and 138 (used by services for NetBIOS name resolution) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as bad tunnel exploits or denial-of-service (DoS) and man-in-the-middle (MITM) attacks, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict UDP ports 137 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol udp\\n        --port 137\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict UDP ports 138 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol udp\\n        --port 138\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574006398,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress  @protocol:udp (@to_port:137 OR @to_port:138) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"dpw-bar-91p\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound UDP NetBIOS Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"source:cloudfront\",\"security:compliance\",\"scope:cloudfront\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nVerify that HTTPS is used to secure AWS CloudFront distributions communications.\\n\\n### Rationale\\n\\nHTTPS ensures that malicious activity cannot occur when data is sent within AWS CloudFront's Content Distribution Network (CDN).\\n\\n### Remediation\\n\\n1. Run `get-distribution-config` with your AWS CloudFront distribution ID to retrieve your [distribution's configuration information][1].\\n\\n\\t```\\n    aws cloudfront get-distribution-config\\n        --id ID000000000000\\n    ```\\n\\n2. In a new JSON file, modify the returned configuration. Set `OriginProtocolPolicy` to `https-only` and save the configuration file.\\n\\n    ```\\n    {\\n      \\\"ETag\\\": \\\"ETAG0000000000\\\",\\n      \\\"DistributionConfig\\\": {\\n        \\\"Origins\\\": {\\n          \\\"Items\\\": [\\n            {\\n              \\\"CustomOriginConfig\\\": {\\n                \\\"OriginProtocolPolicy\\\": \\\"https-only\\\",\\n                ...\\n              }\\n            }\\n          ]\\n        }\\n      }\\n    }\\n    ```\\n\\n3. Run `update-distribution` to [update your distribution][2] with your distribution `id`, the path of the configuration file (created in step 2), and your `etag`.\\n\\n    ```\\n    aws cloudfront update-distribution\\n        --id ID000000000000\\n        --distribution-config https-only.json\\n        --if-match ETAG0000000000\\n    ```\\n\\n[1]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudfront/get-distribution-config.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudfront/update-distribution.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574006435,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudfront_distribution_config_origins_item @custom_origin_config_origin_protocol_policy:\\\"http-only\\\"\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"q5e-clj-mow\",\"isDefault\":true,\"name\":\"CloudFront Traffic To Origin Unencrypted\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:redshift\",\"scope:redshift\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nConfirm `AllowVersionUpgrade` is enabled so [Redshift clusters][1] can automatically upgrade to the latest version.\\n\\n### Rationale\\n\\nEnablement allows the latest version to automatically install, deploying the most recent bug fixes and security patches.\\n\\n### Remediation\\n\\n1. Run `modify-cluster` to [set `allow-version-upgrade` for a cluster][2].\\n\\n    ```\\n    aws redshift modify-cluster\\n\\t    --cluster-identifier cluster-id-name\\n\\t    --allow-version-upgrade\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-clusters.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/modify-cluster.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574006748,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_redshift @allow_version_upgrade:false\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"5wo-2kl-jv1\",\"isDefault\":true,\"name\":\"Redshift Cluster Allow Version Upgrade\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:redshift\",\"scope:redshift\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nConfirm [Redshift clusters][1] are not using default port 5439 to protect against non-targeted attacks.\\n\\n### Rationale\\n\\nUsing a custom port can protect your publicly accessible AWS Redshift clusters against potential brute-force and dictionary attacks. Although setting a custom port can help fend off these attacks, it is also recommended to restrict public access, use SSL to encrypt client connections to database clusters, and control cluster access through security groups and Network Access Control Lists (NACLs) to add an additional layer of security for your account.\\n\\n### Remediation\\n\\n1. Run `describe-clusters` with a `cluster-identifier` to [retrieve cluster metadata][2].\\n\\n    ```\\n    aws redshift describe-clusters\\n\\t    --cluster-identifier cluster-name\\n    ```\\n\\n2. Run `create-cluster-snapshot` with [create a snapshot of your database cluster][3].\\n\\n    ```\\n    aws redshift create-cluster-snapshot\\n        --cluster-identifier cluster-name\\n        --snapshot-identifier snapshot-identifier\\n    ```\\n\\n3. Run `restore-from-cluster-snapshot` to [create a new cluster from the snapshot created above][4]. Use the retrieved metadata in step one to configure a new port number.\\n\\n    ```\\n    aws redshift restore-from-cluster-snapshot\\n        ...\\n        --cluster-identifier cluster-name\\n        --snapshot-identifier snapshot-identifier\\n        --port 2000\\n     ```\\n\\n[1]: https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-clusters.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/describe-clusters.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/create-cluster-snapshot.html\\n[4]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/redshift/restore-from-cluster-snapshot.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574006854,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_redshift @endpoint_port:5439\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"xrn-s6h-z9s\",\"isDefault\":true,\"name\":\"Redshift Cluster Default Cluster Port\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 27017 (used by the MongoDB database) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) attacks and hacking, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 27017.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 27017\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict CIFS access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 27017\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574007108,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:27017 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"lhy-ttz-yif\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound MongoDB Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 25 (used by Simple Mail Transfer Protocol (SMTP) for email transmission) and restrict access to IP addresses that require this port.\\n\\n\\n### Rationale\\n\\nMalicious activity, such as spamming, hacking, Shellshock, and denial-of-service (DoS) attacks, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 25.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 25\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 25 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 25\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574007156,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress   @to_port:25 (@protocol:tcp OR @protocol:all) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"fxy-iwb-1ji\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound SMTP Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:cloudfront\",\"scope:cloudfront\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure that AWS CloudFront field-level encryption is enabled.\\n\\n### Rationale\\n\\nField-level encryption ensures sensitive data, such as identification and credit card numbers, is protected across your services and applications.\\n\\n### Remediation\\n\\n1. Generate a RSA key pair. Run `ssh-keygen -t rsa`.\\n\\n2. Run `create-public-key` with the generated key.\\n\\n    ```\\n    aws cloudfront create-public-key\\n        --public-key-config CallerReference=\\\"0123456789012\\\",Name=\\\"public-key\\\",EncodedKey=\\\"-----BEGIN PUBLIC KEY----- ... -----END PUBLIC KEY-----\\\",Comment=\\\"Field-level encryption public key.\\\"\\n    ```\\n\\n3. Modify the returned configuration in a new JSON file by setting `PublicKeyID` as your public ID key. Configure any other options you require and save the file.\\n\\n    ```\\n    {\\n      \\\"PublicKey\\\": {\\n        ...\\n        \\\"Id\\\": \\\"PUBKEYID000000\\\",\\n        ...\\n      }\\n    }\\n    ```\\n\\n4. Run `create-field-level-encryption-profile` using the path of the configuration file saved in step 3.\\n\\n    ```\\n    aws cloudfront create-field-level-encryption-profile\\n        --field-level-encryption-profile-config public-key-id.json\\n    ```\\n\\n5. Modify the returned configuration in a new JSON file by setting `ProfileID` as your profile ID. Configure any other options you require and save the file.\\n\\n    ```\\n    {\\n      ...\\n      \\\"ContentTypeProfileConfig\\\": {\\n        ...\\n        \\\"Items\\\": [\\n          {\\n            \\\"ProfileId\\\": \\\"ABCD1234567890\\\",\\n          }\\n        ]\\n      }\\n    }\\n    ```\\n\\n6. Run `create-field-level-encryption-config` using the path of the configuration file saved in step 5.\\n\\n    ```\\n    aws cloudfront create-field-level-encryption-config\\n        --field-level-encryption-config profile-id.json\\n    ```\\n\\n7. Run `get-distribution-config` with your AWS CloudFront distribution ID to retrieve your distribution's configuration information.\\n\\n    ```\\n    aws cloudfront get-distribution-config\\n        --id ID000000000000\\n    ```\\n\\n8. Modify the returned configuration in a new JSON file by setting `FieldLevelEncryptionID` as your field level encryption ID. Configure any other options you require and save the file.\\n\\n**Note**: Viewer Protocol Policy and Origin Protocol Policy must both be set to HTTPS.\\n\\n    ```\\n    {\\n      \\\"DistributionConfig\\\": {\\n        ...\\n        \\\"Origins\\\": {\\n          \\\"Items\\\": [\\n            {\\n              ...,\\n              \\\"OriginProtocolPolicy\\\": \\\"https-only\\\",\\n            },\\n          ],\\n            ...\\n        },\\n        \\\"DefaultCacheBehavior\\\": {\\n          \\\"FieldLevelEncryptionId\\\": \\\"ACBD1234567890\\\",\\n          \\\"ViewerProtocolPolicy\\\" : \\\"https-only\\\"\\n        },\\n        ...\\n      }\\n    }\\n    ```\\n\\n9. Run `update-distribution` with your AWS CloudFront distribution `id`, the configuration file saved in step 8, and `etag` to enable field-level encryption.\\n\\n    ```\\n    aws cloudfront update-distribution\\n        --id ID000000000000\\n        --distribution-config field-level-encryption-id.json\\n        --if-match E1000000000000\\n    ```\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574007140,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudfront -@dist_config_default_cache_behavior_field_level_encryption_id:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"udh-nqo-4ct\",\"isDefault\":true,\"name\":\"CloudFront FieldLevel Encryption Not Enabled\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:cloudfront\",\"scope:cloudfront\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nEnsure logging is enabled for AWS Cloudfront to track things like client IP addresses and access points.\\n\\n### Rationale\\n\\nLogging tracks requests made through the CDN. With this information, you can detect changes in requests, complete security audits, and use other AWS tooling such as AWS WAF to block requests from certain IP addresses.\\n\\n### Remediation\\n\\n1. Run `create-bucket` to [create an S3 bucket][1] for your Cloudfront log files.\\n\\n    ```\\n    aws s3api create-bucket\\n        --bucket your-bucket-name\\n    ```\\n\\n2. Once the S3 bucket location is returned, run `get-distribution-config` with your AWS CloudFront distribution ID to retrieve your [distribution's configuration information][2].\\n\\n    ```\\n    aws cloudfront get-distribution-config\\n        --id ID000000000000\\n    ```\\n\\n3. Create a new JSON file with the returned configuration. Enable logging and set an S3 bucket location (returned in step 1) to configure where the logs will be located. Save the file.\\n\\n    ```\\n    {\\n      \\\"ETag\\\": \\\"ID000000000000\\\",\\n      \\\"DistributionConfig\\\": {\\n          ...\\n          \\\"Logging\\\": {\\n            \\\"Bucket\\\": \\\"your-bucket-name.s3.amazonaws.com\\\",\\n            \\\"Enabled\\\": true,\\n          },\\n          ...\\n        }\\n      }\\n    }\\n    ```\\n\\n4. Run `update-distribution` to [update your distribution][3] with your distribution `id`, the path of the configuration file (created in step 3), and your `etag`.\\n\\n    ```\\n    aws cloudfront update-distribution\\n        --id ID000000000000\\n        --distribution-config logging-enabled.json\\n        --if-match ETAG1000000000\\n    ```\\n\\n[1]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3api/create-bucket.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudfront/get-distribution-config.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudfront/update-distribution.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574007739,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudfront  -@distribution_config_logging_enabled:true\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"e1l-f7w-llc\",\"isDefault\":true,\"name\":\"CloudFront Logging Disabled\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 5432 (used by the PostgreSQL Database Server) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\nMalicious activity, such as hacking and denial-of-service (DoS) attacks, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 5432.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 5432\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 5432 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 5432\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574007949,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:5432 OR  @to_port:ALL) (ip_range:\\\"0.0.0.0/0\\\" OR ip_range:\\\"::/0\\\") (@protocol:tcp OR @protocol:ALL)\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"2ca-hhj-wzj\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound PostgreSQL Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 23 (used by the Telnet server application) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as spoofing, brute-force, and man-in-the-middle (MITM) attacks, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 23.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 23\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 23 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 23\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574007874,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress   @to_port:23 (@protocol:tcp OR @protocol:all) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"6oq-7ce-kej\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound Telnet Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 9200, used by the [Elasticsearch][2], and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) attacks and hacking, can occur when permitting unfettered Elasticsearch access.\\n\\n### Remediation\\n\\n1. First, remove the security group rule(s) that allow public, unrestricted access to the Elasticsearch database. The rule in question will open port 9200 for ingress from anywhere.\\n\\n2. Now that the database is contained, authorize only the specific entities that need access to the database like EC2 instances, or lambdas. You can do this by adding inbound security group rules for a specific elastic IP address, a specific range of IP addresses, or by allowing access for entities in another AWS security group.\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://aws.amazon.com/elasticsearch-service/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574008022,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:9200 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"rns-eiq-lpl\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound Elasticsearch Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:vpc\",\"scope:vpc\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nInvestigate AWS Network Access Control Lists (NACLs) for rules that enable multiple open ports and limit ingress traffic access based on port range.\\n\\n### Rationale\\n\\nEliminate the threat of unauthorized access malicious activities, such as Denial of Service (DoS) or Distributed Denial of Service (DDoS) attacks, by opening only the ports that are required by your application.\\n\\n### Remediation\\n\\n1. Run `replace-network-acl-entry` to create a rule that only allows ingress traffic from a specific port range.\\n\\n    ```\\n    aws ec2 replace-network-acl-entry\\n        --network-acl-id id-01234567\\n        --ingress\\n        --rule-number 01\\n        --protocol tcp\\n        --port-range From=000,To=000\\n        --rule-action allow\\n    ```\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574008182,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_network_acl_entry -@egress:* @rule_action:\\\"allow\\\" -@port_range_from:* -@port_range_to:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"q0m-mtc-9ks\",\"isDefault\":true,\"name\":\"Unrestricted Network ACL Inbound Traffic\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.1.4a\",\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 80 (used by HTTP) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) attacks and hacking, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 80.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 80\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict TCP access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 445\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574008139,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:80 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"o4x-exf-xn9\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound HTTP Access\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.10\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.\\n\\n## Rationale\\n\\nPreventing password reuse increases account resiliency against brute force login attempts.\\n\\n## Remediation\\n\\nPerform the following to set the password policy using the AWS console:\\n\\n1. Login to AWS Console with appropriate permissions to View Identity Access Management Account Settings: [https://console.aws.amazon.com/][1]\\n2. Go to IAM Service on the AWS Console \\n3. Click on Account Settings on the Left Pane \\n4. Check \\\"Prevent password reuse\\\" \\n5. Set \\\"Number of passwords to remember\\\" to 24 using the AWS CLI:\\n    ```\\n    aws iam update-account-password-policy --password-reuse-prevention 24 \\n    ```\\n\\n**Note**: All commands starting with \\\"aws iam update-account-password-policy\\\" can be combined into a single command.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78908-1\\n\\n## CIS Controls\\n\\n4.4 Use unique passwords where multi-factor authentication is not supported (such as local administrator, root, or service accounts), accounts will use passwords that are unique to that system.                \\n\\n[1]: https://console.aws.amazon.com/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574008460,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_account_password_policy -@password_reuse_prevention:24\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"low\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"wwj-kny-ll5\",\"isDefault\":true,\"name\":\"Ensure IAM password policy prevents password reuse\"},{\"creationAuthorId\":0,\"tags\":[\"control:1.6\",\"framework:cis-aws\",\"framework_version:1.2.0\",\"level:1\",\"scored:true\",\"security:compliance\",\"cloud:aws\",\"source:iam\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nPassword policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.\\n\\n## Rationale\\n\\nSetting a password complexity policy increases account resiliency against brute force login attempts.\\n\\n## Remediation\\n\\nPerform the following in the AWS console to set the password policy:\\n\\n1. Login to AWS Console with appropriate permissions to View Identity Access Management Account Settings: [https://console.aws.amazon.com/][1]  \\n2. Go to IAM Service on the AWS Console \\n3. Click on Account Settings on the Left Pane \\n4. Check \\\"Requires at least one lowercase letter\\\" \\n5. Click \\\"Apply password policy\\\". Using the AWS CLI, run: \\n    ```\\n    aws iam update-account-password-policy --require-lowercase-characters \\n    ```\\n\\n**Note**: All commands starting with \\\"aws iam update-account-password-policy\\\" can be combined into a single command.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nNone\\n\\n## References\\n\\n1. CCE-78904-0\\n\\n## CIS Controls\\n\\n16 Account Monitoring and Control               \\n\\n[1]: https://console.aws.amazon.com/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574008777,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_iam_account_password_policy @require_lowercase_characters:false\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"yaz-xyw-dr5\",\"isDefault\":true,\"name\":\"Ensure IAM password policy require at least one lowercase letter\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:ec2\",\"scope:ec2\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nReduce the probability of a breach by checking [EC2 security groups][1] for inbound rules that allow unfettered access to TCP port 3306 (used by the MySQL Server) and restrict access to IP addresses that require this port.\\n\\n### Rationale\\n\\nMalicious activity, such as denial-of-service (DoS) attacks and hacking, can occur when permitting unfettered access to this port.\\n\\n### Remediation\\n\\n1. Run `revoke-security-group-ingress` to [remove inbound rules][2] that allow unrestricted access to port 3306.\\n\\n    ```\\n    aws ec2 revoke-security-group-ingress\\n        --group-name group-name\\n        --protocol tcp\\n        --port 3306\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n2. Run `authorize-security-group-ingress` to [add new inbound rules][3] that restrict port 3306 access.\\n\\n    ```\\n    aws ec2 authorize-security-group-ingress\\n        --group-name your-group-name\\n        --protocol tcp\\n        --port 3306\\n        --cidr 192.0.2.0/24\\n    ```\\n\\n[1]: https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\\n[2]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/revoke-security-group-ingress.html\\n[3]: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/authorize-security-group-ingress.html\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574008744,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_security_group_rule @direction:ingress (@to_port:3306 OR  @to_port:ALL) (@ip_range:\\\"0.0.0.0/0\\\" OR @ip_range:\\\"::/0\\\")\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"yph-h6z-ant\",\"isDefault\":true,\"name\":\"Security Group With Unrestricted Inbound MySQL Access\"},{\"creationAuthorId\":0,\"tags\":[\"framework:pci-aws\",\"framework_version:3.2\",\"security:compliance\",\"source:cloudfront\",\"scope:cloudfront\",\"cloud:aws\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Description\\n\\nVerify that your [AWS CloudFront][1] distributions are integrated with [AWS Web Application Firewall][2] (AWS WAF).\\n\\n### Rationale\\n\\nAWS WAF helps protect web applications from common exploits, such as SQL injection or cross-site scripting.\\n\\n### Remediation\\n\\n1. Run `aws waf get-change-token` to generate a token.\\n2. Run `aws waf create-ip-set` with your newly generated token.\\n\\n    ```\\n    create-ip-set\\n        --name test_ipset\\n        --change-token abcd0123-1234-a12b-1234-a0b1c2e3d4f5\\n    ```\\n\\n3. Create an `IPSetDescriptor` JSON object in a new document and define the IP address or ranges you wish to block. Save the file.\\n\\n    ```\\n    [\\n      {\\n        \\\"Action\\\": \\\"INSERT\\\",\\n        \\\"IPSetDescriptor\\\": {\\n        \\\"Type\\\": \\\"IPV4\\\" | \\\"IPV6\\\",\\n        \\\"Value\\\": \\\"192.0.2.0/24\\\"\\n        }\\n      }\\n    ]\\n    ```\\n\\n4. Run `aws waf update-ip-set` with the `change-token` (generated in step 1), `ip-set-id` (generated in step 2), and the file you just created.\\n\\n    ```\\n    aws waf update-ip-set\\n        --ip-set-id bd12ea6c-012a-4b7c-9342-80ab96e4b291\\n\\t    --change-token abcd0123-1234-a12b-1234-a0b1c2e3d4f5\\n\\t    --updates file://ip-set-descriptor.json\\n    ```\\n\\n5. Run `aws waf create-rule` with a new rule `name` and your `change-token` (generated in step 1).\\n\\n    ```\\n    aws waf create-rule\\n\\t    --name NameOfRule\\n\\t    --change-token abcd0123-1234-a12b-1234-a0b1c2e3d4f5\\n    ```\\n\\n6. Run `aws waf create-web-acl` with a `name` and your `change-token` (generated in step 1), and set the default action to block.\\n\\n    ```\\n    aws waf create-rule\\n\\t    --name NameOfACL\\n        --default-action Type=BLOCK\\n\\t    --change-token abcd0123-1234-a12b-1234-a0b1c2e3d4f5\\n    ```\\n\\n7. Create a new JSON file and define `ActivatedRule` as an object that references the ACL rule created in step 6. Assign it a default action, `INSERT`.\\n\\n    ```\\n    [\\n      {\\n        \\\"Action\\\": \\\"INSERT\\\",\\n        \\\"ActivatedRule\\\": {\\n          \\\"RuleId\\\": \\\"your-rule-id\\\",\\n          \\\"Action\\\": {\\n            \\\"Type\\\": \\\"BLOCK\\\"\\n          }\\n        }\\n      }\\n    ]\\n    ```\\n\\n8. Run `update-web-acl` with the `web-acl-id` (generated in step 5), `change-token` (generated in step 1), and the file you just created in step 7.\\n\\n    ```\\n    aws waf update-web-acl\\n        --web-acl-id webaclid\\n        --change-token 96836241-b667-4f0a-a655-e4bc49eaa2c4\\n        --update activated-rule.json\\n    ```\\n\\n9. Run `get-distribution-config`.\\n10. In a new JSON file, modify the returned configuration information to attach the WAF ACL. Set the `WebACLId` as the ID you returned in step 5. Save the file.\\n\\n    ```\\n    {\\n      \\\"ETag\\\": \\\"etag\\\",\\n      \\\"DistributionConfig\\\": {\\n        ...\\n        \\\"WebACLId\\\": \\\"webaclid\\\",\\n        ...\\n      }\\n    }\\n    ```\\n\\n11. Run `update-distribution` with the `id` and `etag` previously returned in step 9.\\n\\n    ```\\n    aws cloudfront update-distribution\\n        --id webaclid\\n        --distribution-config activated-ruled.json\\n        --if-match etag\\n    ```\\n\\n[1]: https://aws.amazon.com/cloudfront/\\n[2]: https://aws.amazon.com/waf/\\n\",\"options\":{\"evaluationWindow\":7200,\"maxSignalDuration\":86400,\"keepAlive\":21600},\"version\":2,\"createdAt\":1599574008896,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"a\",\"aggregation\":\"count\",\"groupByFields\":[\"resource_type\",\"resource_id\"],\"query\":\"resource_type:aws_cloudfront -@distribution_config_web_acl_id:*\",\"trackType\":\"compliance\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"configuration\",\"id\":\"qo4-jsd-nfn\",\"isDefault\":true,\"name\":\"CloudFront Integrated With WAF\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.3.5\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAllow pods to verify the API server's serving certificate before establishing connections.\\n\\n## Rationale\\n\\nProcesses running within pods that need to contact the API server must verify the API server's serving certificate. Failing to do so could be a subject to man-in-the-middle attacks. Providing the root certificate for the API server's serving certificate to the controller manager with the `--root-ca-file` argument allows the controller manager to inject the trusted bundle into pods so that they can verify TLS connections to the API server.\\n\\n## Remediation\\n\\nEdit the Controller Manager pod specification file `/etc/kubernetes/manifests/kube-controller-manager.yaml` on the master node and set the `--root-ca-file` parameter to the certificate bundle file: `--root-ca-file=<path/to/file>`\\n\\n## Impact\\n\\nYou need to setup and maintain root certificate authority file.\\n\\n## Default Value\\n\\nBy default, `--root-ca-file` is not set.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-controller-manager/ ][1]\\n2. [https://github.com/kubernetes/kubernetes/issues/11000][2]\\n\\n## CIS Controls\\n\\nVersion 6 14.2 Encrypt All Sensitive Information Over Less-trusted Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.                \\n\\n[1]: https://kubernetes.io/docs/admin/kube-controller-manager/ \\n[2]: https://github.com/kubernetes/kubernetes/issues/11000\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599598174692,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.3.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"k7t-yxp-axc\",\"isDefault\":true,\"name\":\"--root-ca-file argument is set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.2\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe Docker daemon requires access to the Docker socket which is, by default, owned by the user `root` and the group `docker`.\\n\\n## Rationale\\n\\nDocker allows you to share a directory between the Docker host and a guest container without limiting the access rights of the container. This means that you can start a container and map the `/` directory on your host to the container. The container is able to modify your host file system without any restrictions. This means that you could gain elevated privileges simply by being a member of the `docker` group and subsequently start a container which maps the root `/` directory on the host.\\n\\n## Remediation\\n\\nYou should remove any untrusted users from the `docker` group. Additionally, you should not create a mapping of sensitive directories from the host to container volumes.\\n\\n## Impact\\n\\nProvided the proceeding instructions are implemented, rights to build and execute containers as normal user would be restricted.\\n\\n## Default Value\\n\\nNot Applicable\\n\\n## References\\n\\n1. [https://docs.docker.com/engine/security/security/#docker-daemon-attack-surface]\\n2. [https://www.andreas-jung.com/contents/on-docker-security-docker-group-considered-harmful]\\n3. [http://www.projectatomic.io/blog/2015/08/why-we-dont-let-non-root-users-run-docker-in-centos-fedora-or-rhel/]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.                \\n\\n[1]: https://docs.docker.com/engine/security/security/#docker-daemon-attack-surface \\n[2]: https://www.andreas-jung.com/contents/on-docker-security-docker-group-considered-harmful \\n[3]: http://www.projectatomic.io/blog/2015/08/why-we-dont-let-non-root-users-run-docker-in-centos-fedora-or-rhel/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599598174666,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"dev-mh8-u1i\",\"isDefault\":true,\"name\":\"Only trusted users are allowed to control Docker daemon\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.6\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not use automatically generated self-signed certificates for TLS connections between peers.\\n\\n## Rationale\\n\\nEtcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster. Hence, do not use self-signed certificates for authentication.\\n\\n## Remediation\\n\\nEdit the etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` on the master node and either remove the `--peer-auto-tls` parameter or set it to false. \\n\\n```\\n--peer-auto-tls=false\\n```\\n\\n## Impact\\n\\nAll peers attempting to communicate with the etcd server will require a valid client certificate for authentication.\\n\\n## Default Value\\n\\n*Note*: This recommendation is applicable only for etcd clusters. If you are using only one etcd server in your environment then this recommendation is not applicable. By default, `--peer-auto-tls` argument is set to false.\\n\\n## References\\n\\n1. [https://coreos.com/etcd/docs/latest/op-guide/security.html ][1]\\n2. [https://kubernetes.io/docs/admin/etcd/ ][2]\\n3. [https://coreos.com/etcd/docs/latest/op-guide/configuration.html#peer-auto-tls][3]\\n\\n## CIS Controls\\n\\nVersion 6.14 Controlled Access Based on the Need to Know\\n\\nVersion 7.4 Controlled Use of Administrative Privileges             \\n\\n[1]: https://coreos.com/etcd/docs/latest/op-guide/security.html \\n[2]: https://kubernetes.io/docs/admin/etcd/ \\n[3]: https://coreos.com/etcd/docs/latest/op-guide/configuration.html#peer-auto-tls\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599598174666,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-2.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"l0y-lyz-foj\",\"isDefault\":true,\"name\":\"--peer-auto-tls argument is not set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.14\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nBy using the `--restart` flag in the docker run command you can specify a restart policy for how a container should or should not be restarted on exit. You should choose the on-failure restart policy and limit the restart attempts to 5.\\n\\n## Rationale\\n\\nIf you indefinitely keep trying to start the container, it could possibly lead to a denial of service on the host. It could be an easy way to do a distributed denial of service attack especially if you have many containers on the same host. Additionally, ignoring the exit status of the container and always attempting to restart the container, leads to non-investigation of the root cause behind containers getting terminated. If a container gets terminated, you should investigate on the reason behind it instead of just attempting to restart it indefinitely. You should use the on-failure restart policy to limit the number of container restarts to a maximum of 5 attempts.\\n\\n## Remediation\\n\\nIf you wish a container to be automatically restarted, use `docker run --detach --restart=on-failure:5 nginx`\\n\\n## Impact\\n\\nIf this option is set, a container will only attempt to restart itself 5 times.\\n\\n## Default Value\\n\\nBy default, containers are not configured with restart policies.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/commandline/run/#restart-policies-restart\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599598174688,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.14\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ycq-buv-pf8\",\"isDefault\":true,\"name\":\"'on-failure' container restart policy is set to '5'\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.4\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the controller manager pod specification file ownership is set to root:root.\\n\\n## Rationale\\n\\nThe controller manager pod specification file controls various parameters that set the behavior of various components of the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chown root:root /etc/kubernetes/manifests/kube-controller-manager.yaml`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `kube-controller-manager.yaml` file ownership is set to root:root.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-controller-manager\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599105053,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"jwf-xdm-mi9\",\"isDefault\":true,\"name\":\"Controller manager pod specification file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.31\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nSetup TLS connection on the API server.\\n\\n## Rationale\\n\\nAPI server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic. If --client-ca-file argument is set, any request presenting a client certificate signed by one of the authorities in the client-ca-file is authenticated with an identity corresponding to the CommonName of the client certificate.\\n\\n## Remediation\\n\\nFollow the Kubernetes documentation and set up the TLS connection on the apiserver. Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the client certificate authority file. --client-ca-file=<path/to/client-ca-file>\\n\\n## Impact\\n\\nTLS and client certificate authentication must be configured for your Kubernetes cluster deployment.\\n\\n## Default Value\\n\\nBy default, --client-ca-file argument is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ 3. https://github.com/kelseyhightower/docker-kubernetes-tls-guide\\n\\n## CIS Controls\\n\\nVersion 6 14.2 Encrypt All Sensitive Information Over Less-trusted Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. Version 7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599105054,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.31\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"nad-eon-2rv\",\"isDefault\":true,\"name\":\"--client-ca-file argument is set as appropriate (API server)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.27\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nValidate service account before validating token.\\n\\n## Rationale\\n\\nIf --service-account-lookup is not enabled, the apiserver only verifies that the authentication token is valid, and does not validate that the service account token mentioned in the request is actually present in etcd. This allows using a service account token even after the corresponding service account is deleted. This is an example of time of check to time of use security issue.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the below parameter. --service-account-lookup=true Alternatively, you can delete the --service-account-lookup parameter from this file so that the default takes effect.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, --service-account-lookup argument is set to true.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/issues/24167 3. https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use\\n\\n## CIS Controls\\n\\nVersion 6 16 Account Monitoring and Control Account Monitoring and Control Version 7 16 Account Monitoring and Control Account Monitoring and Control                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599105043,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.27\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ycp-ppm-trb\",\"isDefault\":true,\"name\":\"--service-account-lookup argument is set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.12\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnable kubelet server certificate rotation.\\n\\n## Rationale\\n\\n`RotateKubeletServerCertificate` causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad. \\n\\n*Note*: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.\\n\\n## Remediation\\n\\nOn the master edit `/var/lib/kubelet/kubeadm-flags.env` and set the parameter `KUBELET_CERTIFICATE_ARGS --feature-gates=RotateKubeletServerCertificate=true` or as an alternative, and suggested as a last resort, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and set the below parameter in `KUBELET_CERTIFICATE_ARGS` variable:\\n\\n```\\n--feature-gates=RotateKubeletServerCertificate=true \\n```\\n\\nBased on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, kubelet server certificate rotation is disabled.\\n\\n## References\\n\\n1. https://github.com/kubernetes/kubernetes/pull/45059 \\n2. https://kubernetes.io/docs/admin/kubelet-tls-bootstrapping/#kubelet-configuration\\n\\n## CIS Controls\\n\\nVersion 6.14.2 Encrypt All Sensitive Information Over Less-trusted Networks - All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7.14.4 Encrypt All Sensitive Information in Transit - Encrypt all sensitive information in transit.                \\n\\n[1]: https://github.com/kubernetes/kubernetes/pull/45059 \\n[2]: https://kubernetes.io/docs/admin/kubelet-tls-bootstrapping/#kubelet-configuration\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599105048,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.12\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"afr-qkp-94a\",\"isDefault\":true,\"name\":\"RotateKubeletServerCertificate argument is set to true (Kubelet)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.3\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe `iptables` firewall is used to set up, maintain, and inspect the tables of IP packet filter rules within the Linux kernel. The Docker daemon should be allowed to make changes to the `iptables` ruleset.\\n\\n## Rationale\\n\\nDocker will not make changes to your system `iptables` rules unless you allow it to do so. If you do allow this, Docker server will automatically make any required changes. You should let Docker make changes to `iptables` automatically in order to avoid networking misconfigurations that could affect the communication between containers and with the outside world. Additionally, this reduces the administrative overhead of updating `iptables` every time you add containers or modify networking options.\\n\\n## Remediation\\n\\nDo not run the Docker daemon with `--iptables=false` parameter. \\n\\n## Impact\\n\\nThe Docker daemon service requires `iptables` rules to be enabled before it starts. Any restarts of `iptables` during Docker daemon operation may result in losing Docker-created rules. Adding i`ptables-persistent` to your `iptables` install can mitigate.\\n\\n## Default Value\\n\\nBy default, `iptables` is set to true.\\n\\n## References\\n\\n1. [https://docs.docker.com/engine/userguide/networking/default_network/container-communication/][1]\\n2. [https://fralef.me/docker-and-iptables.html][2]\\n\\n## CIS Controls\\n\\nVersion 6.5 Controlled Use of Administration Privileges                \\n\\n[1]: https://docs.docker.com/engine/userguide/networking/default_network/container-communication/\\n[2]: https://fralef.me/docker-and-iptables.html\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599453907,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-2.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"3fv-xgy-7fb\",\"isDefault\":true,\"name\":\"Docker is allowed to make changes to iptables\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.7\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that all the registry certificate files, usually found under the `/etc/docker/certs.d/<registry-name>` directory, are individually owned and group owned by root.\\n\\n## Rationale\\n\\nThe `/etc/docker/certs.d/<registry-name>` directory contains Docker registry certificates. These certificate files must be individually owned and group owned by root to ensure that less privileged users are unable to modify the contents of the directory.\\n\\n## Remediation\\n\\nExecute the following command: `chown root:root /etc/docker/certs.d/<registry-name>/*`\\n\\nThis sets the individual ownership and group ownership for the registry certificate files to root.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the individual ownership and group ownership for registry certificate files is correctly set to root.\\n\\n## References\\n\\n1. https://docs.docker.com/registry/insecure/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599454050,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.7\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"fbv-qsy-urc\",\"isDefault\":true,\"name\":\"Registry certificate file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.17\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the `controller-manager.conf` file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe `controller-manager.conf` file is the kubeconfig file for the Controller Manager. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chmod 644 /etc/kubernetes/controller-manager.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `controller-manager.conf` has permissions of 640.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-controller-manager/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599454121,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.17\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"iss-afi-xfp\",\"isDefault\":true,\"name\":\"controller-manager.conf file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.11\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not allow all requests.\\n\\n## Rationale\\n\\nSetting admission control plugin AlwaysAdmit allows all requests and do not filter any requests. The AlwaysAdmit admission controller was deprecated in Kubernetes v1.13. Its behavior was equivalent to turning off all admission controllers.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and either remove the --enable-admission-plugins parameter, or set it to a value that does not include AlwaysAdmit.\\n\\n## Impact\\n\\nOnly requests explicitly allowed by the admissions control plugins would be served.\\n\\n## Default Value\\n\\nAlwaysAdmit is not in the list of default admission plugins.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#alwaysadmit\\n\\n## CIS Controls\\n\\nVersion 6 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know Version 7 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599454382,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.11\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ysr-4gg-vu5\",\"isDefault\":true,\"name\":\"Admission control plugin AlwaysAdmit is not set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.6\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the `kubelet.conf` file ownership is set to `root:root`.\\n\\n## Rationale\\n\\nThe `kubelet.conf` file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root.\\n\\n## Remediation\\n\\nRun this command (based on the file location on your system) on the each worker node. For example, `chown root:root /etc/kubernetes/kubelet.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `kubelet.conf` file ownership is set to `root:root`.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.                \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599599696342,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"mrc-waf-mbs\",\"isDefault\":true,\"name\":\"kubelet.conf file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.16\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the `scheduler.conf` file ownership is set to `root:root`.\\n\\n## Rationale\\n\\nThe `scheduler.conf` file is the kubeconfig file for the Scheduler. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chown root:root /etc/kubernetes/scheduler.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `scheduler.conf` file ownership is set to root:root.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kubeadm/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600185878,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.16\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"pbp-y4b-dhf\",\"isDefault\":true,\"name\":\"scheduler.conf file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not allow all requests. Enable explicit authorization.\\n\\n## Rationale\\n\\nKubelets, by default, allow all authenticated requests (even anonymous ones) without needing explicit authorization checks from the API server. You should restrict this behavior and only allow explicitly authorized requests.\\n\\n## Remediation\\n\\nIf using a Kubelet config file, edit the file to set authorization: mode to Webhook. If using executable arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and set the below parameter in `KUBELET_AUTHZ_ARGS` variable. \\n\\n`--authorization-mode=Webhook` \\n\\nBased on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nUnauthorized requests will be denied.\\n\\n## Default Value\\n\\nBy default, `--authorization-mode` argument is set to `AlwaysAllow`.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/ ][1]\\n2. [https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet-authentication][2]\\n\\n## CIS Controls\\n\\nVersion 6.14 Controlled Access Based on the Need to Know \\n\\nVersion 7.14 Controlled Access Based on the Need to Know              \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/ \\n[2]: https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet-authentication\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600248005,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"un4-gin-3dq\",\"isDefault\":true,\"name\":\"--authorization-mode argument is not set to AlwaysAllow (Kubelet)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.8\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the `/etc/kubernetes/manifests/etcd.yaml` file ownership is set to `root:root`.\\n\\n## Rationale\\n\\nThe etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` controls various parameters that set the behavior of the etcd service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chown root:root /etc/kubernetes/manifests/etcd.yaml`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `/etc/kubernetes/manifests/etcd.yaml` file ownership is set to root:root.\\n\\n## References\\n\\n1. https://coreos.com/etcd\\n2. https://kubernetes.io/docs/admin/etcd/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600311388,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.8\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"oac-lbl-npz\",\"isDefault\":true,\"name\":\"etcd pod specification file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.3\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnable Kubelet authentication using certificates.\\n\\n## Rationale\\n\\nThe connections from the API server to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet's port-forwarding functionality. These connections terminate at the kubelet's HTTPS endpoint. By default, the API server does not verify the kubelet's serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks. Enabling Kubelet certificate authentication ensures that the API server could authenticate the Kubelet before submitting any requests.\\n\\n## Remediation\\n\\nIf using a Kubelet config file, edit the file to set `authentication: x509: clientCAFile` to the location of the client CA file. If using command line arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and set the below parameter in `KUBELET_AUTHZ_ARGS` variable. \\n\\n`--client-ca-file=<path/to/client-ca-file>` \\n\\nBased on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nYou require TLS to be configured on API server as well as kubelets.\\n\\n## Default Value\\n\\nBy default, `--client-ca-file argument` is not set.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/ ][1]\\n2. [https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/][2]\\n\\n## CIS Controls\\n\\nVersion 6.14.2 Encrypt All Sensitive Information Over Less-trusted Networks - All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7.14.4 Encrypt All Sensitive Information in Transit - Encrypt all sensitive information in transit.     \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/ \\n[2]: https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/           \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600373842,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"x6l-4d1-dwh\",\"isDefault\":true,\"name\":\"--client-ca-file argument is set as appropriate (Kubelet)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.2.3\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not generally permit containers to be run with the hostIPC flag set to true.\\n\\n## Rationale\\n\\nA container running in the host's IPC namespace can use IPC to interact with processes outside the container. There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host IPC namespace. If you have a requirement to containers that require hostIPC, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\\n\\n## Remediation\\n\\nCreate a PSP as described in the Kubernetes documentation, ensuring that the .spec.hostIPC field is omitted or set to false.\\n\\n## Impact\\n\\nPods defined with spec.hostIPC: true will not be permitted unless they are run under a specific PSP.\\n\\n## Default Value\\n\\nBy default, PodSecurityPolicies are not defined.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/concepts/policy/pod-security-policy][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.                \\n\\n[1]: https://kubernetes.io/docs/concepts/policy/pod-security-policy\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1599600435891,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-5.2.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"vs4-ja0-gkh\",\"isDefault\":true,\"name\":\"Minimize the admission of containers wishing to share the host IPC namespace\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.1\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAppArmor is an effective and easy-to-use Linux application security system. It is available on some Linux distributions by default, for example, on Debian and Ubuntu.\\n\\n## Rationale\\n\\nAppArmor protects the Linux OS and applications from various threats by enforcing a security policy which is also known as an AppArmor profile. You can create your own AppArmor profile for containers or use Docker's default profile. Enabling this feature enforces security policies on containers as defined in the profile.\\n\\n## Remediation\\n\\nIf AppArmor is applicable for your Linux OS, enable it.\\n\\n1. Verify AppArmor is installed.\\n2. Create or import a AppArmor profile for Docker containers.\\n3. Enable enforcement of the policy.\\n4. Start your Docker container using the customized AppArmor profile. For example: `docker run --interactive --tty --security-opt=\\\"apparmor:PROFILENAME\\\" ubuntu /bin/bash` Alternatively, Docker's default AppArmor policy can be used.\\n\\n## Impact\\n\\nThe container will have the security controls defined in the AppArmor profile. It should be noted that if the AppArmor profile is misconfigured, this may cause issues with the operation of the container.\\n\\n## Default Value\\n\\nBy default, the docker-default AppArmor profile is applied to running containers. This profile can be found at `/etc/apparmor.d/docker`\\n\\n## References\\n\\n1. https://docs.docker.com/engine/security/apparmor/\\n2. https://docs.docker.com/engine/reference/run/#security-configuration\\n3. https://docs.docker.com/engine/security/security/#other-kernel-security-features\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600498264,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"s4z-dsj-llz\",\"isDefault\":true,\"name\":\"An AppArmor Profile is enabled\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.2.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not generally permit containers to be run with the hostPID flag set to true.\\n\\n## Rationale\\n\\nA container running in the host's PID namespace can inspect processes running outside the container. If the container also has access to ptrace capabilities this can be used to escalate privileges outside of the container. There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host PID namespace. If you need to run containers which require hostPID, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\\n\\n## Remediation\\n\\nCreate a PSP as described in the Kubernetes documentation, ensuring that the `.spec.hostPID` field is omitted or set to false.\\n\\n## Impact\\n\\nPods defined with spec.hostPID: true will not be permitted unless they are run under a specific PSP.\\n\\n## Default Value\\n\\nBy default, PodSecurityPolicies are not defined.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/concepts/policy/pod-security-policy][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.                \\n\\n[1]: https://kubernetes.io/docs/concepts/policy/pod-security-policy\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1599600559953,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-5.2.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"flc-1s1-okw\",\"isDefault\":true,\"name\":\"Minimize the admission of containers wishing to share the host process ID namespace\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.7\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the certificate authorities file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe certificate authorities file controls the authorities used to validate API requests. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the following command to modify the file permissions of the `--client-ca-file`:\\n\\n```\\nchmod 644 <filename>\\n```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default no `--client-ca-file` is specified.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/authentication/#x509-client-certs][1]\\n\\n## CIS Controls\\n\\nVersion 6 5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \\n\\nVersion 7 14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.     \\n\\n[1]: https://kubernetes.io/docs/admin/authentication/#x509-client-certs           \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600622129,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.7\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"qtd-deo-dgb\",\"isDefault\":true,\"name\":\"Certificate authorities file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.3.4\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nExplicitly set a service account private key file for service accounts on the controller manager.\\n\\n## Rationale\\n\\nTo ensure that keys for service account tokens can be rotated as needed, a separate public/private key pair should be used for signing service account tokens. The private key should be specified to the controller manager with `--service-account-private-key-file` as appropriate.\\n\\n## Remediation\\n\\nEdit the Controller Manager pod specification file `/etc/kubernetes/manifests/kube-controller-manager.yaml` on the master node and set the `--service-account-private-key-file parameter` to the private key file for service accounts:\\n\\n```\\n--service-account-private-key-file=<filename>\\n```\\n\\n## Impact\\n\\nYou would need to securely maintain the key file and rotate the keys based on your organization's key rotation policy.\\n\\n## Default Value\\n\\nBy default, `--service-account-private-key-file` it not set.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-controller-manager/][1]\\n\\n## CIS Controls\\n\\nVersion 6.14 Controlled Access Based on the Need to Know\\n\\nVersion 7.4 Controlled Use of Administrative Privileges          \\n\\n[1]: https://kubernetes.io/docs/admin/kube-controller-manager/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600796213,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.3.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"mj1-ode-sln\",\"isDefault\":true,\"name\":\"--service-account-private-key-file argument is set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.7\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit `docker.socket`, if applicable.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should also audit the Docker daemon. Because this daemon runs with root privileges, it is very important to audit its activities and usage. Its behavior depends on some key files and directories, including the `docker.socket` file, which holds various parameters for the Docker daemon, it should be audited.\\n\\n## Remediation\\n\\nIf the file exists, you should add a rule for it. For example, add the following line to the `/etc/audit/audit.rules` file:\\n\\n```\\n-w /usr/lib/systemd/system/docker.socket -k docker \\n```\\n\\nThen restart the audit daemon: \\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited. The file `docker.socket` may not be present, but if it is, it should be audited.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7.14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600857858,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.7\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"afg-qbt-7uw\",\"isDefault\":true,\"name\":\"docker.socket auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.15\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe Process ID (PID) namespace isolates the process ID space, meaning that processes in different PID namespaces can have the same PID. This creates process level isolation between the containers and the host.\\n\\n## Rationale\\n\\nPID namespace provides separation between processes. It prevents system processes from being visible, and allows process ids to be reused including PID 1. If the host's PID namespace is shared with containers, it would basically allow these to see all of the processes on the host system. This reduces the benefit of process level isolation between the host and the containers. Under these circumstances a malicious user who has access to a container could get access to processes on the host itself, manipulate them, and even be able to kill them. This could allow for the host itself being shut down, which could be extremely serious, particularly in a multi-tenanted environment. You should not share the host's process namespace with the containers running on it.\\n\\n## Remediation\\n\\nYou should not start a container with the `--pid=host` argument. For example, do not start a container with the command: `docker run --interactive --tty --pid=host centos /bin/bash`\\n\\n## Impact\\n\\nContainer processes cannot see processes on the host system. In certain circumstances, you may want your container to share the host's process namespace. For example, you could build a container containing debugging tools such as strace or gdb, and want to use these tools when debugging processes on the host. If this is desired, then share specific host processes using the `-p` switch. For example: `docker run --pid=host rhel7 strace -p 1234`\\n\\n## Default Value\\n\\nBy default, all containers have the PID namespace enabled and the therefore the host's process namespace is not shared with its containers.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/run/#pid-settings-pid 2. http://man7.org/linux/man-pages/man7/pid_namespaces.7.html\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600919537,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.15\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"mk8-jwd-4ag\",\"isDefault\":true,\"name\":\"Host's process namespace is not shared\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.4\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nUse https for kubelet connections.\\n\\n## Rationale\\n\\nConnections from apiserver to kubelets could potentially carry sensitive data such as secrets and keys. It is thus important to use in-transit encryption for any communication between the apiserver and kubelets.\\n\\n## Remediation\\n\\nEdit the API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml` on the master node and remove the `--kubelet-https` parameter.\\n\\n## Impact\\n\\nYou require TLS to be configured on apiserver as well as kubelets.\\n\\n## Default Value\\n\\nBy default, kubelet connections are over https.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-apiserver/ ][1]\\n2. [https://kubernetes.io/docs/admin/kubelet-authentication-authorization/][2]\\n\\n## CIS Controls\\n\\nVersion 6 14.2 Encrypt All Sensitive Information Over Less-trusted Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. Version 7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.                \\n\\n[1]: https://kubernetes.io/docs/admin/kube-apiserver/ \\n[2]: https://kubernetes.io/docs/admin/kubelet-authentication-authorization/\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599600981186,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ftg-h4g-hqj\",\"isDefault\":true,\"name\":\"--kubelet-https argument is set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.5\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not use `aufs` as the storage driver for your Docker instance.\\n\\n## Rationale\\n\\nThe `aufs` storage driver is the oldest storage driver used on Linux systems. It is based on a Linux kernel patch-set that is unlikely in future to be merged into the main OS kernel. The `aufs` driver is also known to cause some serious kernel crashes. `aufs` has only legacy support within systems using Docker. Most importantly, `aufs` is not a supported driver in many Linux distributions using latest Linux kernels.\\n\\n## Remediation\\n\\nDo not explicitly use `aufs` as storage driver. For example, do not start Docker daemon with the `--storage-driver aufs` flag.\\n\\n## Impact\\n\\n`aufs` is the only storage driver that allows containers to share executable and shared library memory. It might be useful if you are running thousands of containers with the same program or libraries. However, you should review its use with respect to your organization's security policy.\\n\\n## Default Value\\n\\nBy default, Docker uses `devicemapper` as the storage driver on most of the platforms. The default storage driver can vary based on your OS vendor. You should use the storage driver that is recommended by your preferred vendor and which is in line with policy around the applications which are being deployed.\\n\\n## References\\n\\n1. [https://docs.docker.com/engine/userguide/storagedriver/selectadriver/#supported-backing-filesystems][1]\\n2. [http://muehe.org/posts/switching-docker-from-aufs-to-devicemapper/][2]\\n3. [http://jpetazzo.github.io/assets/2015-03-05-deep-dive-into-docker-storage-drivers.html#1][3]\\n4. [https://docs.docker.com/engine/userguide/storagedriver/][4]\\n\\n## CIS Controls\\n\\nVersion 6.18 Application Software Security                \\n\\n[1]: https://docs.docker.com/engine/userguide/storagedriver/selectadriver/#supported-backing-filesystems \\n[2]: http://muehe.org/posts/switching-docker-from-aufs-to-devicemapper/ \\n[3]: http://jpetazzo.github.io/assets/2015-03-05-deep-dive-into-docker-storage-drivers.html#1 \\n[4]: https://docs.docker.com/engine/userguide/storagedriver/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601042737,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-2.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"n0x-jqo-rof\",\"isDefault\":true,\"name\":\"aufs storage driver is not used\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.22\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnable auditing on the Kubernetes API Server and set the desired audit log path.\\n\\n## Rationale\\n\\nAuditing the Kubernetes API Server provides a security-relevant chronological set of records documenting the sequence of activities that have affected system by individual users, administrators or other components of the system. Even though currently, Kubernetes provides only basic audit capabilities, it should be enabled. You can enable it by setting an appropriate audit log path.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --audit-log-path parameter to a suitable path and file where you would like audit logs to be written, for example: --audit-log-path=/var/log/apiserver/audit.log\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, auditing is not enabled.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22\\n\\n## CIS Controls\\n\\nVersion 6 6.2 Ensure Audit Log Settings Support Appropriate Log Entry Formatting Validate audit log settings for each hardware device and the software installed on it, ensuring that logs include a date, timestamp, source addresses, destination addresses, and various other useful elements of each packet and/or transaction. Systems should record logs in a standardized format such as syslog entries or those outlined by the Common Event Expression initiative. If systems cannot generate logs in a standardized format, log normalization tools can be deployed to convert logs into such a format. Version 7 6.2 Activate audit logging Ensure that local logging has been enabled on all systems and networking devices. 6.3 Enable Detailed Logging Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601104396,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.22\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"fny-sti-0dk\",\"isDefault\":true,\"name\":\"--audit-log-path argument is set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.17\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nLimit the Node and Pod objects that a kubelet could modify.\\n\\n## Rationale\\n\\nUsing the NodeRestriction plug-in ensures that the kubelet is restricted to the Node and Pod objects that it could modify as defined. Such kubelets will only be allowed to modify their own Node API object, and only modify Pod API objects that are bound to their node.\\n\\n## Remediation\\n\\nFollow the Kubernetes documentation and configure NodeRestriction plug-in on kubelets. Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --enable-admission-plugins parameter to a value that includes NodeRestriction. --enable-admission-plugins=...,NodeRestriction,...\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, NodeRestriction is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#noderestriction 3. https://kubernetes.io/docs/admin/authorization/node/ 4. https://acotten.com/post/kube17-security\\n\\n## CIS Controls\\n\\nVersion 6 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know Version 7 4 Controlled Use of Administrative Privileges Controlled Use of Administrative Privileges                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601166101,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.17\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"jre-tn7-yma\",\"isDefault\":true,\"name\":\"Admission control plugin NodeRestriction is set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.1\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the API server pod specification file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe API server pod specification file controls various parameters that set the behavior of the API server. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chmod 644 /etc/kubernetes/manifests/kube-apiserver.yaml`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the `kube-apiserver.yaml` file has permissions of 640.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601227733,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"8tj-q6g-eyj\",\"isDefault\":true,\"name\":\"API server pod specification file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.21\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the `/etc/sysconfig/docker` file permissions are correctly set to 644 or more restrictively.\\n\\n## Rationale\\n\\nThe `/etc/sysconfig/docker` file contains sensitive parameters that may alter the behavior of the Docker daemon. It should therefore be writeable only by root in order to ensure that it is not modified by less privileged users.\\n\\n## Remediation\\n\\nRun the following command: `chmod 644 /etc/sysconfig/docker`\\n\\nThis sets the file permissions for this file to 644.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system and in this case, this recommendation is not applicable.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/admin/configuring/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601289420,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.21\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"au3-ayl-tdm\",\"isDefault\":true,\"name\":\"/etc/sysconfig/docker file permissions are set to 644 or more restrictively\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.4.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not bind the scheduler service to non-loopback insecure addresses.\\n\\n## Rationale\\n\\nThe Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface\\n\\n## Remediation\\n\\nEdit the Scheduler pod specification file `/etc/kubernetes/manifests/kube-scheduler.yaml` on the master node and ensure the correct value for the `--bind-address` parameter\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the `--bind-address` parameter is set to 0.0.0.0\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/][1]\\n\\n## CIS Controls\\n\\nVersion 6.9.1 Limit Open Ports, Protocols, and Services - Ensure that only ports, protocols, and services with validated business needs are running on each system. \\n\\nVersion 7.9.2 Ensure Only Approved Ports, Protocols and Services Are Running - Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.                \\n\\n[1]: https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601351149,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.4.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"g1h-91b-y2x\",\"isDefault\":true,\"name\":\"--bind-address argument is set to 127.0.0.1 (Scheduler)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.11\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the etcd data directory has permissions of 700 or more restrictive.\\n\\n## Rationale\\n\\netcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world.\\n\\n## Remediation\\n\\nOn the etcd server node, get the etcd data directory, passed as an argument `--data-dir`, from the below command: `ps -ef | grep etcd`\\n\\nRun the command (based on the etcd data directory found above): `chmod 700 /var/lib/etcd`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, etcd data directory has permissions of 755.\\n\\n## References\\n\\n1. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#data-dir\\n2. https://kubernetes.io/docs/admin/etcd/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14 Controlled Access Based on the Need to Know\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601412710,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.11\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"qgj-hf0-an1\",\"isDefault\":true,\"name\":\"etcd data directory permissions are set to 700 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.10\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit `/etc/docker/daemon.json`, if applicable.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should also audit all Docker related files and directories. The Docker daemon runs with root privileges and its behavior depends on some key files and directories, including `/etc/docker/daemon.json`. This holds various parameters for the Docker daemon, and so it should be audited.\\n\\n## Remediation\\n\\nYou should add a rule for the `/etc/docker/daemon.json` file. For example, add the following line to the `/etc/audit/audit.rules` file: \\n\\n```\\n-w /etc/docker/daemon.json -k docker \\n```\\n\\nThen restart the audit daemon: \\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited. The file `/etc/docker/daemon.json` may not exist on the system and in that case, this recommendation is not applicable.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n2. [https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file][2]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7.14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html \\n[2]: https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601474412,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.10\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"v2o-aio-i0e\",\"isDefault\":true,\"name\":\"/etc/docker/daemon.json auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.1\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the docker.service file ownership and group ownership are correctly set to root.\\n\\n## Rationale\\n\\nThe docker.service file contains sensitive parameters that may alter the behavior of the Docker daemon. It should therefore be individually and group owned by the root user in order to ensure that it is not modified or corrupted by a less privileged user.\\n\\n## Remediation\\n\\n1. Find out the file location: `systemctl show -p FragmentPath docker.service`\\n2. If the file does not exist, this recommendation is not applicable. If the file does exist, you should execute the command below, including the correct file path, in order to set the ownership and group ownership for the file to root.\\n\\nFor example, `chown root:root /usr/lib/systemd/system/docker.service`\\n\\n## Impact\\n\\nNone.\\n\\n## Default Value\\n\\nThis file may not be present on the system and if it is not, this recommendation is not applicable. By default, if the file is present, the correct permissions are for the ownership and group ownership to be set to \\\"root\\\".\\n\\n## References\\n\\n1. https://docs.docker.com/engine/admin/systemd/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601536215,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"mhz-jes-n2m\",\"isDefault\":true,\"name\":\"docker.service file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.14\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAutomate service accounts management.\\n\\n## Rationale\\n\\nWhen you create a pod, if you do not specify a service account, it is automatically assigned the default service account in the same namespace. You should create your own service account and let the API server manage its security tokens.\\n\\n## Remediation\\n\\nFollow the documentation and create ServiceAccount objects as per your environment. Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and ensure that the --disable-admission-plugins parameter is set to a value that does not include ServiceAccount.\\n\\n## Impact\\n\\nNone.\\n\\n## Default Value\\n\\nBy default, ServiceAccount is set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#serviceaccount 3. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/\\n\\n## CIS Controls\\n\\nVersion 6 16 Account Monitoring and Control Account Monitoring and Control Version 7 16 Account Monitoring and Control Account Monitoring and Control                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601597784,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.14\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"wrk-jrm-u8h\",\"isDefault\":true,\"name\":\"Admission control plugin ServiceAccount is set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.8\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit `/etc/default/docker`, if applicable.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should audit all Docker related files and directories. The Docker daemon runs with root privileges and its behavior depends on some key files and directories, including `/etc/default/docker`. It holds various parameters related to the Docker daemon and should therefore be audited.\\n\\n## Remediation\\n\\nYou should add a rule for the `/etc/default/docker` file. For example, add the following line to the `/etc/audit/audit.rules` file: \\n\\n```\\n-w /etc/default/docker -k docker \\n```\\n\\nThen restart the audit daemon: \\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited so these defaults should be changed in line with organizational security policy. The file `/etc/default/docker` may not be present, and if so, this recommendation is not applicable.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7 14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601659531,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.8\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"qfi-cgy-a6e\",\"isDefault\":true,\"name\":\"/etc/default/docker auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.2\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the docker.service file permissions are either set to 644 or to a more restrictive value.\\n\\n## Rationale\\n\\nThe docker.service file contains sensitive parameters that may alter the behavior of the Docker daemon. It should therefore not be writable by any other user other than root in order to ensure that it can not be modified by less privileged users.\\n\\n## Remediation\\n\\n1. Find out the file location: `systemctl show -p FragmentPath docker.service`\\n2. If the file does not exist, this recommendation is not applicable. If the file exists, execute the command below including the correct file path to set the file permissions to 644. For example, `chmod 644 /usr/lib/systemd/system/docker.service`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system. In that case, this recommendation is not applicable. By default, if the file is present, the file permissions are correctly set to 644.\\n\\n## References\\n\\n1. https://docs.docker.com/articles/systemd/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601721176,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"zyv-o6s-69z\",\"isDefault\":true,\"name\":\"docker.service file permissions are appropriately set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.2.5\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not generally permit containers to be run with the allowPrivilegeEscalation flag set to true.\\n\\n## Rationale\\n\\nA container running with the `allowPrivilegeEscalation` flag set to true may have processes that can gain more privileges than their parent. There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to allow privilege escalation. The option exists (and is defaulted to true) to permit setuid binaries to run. If you have need to run containers that use setuid binaries or require privilege escalation, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\\n\\n## Remediation\\n\\nCreate a PSP as described in the Kubernetes documentation, ensuring that the `.spec.allowPrivilegeEscalation` field is omitted or set to false.\\n\\n## Impact\\n\\nPods defined with `spec.allowPrivilegeEscalation: true` will not be permitted unless they are run under a specific PSP.\\n\\n## Default Value\\n\\nBy default, PodSecurityPolicies are not defined.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/concepts/policy/pod-security-policy][1]\\n\\n## CIS Controls\\n\\nVersion 6 5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.                \\n\\n[1]: https://kubernetes.io/docs/concepts/policy/pod-security-policy\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1599601783271,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-5.2.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"frf-hog-dra\",\"isDefault\":true,\"name\":\"Minimize the admission of containers with allowPrivilegeEscalation\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.22\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the `/etc/default/docker` file permissions are correctly set to 644 or more restrictively.\\n\\n## Rationale\\n\\nThe `/etc/default/docker` file contains sensitive parameters that may alter the behavior of the Docker daemon. It should therefore be writeable only by root in order to ensure that it is not modified by less privileged users.\\n\\n## Remediation\\n\\nRun the following command: `chmod 644 /etc/default/docker`\\n\\nThis sets the file permissions for this file to 644.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system and in this case, this recommendation is not applicable.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/admin/configuring/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601845070,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.22\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"pqb-2cq-piw\",\"isDefault\":true,\"name\":\"/etc/default/docker file permissions are set to 644 or more restrictively\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.24\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIt is possible to attach to a particular `cgroup` when a container is instantiated. Confirming `cgroup` usage would ensure that containers are running in defined `cgroup`s.\\n\\n## Rationale\\n\\nSystem administrators typically define `cgroup`s in which containers are supposed to run. If `cgroup`s are not explicitly defined by the system administrator, containers run in the docker `cgroup` by default. At run time, it is possible to attach a container to a different `cgroup` other than the one originally defined. This usage should be monitored and confirmed, as by attaching to a different `cgroup`, excess permissions and resources might be granted to the container and this can therefore prove to be a security risk.\\n\\n## Remediation\\n\\nYou should not use the `--cgroup-parent` option within the docker run command unless strictly required.\\n\\n## Impact\\n\\nNone.\\n\\n## Default Value\\n\\nBy default, containers run under docker `cgroup`.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/run/#specify-custom-cgroups\\n2. https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/ch01.html\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601906764,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.24\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"maa-bf8-zan\",\"isDefault\":true,\"name\":\"cgroup usage is confirmed\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.12\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the etcd data directory ownership is set to `etcd:etcd`.\\n\\n## Rationale\\n\\n`etcd` is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should be owned by `etcd:etcd`.\\n\\n## Remediation\\n\\nOn the etcd server node, get the etcd data directory, passed as an argument `--data-dir`, from the below command: `ps -ef | grep etcd`\\n\\nRun the command (based on the etcd data directory found above): `chown etcd:etcd /var/lib/etcd`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, etcd data directory ownership is set to `etcd:etcd`.\\n\\n## References\\n\\n1. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#data-dir\\n2. https://kubernetes.io/docs/admin/etcd/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14 Controlled Access Based on the Need to Know\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599601968321,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.12\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"25d-zal-sfr\",\"isDefault\":true,\"name\":\"etcd data directory ownership is set to etcd:etcd\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.5\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not disable timeouts on streaming connections.\\n\\n## Rationale\\n\\nSetting idle timeouts ensures that you are protected against denial-of-service attacks, inactive connections, and running out of ephemeral ports. \\n\\n*Note*: By default, `--streaming-connection-idle-timeout` is set to four hours, which might be too high for your environment. Setting this as appropriate would additionally ensure that such streaming connections are timed out after serving legitimate use cases.\\n\\n## Remediation\\n\\nIf using a Kubelet config file, edit the file to set `streamingConnectionIdleTimeout` to a value other than 0. If using command line arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and set the below parameter in `KUBELET_SYSTEM_PODS_ARGS` variable. \\n\\n`--streaming-connection-idle-timeout=5m`\\n\\nBased on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nLong-lived connections could be interrupted.\\n\\n## Default Value\\n\\nBy default, `--streaming-connection-idle-timeout` is set to four hours.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/ ][1]\\n2. [https://github.com/kubernetes/kubernetes/pull/18552][2]\\n\\n## CIS Controls\\n\\nVersion 6.9 Limitation and Control of Network Ports, Protocols, and Services\\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/ \\n[2]: https://github.com/kubernetes/kubernetes/pull/18552 \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602030157,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"xmg-h3a-wj4\",\"isDefault\":true,\"name\":\"--streaming-connection-idle-timeout argument is not set to 0\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.3\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIf kube-proxy is running, and if it is using a file-based kubeconfig file, ensure that the proxy kubeconfig file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe kube-proxy kubeconfig file controls various parameters of the kube-proxy service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system. It is possible to run kube-proxy with the kubeconfig parameters configured as a Kubernetes ConfigMap instead of a file. In this case, there is no proxy kubeconfig file.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the each worker node:\\n\\n```\\nchmod 644 <proxy kubeconfig file>\\n```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, proxy file has permissions of 640.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-proxy/][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.        \\n\\n[1]: https://kubernetes.io/docs/admin/kube-proxy/                  \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602091672,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"alc-y7j-j9q\",\"isDefault\":true,\"name\":\"Proxy kubeconfig file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.7\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe TCP/IP port numbers below 1024are considered privileged ports. Normal users and processes are not allowed to use them for various security reasons. Docker does, however allow a container port to be mapped to a privileged port.\\n\\n## Rationale\\n\\nBy default, if the user does not specifically declare a container port to host port mapping, Docker automatically and correctly maps the container port to one available in the `49153`-`65535` range on the host. Docker does, however, allow a container port to be mapped to a privileged port on the host if the user explicitly declares it. This is because containers are executed with `NET_BIND_SERVICE` Linux kernel capability which does not restrict privileged port mapping. The privileged ports receive and transmit various pieces of data which are security sensitive and allowing containers to use them is not in line with good security practice.\\n\\n## Remediation\\n\\nDo not map container ports to privileged host ports when starting a container. You should also ensure that there is no such container to host privileged port mapping declarations in the Dockerfile.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, mapping a container port to a privileged port on the host is allowed.\\n\\n**Note**: There might be certain cases where you want to map privileged ports, because if you forbid it, then the corresponding application has to run outside of a container.\\n\\nFor example: HTTP and HTTPS load balancers have to bind `80/tcp` and `443/tcp` respectively. Forbidding to map privileged ports effectively forbids from running those in a container, and mandates using an external load balancer. In such cases, those containers instances should be marked as exceptions for this recommendation.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/userguide/networking/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n9.1 Limit Open Ports, Protocols, and Services - Ensure that only ports, protocols, and services with validated business needs are running on each system.\\n\\nVersion 7\\n\\n9.2 Ensure Only Approved Ports, Protocols and Services Are Running - Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602153218,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.7\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ua5-ygj-jad\",\"isDefault\":true,\"name\":\"Privileged ports are not mapped within containers\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.2.1\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nKubernetes can audit the details of requests made to the API server. The `--audit-policy-file` flag must be set for this logging to be enabled.\\n\\n## Rationale\\n\\nLogging is an important detective control for all systems, to detect potential unauthorised access.\\n\\n## Remediation\\n\\nCreate an audit policy file for your cluster.\\n\\n## Impact\\n\\nAudit logs will be created on the master nodes, which will consume disk space. Care should be taken to avoid generating too large volumes of log information as this could impact the available of the cluster nodes.\\n\\n## Default Value\\n\\nUnless the `--audit-policy-file` flag is specified, no auditing will be carried out.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/tasks/debug-application-cluster/audit/][1]\\n\\n## CIS Controls\\n\\nVersion 7.6.2 Activate audit logging - Ensure that local logging has been enabled on all systems and networking devices.\\n\\n[1]: https://kubernetes.io/docs/tasks/debug-application-cluster/audit/                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602215207,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-3.2.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ehp-xpm-xi3\",\"isDefault\":true,\"name\":\"Minimal audit policy is created\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.12\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe container's root filesystem should be treated as a 'golden image' by using Docker run's `--read-only` option. This prevents any writes to the container's root filesystem at container runtime and enforces the principle of immutable infrastructure.\\n\\n## Rationale\\n\\nEnabling this option forces containers at runtime to explicitly define their data writing strategy to persist or not persist their data. This also reduces security attack vectors since the container instance's filesystem cannot be tampered with or written to unless it has explicit read-write permissions on its filesystem folder and directories.\\n\\n## Remediation\\n\\nAdd a `--read-only` flag at a container's runtime to enforce the container's root filesystem being mounted as read only. For example, `docker run <Run arguments> --read-only <Container Image Name or ID> <Command>`\\n\\nEnabling the `--read-only` option at a container's runtime should be used by administrators to force a container's executable processes to only write container data to explicit storage locations during its lifetime. \\n\\nExamples of explicit storage locations during a container's runtime include, but are not limited to:\\n\\n1. Using the `--tmpfs` option to mount a temporary file system for non-persistent data writes. `docker run --interactive --tty --read-only --tmpfs \\\"/run\\\" --tmpfs \\\"/tmp\\\" centos /bin/bash`\\n2. Enabling Docker rw mounts at a container's runtime to persist container data directly on the Docker host filesystem. For example, `docker run --interactive --tty --read-only -v /opt/app/data:/run/app/data:rw centos /bin/bash`\\n\\n3. Utilizing the Docker shared-storage volume plugin for Docker data volume to persist container data. For example, `docker volume create -d convoy --opt o=size=20GB my-named-volume docker run --interactive --tty --read-only -v my-named-volume:/run/app/data centos /bin/bash`\\n\\n3. Transmitting container data outside of the Docker controlled area during the container's runtime for container data in order to ensure that it is persistent. Examples include hosted databases, network file shares and APIs.\\n\\n## Impact\\n\\nEnabling `--read-only` at container runtime may break some container OS packages if a data writing strategy is not defined. You should define what the container's data should and should not persist at runtime in order to decide which strategy to use. Example: Enable use `--tmpfs` for temporary file writes to /tmp Use Docker shared data volumes for persistent data writes\\n\\n## Default Value\\n\\nBy default, a container has its root filesystem writeable, allowing all container processes to write files owned by the container's actual runtime user.\\n\\n## References\\n\\n1. http://docs.docker.com/reference/commandline/cli/#run\\n2. https://docs.docker.com/engine/tutorials/dockervolumes/\\n3. http://www.projectatomic.io/blog/2015/12/making-docker-images-write-only-in-production/\\n4. https://docs.docker.com/engine/reference/commandline/run/#mount-tmpfs-tmpfs\\n5. https://docs.docker.com/engine/tutorials/dockervolumes/#creating-and-mounting-a-data-volume-container\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602276896,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.12\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"635-mc8-3mr\",\"isDefault\":true,\"name\":\"Container's root filesystem is mounted as read only\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.8\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nRestrict kubelet nodes to reading only objects associated with them.\\n\\n## Rationale\\n\\nThe Node authorization mode only allows kubelets to read Secret, ConfigMap, PersistentVolume, and PersistentVolumeClaim objects associated with their nodes.\\n\\n## Remediation\\n\\nEdit the API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml` on the master node and set the `--authorization-mode` parameter to a value that includes Node. `--authorization-mode=Node,RBAC`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, Node authorization is not enabled.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-apiserver/ ][1]\\n2. [https://kubernetes.io/docs/admin/authorization/node/ ][2]\\n3. [https://github.com/kubernetes/kubernetes/pull/46076 ][3]\\n4. [https://acotten.com/post/kube17-security][4]\\n\\n## CIS Controls\\n\\nVersion 6.9.1 Limit Open Ports, Protocols, and Services - Ensure that only ports, protocols, and services with validated business needs are running on each system. \\n\\nVersion 7.9.2 Ensure Only Approved Ports, Protocols and Services Are Running - Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.              \\n\\n[1]: https://kubernetes.io/docs/admin/kube-apiserver/ \\n[2]: https://kubernetes.io/docs/admin/authorization/node/ \\n[3]: https://github.com/kubernetes/kubernetes/pull/46076 \\n[4]: https://acotten.com/post/kube17-security\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602338742,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.8\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"vgg-kwx-7dh\",\"isDefault\":true,\"name\":\"--authorization-mode argument includes Node\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.3.3\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nUse individual service account credentials for each controller.\\n\\n## Rationale\\n\\nThe controller manager creates a service account per controller in the kube-system namespace, generates a credential for it, and builds a dedicated API client with that service account credential for each controller loop to use. Setting the `--use-service-account-credentials` to true runs each control loop within the controller manager using a separate service account credential. When used in combination with RBAC, this ensures that the control loops run with the minimum permissions required to perform their intended tasks.\\n\\n## Remediation\\n\\nEdit the Controller Manager pod specification file `/etc/kubernetes/manifests/kube-controller-manager.yaml` on the master node to set the below parameter:\\n\\n```\\n--use-service-account-credentials=true\\n```\\n\\n## Impact\\n\\nWhatever authorizer is configured for the cluster, it must grant sufficient permissions to the service accounts to perform their intended tasks. When using the RBAC authorizer, those roles are created and bound to the appropriate service accounts in the kube-system namespace automatically with default roles and rolebindings that are auto-reconciled on startup. If using other authorization methods (ABAC, Webhook, etc.), the cluster deployer is responsible for granting appropriate permissions to the service accounts (the required permissions can be seen by inspecting the `controller-roles.yaml` and `controller-role-bindings.yaml` files for the RBAC roles.\\n\\n## Default Value\\n\\nBy default, `--use-service-account-credentials` is set to false.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-controller-manager/ ][1]\\n2. [https://kubernetes.io/docs/admin/service-accounts-admin/ ][2]\\n3. [https://github.com/kubernetes/kubernetes/blob/release-1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-roles.yaml ][3]\\n4. [https://github.com/kubernetes/kubernetes/blob/release-1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-role-bindings.yaml ][4]\\n5. [https://kubernetes.io/docs/admin/authorization/rbac/#controller-roles][5]\\n\\n## CIS Controls\\n\\nVersion 6.14 Controlled Access Based on the Need to Know\\n\\nVersion 7.4 Controlled Use of Administrative Privileges \\n\\n[1]: https://kubernetes.io/docs/admin/kube-controller-manager/ \\n[2]: https://kubernetes.io/docs/admin/service-accounts-admin/ \\n[3]: https://github.com/kubernetes/kubernetes/blob/release-1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-roles.yaml \\n[4]: https://github.com/kubernetes/kubernetes/blob/release-1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-role-bindings.yaml \\n[5]: https://kubernetes.io/docs/admin/authorization/rbac/#controller-roles\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602400314,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.3.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"b7m-bho-nat\",\"isDefault\":true,\"name\":\"--use-service-account-credentials argument is set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.6\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nProtect tuned kernel parameters from overriding kubelet default kernel parameter values.\\n\\n## Rationale\\n\\nKernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.\\n\\n## Remediation\\n\\nIf using a Kubelet config file, edit the file to set `protectKernelDefaults: true`. If using command line arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and set the below parameter in `KUBELET_SYSTEM_PODS_ARGS` variable. \\n\\n`--protect-kernel-defaults=true` \\n\\nBased on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nYou would have to re-tune kernel parameters to match kubelet parameters.\\n\\n## Default Value\\n\\nBy default, `--protect-kernel-defaults` is not set.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/][1]\\n\\n## CIS Controls\\n\\nVersion 6.3 Secure Configurations for Hardware and Software on Mobile Devices, Laptops, Workstations, and Servers\\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602462044,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"uiw-kms-wwu\",\"isDefault\":true,\"name\":\"--protect-kernel-defaults argument is set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.4\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit `/var/lib/docker`.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should also audit all Docker related files and directories. The Docker daemon runs with root privileges and its behavior depends on some key files and directories. For example, audit `/var/lib/docker`, which holds all the information about containers it should be audited.\\n\\n## Remediation\\n\\nYou should add a rule for the `/var/lib/docker` directory. For example, add the following line to the `/etc/audit/audit.rules` file:\\n\\n```\\n-w /var/lib/docker -k docker \\n```\\n\\nThen restart the audit daemon:\\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7.14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602523672,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"tfa-927-tto\",\"isDefault\":true,\"name\":\"/var/lib/docker auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.31\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe Docker socket docker.sock should not be mounted inside a container.\\n\\n## Rationale\\n\\nIf the Docker socket is mounted inside a container it could allow processes running within the container to execute Docker commands which would effectively allow for full control of the host.\\n\\n## Remediation\\n\\nYou should ensure that no containers mount docker.sock as a volume.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, docker.sock is not mounted inside containers.\\n\\n## References\\n\\n1. https://raesene.github.io/blog/2016/03/06/The-Dangers-Of-Docker.sock/\\n2. https://forums.docker.com/t/docker-in-docker-vs-mounting-var-run-docker-sock/9450/2\\n3. https://github.com/docker/docker/issues/21109\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n9 Limitation and Control of Network Ports, Protocols, and Services\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602585460,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.31\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"3iw-zus-yz3\",\"isDefault\":true,\"name\":\"Docker socket is not mounted inside any containers\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.7\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not always authorize all requests.\\n\\n## Rationale\\n\\nThe API Server, can be configured to allow all requests. This mode should not be used on any production cluster.\\n\\n## Remediation\\n\\nEdit the API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml` on the master node and set the `--authorization-mode` parameter to values other than `AlwaysAllow`. One such example could be as below:\\n\\n```\\n--authorization-mode=RBAC\\n```\\n\\n## Impact\\n\\nOnly authorized requests will be served.\\n\\n## Default Value\\n\\nBy default, AlwaysAllow is not enabled.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-apiserver/ ][1]\\n2. [https://kubernetes.io/docs/admin/authorization/node/ ][2]\\n\\n\\n## CIS Controls\\n\\nVersion 6.9.1 Limit Open Ports, Protocols, and Services - Ensure that only ports, protocols, and services with validated business needs are running on each system. \\n\\nVersion 7.9.2 Ensure Only Approved Ports, Protocols and Services Are Running - Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.              \\n\\n[1]: https://kubernetes.io/docs/admin/kube-apiserver/ \\n[2]: https://kubernetes.io/docs/admin/authorization/node/ \\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602646953,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.7\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"kli-btm-jbr\",\"isDefault\":true,\"name\":\"--authorization-mode argument is not set to AlwaysAllow (API server)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.4\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nUsing the `--privileged` flag provides all Linux kernel capabilities to the container to which it is applied and therefore overwrites the `--cap-add` and `--cap-drop` flags. For this reason, ensure that it is not used.\\n\\n## Rationale\\n\\nThe `--privileged` flag provides all capabilities to the container to which it is applied, and also lifts all the limitations enforced by the device cgroup controller. As a consequence this the container has most of the rights of the underlying host. This flag only exists to allow for specific use cases (for example running Docker within Docker) and should not generally be used.\\n\\n## Remediation\\n\\nDo not run containers with the `--privileged` flag. For example, do not start a container using the command `docker run --interactive --tty --privileged centos /bin/bash`\\n\\n## Impact\\n\\nIf you start a container without the `--privileged` flag, it will not have excessive default capabilities.\\n\\n## Default Value\\n\\nFalse\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602708557,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"rbd-urm-klo\",\"isDefault\":true,\"name\":\"Privileged containers are not used\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.21\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDisable profiling, if not needed.\\n\\n## Rationale\\n\\nProfiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the below parameter. --profiling=false\\n\\n## Impact\\n\\nProfiling information would not be available.\\n\\n## Default Value\\n\\nBy default, profiling is enabled.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/community/blob/master/contributors/devel/profiling.md\\n\\n## CIS Controls\\n\\nVersion 6 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know Version 7 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602770265,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.21\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"wk0-7yo-dw9\",\"isDefault\":true,\"name\":\"--profiling argument is set to false (API server)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.18\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the daemon.json file permissions are correctly set to 644 or more restrictively.\\n\\n## Rationale\\n\\nThe daemon.json file contains sensitive parameters that may alter the behavior of the docker daemon. Therefore it should be writeable only by root to ensure it is not modified by less privileged users.\\n\\n## Remediation\\n\\nRun `chmod 644 /etc/docker/daemon.json`\\n\\nThis sets the file permissions for this file to 644.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system, and in that case, this recommendation is not applicable.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602831833,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.18\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"7df-4w8-g7l\",\"isDefault\":true,\"name\":\"daemon.json file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the API server pod specification file ownership is set to root:root.\\n\\n## Rationale\\n\\nThe API server pod specification file controls various parameters that set the behavior of the API server. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, chown root:root /etc/kubernetes/manifests/kube-apiserver.yaml\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the kube-apiserver.yaml file ownership is set to root:root.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6 5.1 Minimize And Sparingly Use Administrative Privileges Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. Version 7 5.2 Maintain Secure Images Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602893246,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"vbb-t30-k0f\",\"isDefault\":true,\"name\":\"API server pod specification file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.33\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:false\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEncrypt etcd key-value store.\\n\\n## Rationale\\n\\netcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted at rest to avoid any disclosures.\\n\\n## Remediation\\n\\nFollow the Kubernetes documentation and configure a EncryptionConfig file. Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --encryption-provider-config parameter to the path of that file: --encryption-provider-config=</path/to/EncryptionConfig/File>\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, --encryption-provider-config is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/ 2. https://acotten.com/post/kube17-security 3. https://kubernetes.io/docs/admin/kube-apiserver/ 4. https://github.com/kubernetes/features/issues/92\\n\\n## CIS Controls\\n\\nVersion 6 14.5 Encrypt At Rest Sensitive Information Sensitive information stored on systems shall be encrypted at rest and require a secondary authentication mechanism, not integrated into the operating system, in order to access the information. Version 7 14.8 Encrypt Sensitive Information at Rest Encrypt all sensitive information at rest using a tool that requires a secondary authentication mechanism not integrated into the operating system, in order to access the information.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599602954959,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.33\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"7rg-crl-fs0\",\"isDefault\":true,\"name\":\"--encryption-provider-config argument is set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.28\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should use the `--pids-limit` flag at container runtime.\\n\\n## Rationale\\n\\nAttackers could launch a fork bomb with a single command inside the container. This fork bomb could crash the entire system and would require a restart of the host to make the system functional again. Using the PIDs cgroup parameter --pids-limit would prevent this kind of attack by restricting the number of forks that can happen inside a container within a specified time frame.\\n\\n## Remediation\\n\\nUse `--pids-limit` flag with an appropriate value when launching the container. For example, `docker run -it --pids-limit 100 <Image_ID>`\\n\\nIn the above example, the number of processes allowed to run at any given time is set to 100. After a limit of 100 concurrently running processes is reached, Docker would restrict any new process creation.\\n\\n## Impact\\n\\nSet the PIDs limit value as appropriate. Incorrect values might leave containers unusable.\\n\\n## Default Value\\n\\nThe Default value for `--pids-limit` is 0 which means there is no restriction on the number of forks. Note that the PIDs cgroup limit works only for kernel versions 4.3 and higher.\\n\\n## References\\n\\n1. https://github.com/docker/docker/pull/18697\\n2. https://docs.docker.com/engine/reference/commandline/run/#options\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603016485,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.28\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"tmp-lms-u8p\",\"isDefault\":true,\"name\":\"PIDs cgroup limit is used\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.6\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the scheduler pod specification file ownership is set to root:root.\\n\\n## Rationale\\n\\nThe scheduler pod specification file controls various parameters that set the behavior of the kube-scheduler service in the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chown root:root /etc/kubernetes/manifests/kube-scheduler.yaml`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `kube-scheduler.yaml` file ownership is set to root:root.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-scheduler/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603078027,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"y79-4ts-a0k\",\"isDefault\":true,\"name\":\"Scheduler pod specification file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.4.1\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDisable profiling, if not needed.\\n\\n## Rationale\\n\\nProfiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.\\n\\n## Remediation\\n\\nEdit the Scheduler pod specification file `/etc/kubernetes/manifests/kube-scheduler.yaml` file on the master node and set the below parameter:\\n\\n```\\n--profiling=false\\n```\\n\\n## Impact\\n\\nProfiling information would not be available.\\n\\n## Default Value\\n\\nBy default, profiling is enabled.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-scheduler/ ][1]\\n2. [https://github.com/kubernetes/community/blob/master/contributors/devel/profiling.md][2]\\n\\n## CIS Controls\\n\\nVersion 6 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know Version 7 4 Controlled Use of Administrative Privileges Controlled Use of Administrative Privileges                \\n\\n[1]: https://kubernetes.io/docs/admin/kube-scheduler/ \\n[2]: https://github.com/kubernetes/community/blob/master/contributors/devel/profiling.md\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603139661,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.4.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"hya-urf-09b\",\"isDefault\":true,\"name\":\"--profiling argument is set to false (Scheduler)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.25\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nRotate log files on reaching 100 MB or as appropriate.\\n\\n## Rationale\\n\\nKubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. If you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --audit-log-maxsize parameter to an appropriate size in MB. For example, to set it as 100 MB: --audit-log-maxsize=100\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, auditing is not enabled.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22\\n\\n## CIS Controls\\n\\nVersion 6 6.3 Ensure Audit Logging Systems Are Not Subject To Loss (i.e. rotation/archive) Ensure that all systems that store logs have adequate storage space for the logs generated on a regular basis, so that log files will not fill up between log rotation intervals. The logs must be archived and digitally signed on a periodic basis. Version 7 6.4 Ensure adequate storage for logs Ensure that all systems that store logs have adequate storage space for the logs generated.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603202907,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.25\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"qhy-gng-bh4\",\"isDefault\":true,\"name\":\"--audit-log-maxsize argument is set to 100 or as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.17\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the daemon.json file individual ownership and group ownership is correctly set to root.\\n\\n## Rationale\\n\\nThe daemon.json file contains sensitive parameters that could alter the behavior of the docker daemon. It should therefore be owned and group owned by root to ensure it can not be modified by less privileged users.\\n\\n## Remediation\\n\\nRun `chown root:root /etc/docker/daemon.json`\\n\\nThis sets the ownership and group ownership for the file to root.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system, and in that case, this recommendation is not applicable.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603264485,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.17\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"hlb-qzw-opk\",\"isDefault\":true,\"name\":\"daemon.json file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.8\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the certificate authorities file ownership is set to root:root.\\n\\n## Rationale\\n\\nThe certificate authorities file controls the authorities used to validate API requests. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root.\\n\\n## Remediation\\n\\nRun the following command to modify the ownership of the `--client-ca-file`: \\n\\n```\\nchown root:root <filename>\\n```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default no `--client-ca-file` is specified.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/authentication/#x509-client-certs][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.                \\n\\n[1]: https://kubernetes.io/docs/admin/authentication/#x509-client-certs\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603326156,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.8\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ifc-9ej-k7k\",\"isDefault\":true,\"name\":\"Client certificate authorities file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.16\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the Docker socket file has permissions of 660 or are configured more restrictively.\\n\\n## Rationale\\n\\nOnly root and the members of the docker group should be allowed to read and write to the default Docker Unix socket. The Docker socket file should therefore have permissions of 660 or more restrictive permissions.\\n\\n## Remediation\\n\\nRun the command `chmod 660 /var/run/docker.sock`\\n\\nThis sets the file permissions of the Docker socket file to 660.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the permissions for the Docker socket file is correctly set to 660.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option\\n2. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-to-another-hostport-or-a-unix-socket\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603387716,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.16\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"jxv-zrr-1c1\",\"isDefault\":true,\"name\":\"Docker socket file permissions are set to 660 or more restrictively\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.3\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not use token based authentication.\\n\\n## Rationale\\n\\nThe token-based authentication utilizes static tokens to authenticate requests to the apiserver. The tokens are stored in clear-text in a file on the apiserver, and cannot be revoked or rotated without restarting the apiserver. Hence, do not use static token-based authentication.\\n\\n## Remediation\\n\\nFollow the documentation and configure alternate mechanisms for authentication. Then, edit the API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml` on the master node and remove the `--token-auth-file=<filename>` parameter.\\n\\n## Impact\\n\\nYou will have to configure and use alternate authentication mechanisms such as certificates. Static token based authentication could not be used.\\n\\n## Default Value\\n\\nBy default, `--token-auth-file` argument is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/authentication/#static-token-file\\n2. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n16.14 Encrypt/Hash All Authentication Files And Monitor Their Access - Verify that all authentication files are encrypted or hashed and that these files cannot be accessed without root or administrator privileges. Audit all access to password files in the system.\\n\\nVersion 7\\n\\n16.4 Encrypt or Hash all Authentication Credentials - Encrypt or hash with a salt all authentication credentials when stored.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603449449,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"mvv-hb7-ucv\",\"isDefault\":true,\"name\":\"--token-auth-file parameter is not set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.12\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit `/usr/sbin/runc`, if applicable.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should also audit all Docker related files and directories. The Docker daemon runs with root privileges and its behavior depends on some key files and directories, including `/usr/sbin/runc`, and so it should be audited.\\n\\n## Remediation\\n\\nYou should add a rule for `/usr/sbin/runc` file. For example, add the following line to the `/etc/audit/audit.rules` file:\\n\\n```\\n-w /usr/sbin/runc -k docker\\n```\\n\\nThen restart the audit daemon:\\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited. The `file/usr/sbin/runc` may not be present on the system, and in that case this recommendation is not applicable.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n2. [https://github.com/docker/docker/pull/20662][2]\\n3. [https://containerd.tools/][3]\\n4. [https://github.com/opencontainers/runc][4]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7.14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html \\n[2]: https://github.com/docker/docker/pull/20662 \\n[3]: https://containerd.tools/ \\n[4]: https://github.com/opencontainers/runc\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603510904,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.12\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ksp-ylk-dub\",\"isDefault\":true,\"name\":\"/usr/sbin/runc auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.10\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nSetup TLS connection on the Kubelets.\\n\\n## Rationale\\n\\nKubelet communication contains sensitive parameters that should remain encrypted in transit. Configure the Kubelets to serve only HTTPS traffic.\\n\\n## Remediation\\n\\nIf using a Kubelet config file, edit the file to set `tlsCertFile` to the location of the certificate file to use to identify this Kubelet, and `tlsPrivateKeyFile` to the location of the corresponding private key file. If using command line arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and set the below parameters in K`UBELET_CERTIFICATE_ARGS` variable. \\n\\n```\\n--tls-cert-file=<path/to/tls-certificate-file> \\n--tls-private-key-file=<path/to/tls-key-file>\\n```\\n\\nBased on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nTLS and client certificate authentication must be configured for your Kubernetes cluster deployment.\\n\\n## Default Value\\n\\nBy default, `--tls-cert-file` and `--tls-private-key-file` arguments are not set. If `--tls-cert-file` and `--tls-private-key-file` are not provided, a self-signed certificate and key are generated for the public address and saved to the directory passed to `--cert-dir`.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/ ][1]\\n2. [http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ ][2]\\n3. [https://github.com/kelseyhightower/docker-kubernetes-tls-guide ][3]\\n4. [https://jvns.ca/blog/2017/08/05/how-kubernetes-certificates-work/][4]\\n\\n## CIS Controls\\n\\nVersion 6.14.2 Encrypt All Sensitive Information Over Less-trusted Networks - All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7.14.4 Encrypt All Sensitive Information in Transit - Encrypt all sensitive information in transit.    \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/ \\n[2]: http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ \\n[3]: https://github.com/kelseyhightower/docker-kubernetes-tls-guide \\n[4]: https://jvns.ca/blog/2017/08/05/how-kubernetes-certificates-work/            \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603572402,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.10\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"gqg-7cf-6bu\",\"isDefault\":true,\"name\":\"--tls-cert-file and --tls-private-key-file arguments are set as appropriate (Kubelet)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.3\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the controller manager pod specification file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe controller manager pod specification file controls various parameters that set the behavior of the Controller Manager on the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chmod 644 /etc/kubernetes/manifests/kube-controller-manager.yaml`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the `kube-controller-manager.yaml` file has permissions of 640.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603633988,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"pr0-hcf-xkw\",\"isDefault\":true,\"name\":\"Controller manager pod specification file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.19\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the Kubernetes PKI directory and file ownership is set to root:root.\\n\\n## Rationale\\n\\nKubernetes makes use of a number of certificates as part of its operation. You should set the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by root:root.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chown -R root:root /etc/kubernetes/pki/`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the `/etc/kubernetes/pki/` directory and all of the files and directories contained within it, are set to be owned by the root user.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603695482,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.19\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"tgm-6a5-ttf\",\"isDefault\":true,\"name\":\"Kubernetes PKI directory and file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.20\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not disable the secure port.\\n\\n## Rationale\\n\\nThe secure port is used to serve https with authentication and authorization. If you disable it, no https traffic is served and all traffic is served unencrypted.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and either remove the --secure-port parameter or set it to a different (non-zero) desired port.\\n\\n## Impact\\n\\nYou need to set the API Server up with the right TLS certificates.\\n\\n## Default Value\\n\\nBy default, port 6443 is used as the secure port.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6 14.2 Encrypt All Sensitive Information Over Less-trusted Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. Version 7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603757033,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.20\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"5w3-iw4-y16\",\"isDefault\":true,\"name\":\"--secure-port argument is not set to 0\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.3.7\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not bind the Controller Manager service to non-loopback insecure addresses.\\n\\n## Rationale\\n\\nThe Controller Manager API service which runs on port 10252/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface\\n\\n## Remediation\\n\\nEdit the Controller Manager pod specification file `/etc/kubernetes/manifests/kube-controller-manager.yaml` on the master node and ensure the correct value for the `--bind-address` parameter\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the `--bind-address` parameter is set to 0.0.0.0\\n\\n## References\\n\\n1. https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/ \\n\\n*Notes*: Although the current Kubernetes documentation site says that `--address` is deprecated in favour of `--bind-address`. Kubeadm 1.11 still makes use of `--address`\\n\\n## CIS Controls\\n\\nVersion 6.9.1 Limit Open Ports, Protocols, and Services - Ensure that only ports, protocols, and services with validated business needs are running on each system. \\n\\nVersion 7.9.2 Ensure Only Approved Ports, Protocols and Services Are Running - Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603818624,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.3.7\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"pvo-5un-k18\",\"isDefault\":true,\"name\":\"--bind-address argument is set to 127.0.0.1 (Controller Manager)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.6\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nVerify kubelet's certificate before establishing connection.\\n\\n## Rationale\\n\\nThe connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelets port-forwarding functionality. These connections terminate at the kubelets HTTPS endpoint. By default, the apiserver does not verify the kubelets serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks.\\n\\n## Remediation\\n\\nFollow the Kubernetes documentation and setup the TLS connection between the apiserver and kubelets. Then, edit the API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml` on the master node and set the `--kubelet-certificate-authority` parameter to the path to the cert file for the certificate authority. \\n\\n```\\n--kubelet-certificate-authority=<ca-string>\\n```\\n\\n## Impact\\n\\nYou require TLS to be configured on apiserver as well as kubelets.\\n\\n## Default Value\\n\\nBy default, 1--kubelet-certificate-authority` argument is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ \\n2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/ \\n3. https://kubernetes.io/docs/concepts/cluster-administration/master-node-communication/#apiserver---kubelet\\n\\n## CIS Controls\\n\\nVersion 6.3.4 Use Only Secure Channels For Remote System Administration - Perform all remote administration of servers, workstation, network devices, and similar equipment over secure channels. Protocols such as telnet, VNC, RDP, or others that do not actively support strong encryption should only be used if they are performed over a secondary encryption channel, such as SSL, TLS or IPSEC. \\n\\nVersion 7.4.5 Use Multifactor Authentication For All Administrative Access - Use multi-factor authentication and encrypted channels for all administrative account access.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603880124,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"sbm-nxt-qv3\",\"isDefault\":true,\"name\":\"--kubelet-certificate-authority argument is set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.4\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEtcd should be configured to make use of TLS encryption for peer connections.\\n\\n## Rationale\\n\\nEtcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit and also amongst peers in the etcd clusters.\\n\\n## Remediation\\n\\nFollow the etcd service documentation and configure peer TLS encryption as appropriate for your etcd cluster. Then, edit the etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` on the master node and set the below parameters:\\n\\n```\\n--peer-cert-file=</path/to/peer-cert-file> \\n--peer-key-file=</path/to/peer-key-file>\\n```\\n\\n## Impact\\n\\nEtcd cluster peers would need to set up TLS for their communication.\\n\\n## Default Value\\n\\n*Note*: This recommendation is applicable only for etcd clusters. If you are using only one etcd server in your environment then this recommendation is not applicable. By default, peer communication over TLS is not configured.\\n\\n## References\\n\\n1. [https://coreos.com/etcd/docs/latest/op-guide/security.html ][1]\\n2. [https://kubernetes.io/docs/admin/etcd/][2]\\n\\n## CIS Controls\\n\\nVersion 6.14.2 Encrypt All Sensitive Information Over Less-trusted Networks - All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7.14.4 Encrypt All Sensitive Information in Transit - Encrypt all sensitive information in transit.  \\n\\n[1]: https://coreos.com/etcd/docs/latest/op-guide/security.html \\n[2]: https://kubernetes.io/docs/admin/etcd/              \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599603941695,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-2.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"lzq-1mk-xc7\",\"isDefault\":true,\"name\":\"--peer-cert-file and --peer-key-file arguments are set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.5\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit `/etc/docker`.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should also audit all Docker related files and directories. The Docker daemon runs with root privilege and its behavior depends on some key files and directories, including `/etc/docker`. This holds various certificates and keys used for TLS communication between Docker daemon and Docker client and so it should be audited.\\n\\n## Remediation\\n\\nYou should add a rule for the `/etc/docker` directory. For example, add the following line to the `/etc/audit/audit.rules` file:\\n\\n```\\n-w /etc/docker -k docker \\n```\\n\\nThen restart the audit daemon:\\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7.14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604003342,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"5ns-uab-zcf\",\"isDefault\":true,\"name\":\"/etc/docker auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.16\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIPC (POSIX/SysV IPC) namespace provides separation of named shared memory segments, semaphores and message queues. The IPC namespace on the host should therefore not be shared with containers and should remain isolated.\\n\\n## Rationale\\n\\nThe IPC namespace provides separation of IPC between the host and containers. If the host's IPC namespace is shared with the container, it would allow processes within the container to see all of IPC communications on the host system. This would remove the benefit of IPC level isolation between host and containers. An attacker with access to a container could get access to the host at this level with major consequences. The IPC namespace should therefore not be shared between the host and its containers.\\n\\n## Remediation\\n\\nDo not start a container with the `--ipc=host` argument. For example, do not start a container with the command `docker run --interactive --tty --ipc=host centos /bin/bash`\\n\\n## Impact\\n\\nShared memory segments are used in order to accelerate interprocess communications, commonly in high-performance applications. If this type of application is containerized into multiple containers, you might need to share the IPC namespace of the containers in order to achieve high performance. Under these circumstances, you should still only share container specific IPC namespaces and not the host IPC namespace. A container's IPC namespace can be shared with another container. For example, `docker run --interactive --tty --ipc=container:e3a7a1a97c58 centos /bin/bash`\\n\\n## Default Value\\n\\nBy default, all containers have their IPC namespace enabled and host IPC namespace is not shared with any container.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/run/#ipc-settings-ipc\\n2. http://man7.org/linux/man-pages/man7/namespaces.7.html\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604030036,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.16\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"qpe-nj2-sl8\",\"isDefault\":true,\"name\":\"Host's IPC namespace is not shared\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.3.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDisable profiling, if not needed.\\n\\n## Rationale\\n\\nProfiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.\\n\\n## Remediation\\n\\nEdit the Controller Manager pod specification file `/etc/kubernetes/manifests/kube-controller-manager.yaml` on the master node and set the below parameter:\\n\\n```\\n--profiling=false\\n```\\n\\n## Impact\\n\\nProfiling information would not be available.\\n\\n## Default Value\\n\\nBy default, profiling is enabled.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-controller-manager/ ][1]\\n2. [https://github.com/kubernetes/community/blob/master/contributors/devel/profiling.md][2]\\n\\n## CIS Controls\\n\\nVersion 6.14 Controlled Access Based on the Need to Know\\n\\nVersion 7.4 Controlled Use of Administrative Privileges \\n\\n[1]: https://kubernetes.io/docs/admin/kube-controller-manager/ \\n[2]: https://github.com/kubernetes/community/blob/master/contributors/devel/profiling.md\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604031896,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.3.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"1ie-ddf-7wm\",\"isDefault\":true,\"name\":\"--profiling argument is set to false (Controller Manager)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.6\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the `/etc/docker` directory permissions are correctly set to 755 or more restrictively.\\n\\n## Rationale\\n\\nThe `/etc/docker` directory contains certificates and keys in addition to various sensitive files. It should therefore only be writeable by root to ensure that it can not be modified by a less privileged user.\\n\\n## Remediation\\n\\nRun the following command: `chmod 755 /etc/docker`\\n\\nThis sets the permissions for the directory to 755.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the permissions for this directory are set to 755.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604083943,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"een-7do-u18\",\"isDefault\":true,\"name\":\"/etc/docker directory permissions are set to 755 or more restrictively\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.30\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nSetup TLS connection on the API server.\\n\\n## Rationale\\n\\nAPI server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic.\\n\\n## Remediation\\n\\nFollow the Kubernetes documentation and set up the TLS connection on the apiserver. Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the TLS certificate and private key file parameters. --tls-cert-file=<path/to/tls-certificate-file> --tls-private-key-file=<path/to/tls-key-file>\\n\\n## Impact\\n\\nTLS and client certificate authentication must be configured for your Kubernetes cluster deployment.\\n\\n## Default Value\\n\\nBy default, --tls-cert-file and --tls-private-key-file arguments are not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ 3. https://github.com/kelseyhightower/docker-kubernetes-tls-guide\\n\\n## CIS Controls\\n\\nVersion 6 14.2 Encrypt All Sensitive Information Over Less-trusted Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. Version 7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604115727,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.30\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"m9r-8ka-arc\",\"isDefault\":true,\"name\":\"--tls-cert-file and --tls-private-key-file arguments are set as appropriate (API server)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.20\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:false\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that Kubernetes PKI certificate files have permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nKubernetes makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to 644 or more restrictive to protect their integrity.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chmod -R 644 /etc/kubernetes/pki/*.crt`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the certificates used by Kubernetes are set to have permissions of 644\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604147464,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.20\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ion-6fc-xd4\",\"isDefault\":true,\"name\":\"Kubernetes PKI certificate file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.5\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the scheduler pod specification file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe scheduler pod specification file controls various parameters that set the behavior of the Scheduler service in the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chmod 644 /etc/kubernetes/manifests/kube-scheduler.yaml`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `kube-scheduler.yaml` file has permissions of 640.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-scheduler/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604179189,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"qxe-hc6-qlm\",\"isDefault\":true,\"name\":\"Scheduler pod specification file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.1\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nConfigure TLS encryption for the etcd service.\\n\\n## Rationale\\n\\nEtcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit.\\n\\n## Remediation\\n\\nFollow the etcd service documentation and configure TLS encryption. Then, edit the etcd pod specification file /etc/kubernetes/manifests/etcd.yaml on the master node and set the below parameters:\\n\\n```\\n--cert-file=</path/to/ca-file> \\n--key-file=</path/to/key-file>\\n```\\n\\n## Impact\\n\\nClient connections only over TLS would be served.\\n\\n## Default Value\\n\\nBy default, TLS encryption is not set.\\n\\n## References\\n\\n1. [https://coreos.com/etcd/docs/latest/op-guide/security.html ][1]\\n2. [https://kubernetes.io/docs/admin/etcd/][2]\\n\\n## CIS Controls\\n\\nVersion 6.14.2 Encrypt All Sensitive Information Over Less-trusted Networks - All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7.14.4 Encrypt All Sensitive Information in Transit - Encrypt all sensitive information in transit.                \\n\\n[1]: https://coreos.com/etcd/docs/latest/op-guide/security.html \\n[2]: https://kubernetes.io/docs/admin/etcd/ \",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604210918,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-2.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ezf-1mn-luf\",\"isDefault\":true,\"name\":\"--cert-file and --key-file arguments are set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.26\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nSet global request timeout for API server requests as appropriate.\\n\\n## Rationale\\n\\nSetting global request timeout allows extending the API server request timeout limit to a duration appropriate to the user's connection speed. By default, it is set to 60 seconds which might be problematic on slower connections making cluster resources inaccessible once the data volume for requests exceeds what can be transmitted in 60 seconds. But, setting this timeout limit to be too large can exhaust the API server resources making it prone to Denial-of-Service attack. Hence, it is recommended to set this limit as appropriate and change the default limit of 60 seconds only if needed.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml and set the below parameter as appropriate and if needed. For example, --request-timeout=300s\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, --request-timeout is set to 60 seconds.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/pull/51415\\n\\n## CIS Controls\\n\\nVersion 6 14.6 Enforce Detailed Audit Logging For Sensitive Information Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. Version 7 14.9 Enforce Detail Logging for Access or Changes to Sensitive Data Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604242564,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.26\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"1kt-cbt-hvl\",\"isDefault\":true,\"name\":\"--request-timeout argument is set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.2.4\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not generally permit containers to be run with the hostNetwork flag set to true.\\n\\n## Rationale\\n\\nA container running in the host's network namespace could access the local loopback device, and could access network traffic to and from other pods. There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host network namespace. If you have need to run containers which require hostNetwork, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\\n\\n## Remediation\\n\\nCreate a PSP as described in the Kubernetes documentation, ensuring that the `.spec.hostNetwork` field is omitted or set to false.\\n\\n## Impact\\n\\nPods defined with spec.hostNetwork: true will not be permitted unless they are run under a specific PSP.\\n\\n## Default Value\\n\\nBy default, PodSecurityPolicies are not defined.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/concepts/policy/pod-security-policy][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.                \\n\\n[1]: https://kubernetes.io/docs/concepts/policy/pod-security-policy\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1599604274257,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-5.2.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"mlb-fwt-s80\",\"isDefault\":true,\"name\":\"Minimize the admission of containers wishing to share the host network namespace\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.3\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit all Docker daemon activities.\\n\\n## Rationale\\n\\nAs well as auditing the normal Linux file system and system calls, you should also audit the Docker daemon. Because this daemon runs with root privileges. It is very important to audit its activities and usage.\\n\\n## Remediation\\n\\nYou should add rules for the Docker daemon. For example, add the following line to the `/etc/audit/audit.rules` file: \\n\\n```\\n-w /usr/bin/dockerd -k docker \\n```\\n\\nThen restart the audit daemon using the following command:\\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, the Docker daemon is not audited.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n\\n## CIS Controls\\n\\nVersion 6.6.2 Ensure Audit Log Settings Support Appropriate Log Entry Formatting - Validate audit log settings for each hardware device and the software installed on it, ensuring that logs include a date, timestamp, source addresses, destination addresses, and various other useful elements of each packet and/or transaction. Systems should record logs in a standardized format such as syslog entries or those outlined by the Common Event Expression initiative. If systems cannot generate logs in a standardized format, log normalization tools can be deployed to convert logs into such a format. \\n\\nVersion 7.6.2 Activate audit logging - Ensure that local logging has been enabled on all systems and networking devices. \\n\\nVersion 6.3 Enable Detailed Logging - Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604305682,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"fpu-oe5-feu\",\"isDefault\":true,\"name\":\"Auditing is configured for the Docker daemon\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.25\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should restrict the container from acquiring additional privileges via SUID or SGID bits.\\n\\n## Rationale\\n\\nA process can set the `no_new_priv` bit in the kernel and this persists across forks, clones and execve. The `no_new_priv` bit ensures that the process and its child processes do not gain any additional privileges via SUID or SGID bits. This reduces the danger associated with many operations because the possibility of subverting privileged binaries is lessened.\\n\\n## Remediation\\n\\nStart your container with the options `docker run --rm -it --security-opt=no-new-privileges ubuntu bash`\\n\\n## Impact\\n\\nThe `no_new_priv` option prevents LSMs like SELinux from allowing processes to acquire new privileges.\\n\\n## Default Value\\n\\nBy default, new privileges are not restricted.\\n\\n## References\\n\\n1. https://github.com/projectatomic/atomic-site/issues/269\\n2. https://github.com/docker/docker/pull/20727\\n3. https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt\\n4. https://lwn.net/Articles/475678/\\n5. https://lwn.net/Articles/475362/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5 Controlled Use of Administration Privileges Controlled Use of Administration Privileges\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604337425,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.25\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"cft-3kh-z3l\",\"isDefault\":true,\"name\":\"Container is restricted from acquiring additional privileges\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.4\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDisable the read-only port.\\n\\n## Rationale\\n\\nThe Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster.\\n\\n## Remediation\\n\\nIf using a Kubelet config file, edit the file to set `readOnlyPort` to 0. If using command line arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and set the below parameter in `KUBELET_SYSTEM_PODS_ARGS` variable. \\n\\n`--read-only-port=0` \\n\\nBased on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nRemoval of the read-only port will require that any service which made use of it will need to be re-configured to use the main Kubelet API.\\n\\n## Default Value\\n\\nBy default, `--read-only-port` is set to 10255/TCP. However, if a config file is specified by `--config` the default value for `readOnlyPort` is 0.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/][1]\\n\\n## CIS Controls\\n\\nVersion 6.9.1 Limit Open Ports, Protocols, and Services - Ensure that only ports, protocols, and services with validated business needs are running on each system. \\n\\nVersion 7 9.2 Ensure Only Approved Ports, Protocols and Services Are Running - Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.                \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604369044,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"dgo-kog-lle\",\"isDefault\":true,\"name\":\"--read-only-port argument is set to 0\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.4\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIf kube-proxy is running, ensure that the file ownership of its kubeconfig file is set to root:root.\\n\\n## Rationale\\n\\nThe kubeconfig file for kube-proxy controls various parameters for the kube-proxy service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the each worker node:\\n\\n`chown root:root <proxy kubeconfig file>`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, proxy file ownership is set to root:root.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-proxy/][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.        \\n\\n[1]: https://kubernetes.io/docs/admin/kube-proxy/    \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604401268,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"oat-dei-klo\",\"isDefault\":true,\"name\":\"Proxy kubeconfig file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.1\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the kubelet service file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe kubelet service file controls various parameters that set the behavior of the kubelet service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the each worker node. \\n\\nFor example, `chmod 644 /etc/systemd/system/kubelet.service.d/10-kubeadm.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the kubelet service file has permissions of 640.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/ ][1]\\n2. [https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#44-joining-your-nodes ][2]\\n3. [https://kubernetes.io/docs/admin/kubeadm/#kubelet-drop-in][3]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.        \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/ \\n[2]: https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#44-joining-your-nodes \\n[3]: https://kubernetes.io/docs/admin/kubeadm/#kubelet-drop-in    \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":4,\"createdAt\":1599604432646,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"j8k-7ii-fwo\",\"isDefault\":true,\"name\":\"Kubelet service file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.5\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the `/etc/docker` directory ownership and group ownership is correctly set to root.\\n\\n## Rationale\\n\\nThe `/etc/docker` directory contains certificates and keys in addition to various other sensitive files. It should therefore be individual owned and group owned by root in order to ensure that it can not be modified by less privileged users.\\n\\n## Remediation\\n\\nTo resolve this issue, run the following command: `chown root:root /etc/docker`\\n\\nThis sets the ownership and group ownership for the directory to root.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the ownership and group ownership for this directory is correctly set to root.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.`\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604466531,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"heb-axz-wdc\",\"isDefault\":true,\"name\":\"/etc/docker directory ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.20\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the `/etc/sysconfig/docker` file individual ownership and group ownership is correctly set to root.\\n\\n## Rationale\\n\\nThe `/etc/sysconfig/docker` file contains sensitive parameters that may alter the behavior of the Docker daemon. It should therefore be individually owned and group owned by root to ensure that it is not modified by less privileged users.\\n\\n## Remediation\\n\\nRun the following command: `chown root:root /etc/sysconfig/docker`\\n\\nThis sets the ownership and group ownership for the file to root.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system, and in this case, this recommendation is not applicable.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/admin/configuring/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604498138,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.20\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"xrt-uiz-s7o\",\"isDefault\":true,\"name\":\"/etc/sysconfig/docker file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.15\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the `scheduler.conf` file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe `scheduler.conf` file is the kubeconfig file for the Scheduler. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chmod 644 /etc/kubernetes/scheduler.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `scheduler.conf` has permissions of 640.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604530000,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.15\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"fmc-m0d-pe5\",\"isDefault\":true,\"name\":\"scheduler.conf file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.9\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit `/etc/sysconfig/docker`, if applicable.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should also audit the Docker daemon. Because this daemon runs with root privileges, it is very important to audit its activities and usage. Its behavior depends on some key files and directories, including `/etc/sysconfig/docker`. It contains various parameters related to the Docker daemon when run on CentOS and RHEL based distributions. If present, it is important that it is audited.\\n\\n## Remediation\\n\\nYou should add a rule for `/etc/sysconfig/docker` file. For example, add the following line to the `/etc/audit/audit.rules` file:\\n\\n```\\n-w /etc/sysconfig/docker -k docker\\n```\\n\\nThen restart the audit daemon: \\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited. The file `/etc/sysconfig/docker` may not be present on the system and in that case, this recommendation is not applicable.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7.14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604561498,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.9\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ps6-vb4-bim\",\"isDefault\":true,\"name\":\"/etc/sysconfig/docker auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.1\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nBy default, all network traffic is allowed between containers on the same host on the default network bridge. You can restrict all inter-container communication and link specific containers together that require communication. Or, you can create a custom network and only join containers that need to communicate to that custom network.\\n\\n## Rationale\\n\\nBy default, unrestricted network traffic is enabled between all containers on the same host on the default network bridge. Each container has the potential of reading all packets across the container network on the same host. This might lead to an unintended and unwanted disclosure of information to other containers. Hence, restrict inter-container communication on the default network bridge.\\n\\n## Remediation\\n\\nEdit the Docker daemon configuration file to ensure that inter-container communication is disabled:\\n\\n```\\n\\\"icc\\\": false\\n```\\n\\nAlternatively, run the Docker daemon directly and pass `--icc=false` as an argument:\\n\\n```\\ndockerd --icc=false \\n```\\n\\nFollow the Docker documentation and create a custom network, and only join containers that need to communicate to that custom network. The `--icc` parameter only applies to the default docker bridge. If you use a custom network, adopt the segmenting networks approach instead.\\n\\n## Impact\\n\\nInter-container communication is disabled on the default network bridge. If any communication between containers on the same host is desired, it needs to be explicitly defined using container linking or custom networks.\\n\\n## Default Value\\n\\nBy default, all inter-container communication is allowed on the default network bridge.\\n\\n## References\\n\\n1. [https://docs.docker.com/engine/userguide/networking/][1]\\n2. [https://docs.docker.com/engine/userguide/networking/default_network/container-communication/#communication-between-containers][2]\\n\\n## CIS Controls\\n\\nNone                \\n\\n[1]: https://docs.docker.com/engine/userguide/networking/ \\n[2]: https://docs.docker.com/engine/userguide/networking/default_network/container-communication/#communication-between-containers\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604593277,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-2.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"dmd-zy3-5un\",\"isDefault\":true,\"name\":\"Network traffic is restricted between containers on the default bridge\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.16\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nReject creating pods that do not match Pod Security Policies.\\n\\n## Rationale\\n\\nA Pod Security Policy is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access. The PodSecurityPolicy objects define a set of conditions that a pod must run with in order to be accepted into the system. Pod Security Policies are comprised of settings and strategies that control the security features a pod has access to and hence this must be used to control pod access permissions. Note: When the PodSecurityPolicy admission plugin is in use, there needs to be at least one PodSecurityPolicy in place for ANY pods to be admitted. See section 1.7 for recommendations on PodSecurityPolicy settings.\\n\\n## Remediation\\n\\nFollow the documentation and create Pod Security Policy objects as per your environment. Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --enable-admission-plugins parameter to a value that includes PodSecurityPolicy: --enable-admission-plugins=...,PodSecurityPolicy,... Then restart the API Server.\\n\\n## Impact\\n\\nThe policy objects must be created and granted before pod creation would be allowed.\\n\\n## Default Value\\n\\nBy default, PodSecurityPolicy is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#podsecuritypolicy 3. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies\\n\\n## CIS Controls\\n\\nVersion 6 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know Version 7 4 Controlled Use of Administrative Privileges Controlled Use of Administrative Privileges                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604624793,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.16\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"vwz-aw9-c09\",\"isDefault\":true,\"name\":\"Admission control plugin PodSecurityPolicy is set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.4\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the file permissions on the docker.socket file are correctly set to 644 or more restrictively.\\n\\n## Rationale\\n\\nThe docker.socket file contains sensitive parameters that may alter the behavior of the Docker remote API. It should therefore be writeable only by root in order to ensure that it is not modified by less privileged users.\\n\\n## Remediation\\n\\n1. Find out the file location: `systemctl show -p FragmentPath docker.socket`\\n2. If the file does not exist, this recommendation is not applicable. If the file does exist, you should execute the command below, including the correct file path to set the file permissions to 644. For example, `chmod 644 /usr/lib/systemd/system/docker.socket`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system and in that case, this recommendation is not applicable. By default, if the file is present, the permissions should be set to 644 or more restrictively.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-to-another-hostport-or-a-unix-socket\\n2. https://github.com/YungSang/fedora-atomic-packer/blob/master/oem/docker.socket\\n3. http://daviddaeschler.com/2014/12/14/centos-7rhel-7-and-docker-containers-on-boot/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604656679,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"myf-zyh-89p\",\"isDefault\":true,\"name\":\"docker.socket file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.4\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDocker considers a private registry either secure or insecure. By default, registries are considered secure.\\n\\n## Rationale\\n\\nA secure registry uses TLS. A copy of the registry's CA certificate is placed on the Docker host in the `/etc/docker/certs.d/<registry-name>/` directory. An insecure registry is one which does not have a valid registry certificate, or one not not using TLS. You should not use insecure registries because they present a risk of traffic interception and modification. Additionally, once a registry has been marked as insecure, commands such as `docker pull`, `docker push`, and `docker search` will not result in an error message, and users may indefinitely be working with this type of insecure registry without ever being notified of the risk of potential compromise.\\n\\n## Remediation\\n\\nYou should ensure that no insecure registries are in use.\\n\\n## Impact\\n\\nNone.\\n\\n## Default Value\\n\\nBy default, Docker assumes all registries except local ones are secure.\\n\\n## References\\n\\n1. [https://docs.docker.com/registry/insecure/][1]\\n\\n## CIS Controls\\n\\nVersion 6.14.2 Encrypt All Sensitive Information Over Less-trusted Networks - All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7.14.4 Encrypt All Sensitive Information in Transit - Encrypt all sensitive information in transit.                \\n\\n[1]: https://docs.docker.com/registry/insecure/\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604688564,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-2.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"wki-o8r-1ha\",\"isDefault\":true,\"name\":\"Insecure registries are not used\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.14\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the `admin.conf` file ownership is set to root:root.\\n\\n## Rationale\\n\\nThe `admin.conf` file contains the admin credentials for the cluster. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chown root:root /etc/kubernetes/admin.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `admin.conf` file ownership is set to `root:root`.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kubeadm/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604720378,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.14\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"kcn-wwa-os0\",\"isDefault\":true,\"name\":\"admin.conf file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.19\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the `/etc/default/docker` file ownership and group-ownership is correctly set to root.\\n\\n## Rationale\\n\\nThe `/etc/default/docker` file contains sensitive parameters that may alter the behavior of the Docker daemon. It should therefore be individually owned and group owned by root to ensure that it cannot be modified by less privileged users.\\n\\n## Remediation\\n\\nExecute the following command: `chown root:root /etc/default/docker`\\n\\nThis sets the ownership and group ownership of the file to root.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system, and in this case, this recommendation is not applicable.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/admin/configuring/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604751728,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.19\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"o5w-d8y-ka1\",\"isDefault\":true,\"name\":\"/etc/default/docker file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.5\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the kubelet.conf file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe `kubelet.conf` file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun this command (based on the file location on your system) on the each worker node. For example, `chmod 644 /etc/kubernetes/kubelet.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `kubelet.conf` file has permissions of 640.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.                \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604783481,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"x88-8vs-ygw\",\"isDefault\":true,\"name\":\"kubelet.conf file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.5\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should not allow sensitive host system directories such as those listed below to be mounted as container volumes, especially in read-write mode. `/` `/boot` `/dev` `/etc` `/lib` `/proc` `/sys` `/usr`\\n\\n## Rationale\\n\\nIf sensitive directories are mounted in read-write mode, it is possible to make changes to files within them. This has obvious security implications and should be avoided.\\n\\n## Remediation\\n\\nDo not mount directories which are security sensitive on the host within containers, especially in read-write mode.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nDocker defaults to using a read-write volume but you can also mount a directory read-only. By default, no sensitive host directories are mounted within containers.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/tutorials/dockervolumes/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604814929,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"dmq-wqu-2im\",\"isDefault\":true,\"name\":\"Sensitive host system directories are not mounted on containers\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.28\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nExplicitly set a service account public key file for service accounts on the apiserver.\\n\\n## Rationale\\n\\nBy default, if no --service-account-key-file is specified to the apiserver, it uses the private key from the TLS serving certificate to verify service account tokens. To ensure that the keys for service account tokens could be rotated as needed, a separate public/private key pair should be used for signing service account tokens. Hence, the public key should be specified to the apiserver with --service-account-key-file.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --service-account-key-file parameter to the public key file for service accounts: --service-account-key-file=<filename>\\n\\n## Impact\\n\\nThe corresponding private key must be provided to the controller manager. You would need to securely maintain the key file and rotate the keys based on your organization's key rotation policy.\\n\\n## Default Value\\n\\nBy default, --service-account-key-file argument is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/issues/24167\\n\\n## CIS Controls\\n\\nVersion 6 3 Secure Configurations for Hardware and Software on Mobile Devices, Laptops, Workstations, and Servers Secure Configurations for Hardware and Software on Mobile Devices, Laptops, Workstations, and Servers Version 7 5 Secure Configuration for Hardware and Software on Mobile Devices, Laptops, Workstations and Servers Secure Configuration for Hardware and Software on Mobile Devices, Laptops, Workstations and Servers                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604846892,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.28\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"xtg-mzn-vft\",\"isDefault\":true,\"name\":\"--service-account-key-file argument is set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.30\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should not share the host's user namespaces with containers running on it.\\n\\n## Rationale\\n\\nUser namespaces ensure that a root process inside the container will be mapped to a non-root process outside the container. Sharing the user namespaces of the host with the container does not therefore isolate users on the host from users in the containers.\\n\\n## Remediation\\n\\nDo not share user namespaces between host and containers. For example, do not run the command `docker run --rm -it --userns=host ubuntu bash`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the host user namespace is shared with containers unless user namespace support is enabled.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/security/userns-remap/\\n2. https://docs.docker.com/engine/reference/commandline/run/#options\\n3. https://github.com/docker/docker/pull/12648\\n4. https://events.linuxfoundation.org/sites/events/files/slides/User%20Namespaces%20-%20ContainerCon%202015%20-%2016-9-final_0.pdf\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n12 Boundary Defense Boundary Defense\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604878282,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.30\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"e7c-uzf-jwy\",\"isDefault\":true,\"name\":\"Host's user namespaces are not shared\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.6\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should add the `HEALTHCHECK` instruction to your Docker container images in order to ensure that health checks are executed against running containers.\\n\\n## Rationale\\n\\nAn important security control is that of availability. Adding the `HEALTHCHECK` instruction to your container image ensures that the Docker engine periodically checks the running container instances against that instruction to ensure that containers are still operational. Based on the results of the health check, the Docker engine could terminate containers which are not responding correctly, and instantiate new ones.\\n\\n## Remediation\\n\\nYou should follow the Docker documentation and rebuild your container images to include the `HEALTHCHECK` instruction.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `HEALTHCHECK` is not set.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/builder/#healthcheck\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599604909942,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-4.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"5xs-afd-sfx\",\"isDefault\":true,\"name\":\"HEALTHCHECK instructions have been added to container images\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.7.4\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nKubernetes provides a default namespace, where objects are placed if no namespace is specified for them. Placing objects in this namespace makes application of RBAC and other controls more difficult.\\n\\n## Rationale\\n\\nResources in a Kubernetes cluster should be segregated by namespace, to allow for security controls to be applied at that level and to make it easier to manage resources.\\n\\n## Remediation\\n\\nEnsure that namespaces are created to allow for appropriate segregation of Kubernetes resources and that all new resources are created in a specific namespace.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nUnless a namespace is specific on object creation, the default namespace will be used.\\n\\n## References\\n\\nNone\\n\\n## CIS Controls\\n\\nNone                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1599604941259,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-5.7.4\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"gly-1rp-obv\",\"isDefault\":true,\"name\":\"The default namespace should not be used\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.21\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nSeccomp filtering provides a means for a process to specify a filter for incoming system calls. The default Docker seccomp profile works on a whitelist basis and allows for a large number of common system calls, whilst blocking all others. This filtering should not be disabled unless it causes a problem with your container application usage.\\n\\n## Rationale\\n\\nA large number of system calls are exposed to every userland process with many of them going unused for the entire lifetime of the process. Most of applications do not need all these system calls and would therefore benefit from having a reduced set of available system calls. Having a reduced set of system calls reduces the total kernel surface exposed to the application and thus improvises application security.\\n\\n## Remediation\\n\\nBy default, seccomp profiles are enabled. You do not need to do anything unless you want to modify and use a modified seccomp profile.\\n\\n## Impact\\n\\nWith Docker 1.10 and greater, the default seccomp profile blocks syscalls, regardless of `--cap-add passed` to the container. You should create your own custom seccomp profile in such cases. You can also disable the default seccomp profile by passing `--security-opt=seccomp:unconfined` on docker run.\\n\\n## Default Value\\n\\nWhen you run a container, it uses the default profile unless you override it with the `--security-opt` option.\\n\\n## References\\n\\n1. http://blog.scalock.com/new-docker-security-features-and-what-they-mean-seccomp-profiles\\n2. https://docs.docker.com/engine/reference/run/#security-configuration\\n3. https://github.com/docker/docker/blob/master/profiles/seccomp/default.json\\n4. https://docs.docker.com/engine/security/seccomp/\\n5. https://www.kernel.org/doc/Documentation/prctl/seccomp_filter.txt\\n6. https://github.com/docker/docker/issues/22870\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":4,\"createdAt\":1599604972925,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.21\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"hub-v5u-cw0\",\"isDefault\":true,\"name\":\"Default seccomp profile is not Disabled\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.7\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAllow Kubelet to manage `iptables`.\\n\\n## Rationale\\n\\nKubelets can automatically manage the required changes to `iptables` based on how you choose your networking options for the pods. It is recommended to let kubelets manage the changes to `iptables`. This ensures that the `iptables` configuration remains in sync with pods networking configuration. Manually configuring `iptables` with dynamic pod network configuration changes might hamper the communication between pods/containers and to the outside world. You might have `iptables` rules too restrictive or too open.\\n\\n## Remediation\\n\\nIf using a kubelet config file, edit the file to set `makeIPTablesUtilChains: true`. If using command line arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and remove the `--make-iptables-util-chains` argument from the `KUBELET_SYSTEM_PODS_ARGS` variable. Based on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nKubelet would manage the `iptables` on the system and keep it in sync. If you are using any other `iptables` management solution, then there might be some conflicts.\\n\\n## Default Value\\n\\nBy default, `--make-iptables-util-chains argument` is set to true.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/][1]\\n\\n## CIS Controls\\n\\nVersion 6.9 Limitation and Control of Network Ports, Protocols, and Services\\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605004390,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.7\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"f3g-zcg-jm0\",\"isDefault\":true,\"name\":\"--make-iptables-util-chains argument is set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.2\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nSELinux is an effective and easy-to-use Linux application security system. It is available by default on some distributions such as Red Hat and Fedora.\\n\\n## Rationale\\n\\nSELinux provides a Mandatory Access Control (MAC) system that greatly augments the default Discretionary Access Control (DAC) model. You can therefore add an extra layer of safety to your containers by enabling SELinux on your Linux host.\\n\\n## Remediation\\n\\nIf SELinux is applicable for your Linux OS, you should use it.\\n\\n1. Set the SELinux State.\\n2. Set the SELinux Policy.\\n3. Create or import a SELinux policy template for Docker containers.\\n4. Start Docker in daemon mode with SELinux enabled. For example: `docker daemon --selinux-enabled`\\n5. Start your Docker container using the security options. For example, `docker run --interactive --tty --security-opt label=level:TopSecret centos /bin/bash`\\n\\n## Impact\\n\\nAny restrictions defined in the SELinux policy will be applied to your containers. It should be noted that if your SELinux policy is misconfigured, this may have an impact on the correct operation of the affected containers.\\n\\n## Default Value\\n\\nBy default, no SELinux security options are applied on containers.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/security/security/#other-kernel-security-features\\n2. https://docs.docker.com/engine/reference/run/#security-configuration\\n3. http://docs.fedoraproject.org/en-US/Fedora/13/html/Security-Enhanced_Linux/\\n4. https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux_atomic_host/7/html/container_security_guide/docker_selinux_security_policy\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605036108,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"eww-c9f-0hf\",\"isDefault\":true,\"name\":\"SELinux security options are set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.26\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIf the container image does not have an HEALTHCHECK instruction defined, you should use the `--health-cmd` parameter at container runtime to check container health.\\n\\n## Rationale\\n\\nIf the container image you are using does not have a pre-defined HEALTHCHECK instruction, use the `--health-cmd` parameter to check container health at runtime. Based on the reported health status, remedial actions can be taken if necessary.\\n\\n## Remediation\\n\\nYou should run the container using the `--health-cmd` parameter. For example, `docker run -d --health-cmd='stat /etc/passwd || exit 1' nginx`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, health checks are not carried out at container runtime.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/run/#healthcheck\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605067593,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.26\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ojg-sb1-nso\",\"isDefault\":true,\"name\":\"Container health is checked at runtime\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.5\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEtcd should be configured for peer authentication.\\n\\n## Rationale\\n\\nEtcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster.\\n\\n## Remediation\\n\\nEdit the etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` on the master node and set the below parameter:\\n\\n```\\n--peer-client-cert-auth=true\\n```\\n\\n## Impact\\n\\nAll peers attempting to communicate with the etcd server will require a valid client certificate for authentication.\\n\\n## Default Value\\n\\n*Note*: This recommendation is applicable only for etcd clusters. If you are using only one etcd server in your environment then this recommendation is not applicable. By default, `--peer-client-cert-auth` argument is set to false.\\n\\n## References\\n\\n1. https://coreos.com/etcd/docs/latest/op-guide/security.html \\n2. https://kubernetes.io/docs/admin/etcd/ \\n3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#peer-client-cert-auth\\n\\n## CIS Controls\\n\\nVersion 6.14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. \\n\\nVersion 7.14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.                \\n\\n[1]: https://coreos.com/etcd/docs/latest/op-guide/security.html \\n[2]: https://kubernetes.io/docs/admin/etcd/ \\n[3]: https://coreos.com/etcd/docs/latest/op-guide/configuration.html#peer-client-cert-auth\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605099307,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-2.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"l01-5y2-miz\",\"isDefault\":true,\"name\":\"--peer-client-cert-auth argument is set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nContainers should run as a non-root user.\\n\\n## Rationale\\n\\nIt is good practice to run the container as a non-root user, where possible. This can be done either via the USER directive in the Dockerfile or through [gosu][1] or similar where used as part of the CMD or ENTRYPOINT directives.\\n\\n## Remediation\\n\\nEnsure that the Dockerfile for each container image contains `USER <username or ID>`\\n\\nIn this case, the user name or ID refers to the user that was found in the container base image. If there is no specific user created in the container base image, then make use of the `useradd` command to add a specific user before the USER instruction in the Dockerfile. \\n\\nFor example, add the below lines in the Dockerfile to create a user in the container:\\n`RUN useradd -d /home/username -m -s /bin/bash username USER username`\\n\\n**Note**: If there are users in the image that are not needed, you should consider deleting them. After deleting those users, commit the image and then generate new instances of the containers. Alternatively, if it is not possible to set the USER directive in the Dockerfile, a script running as part of the CMD or ENTRYPOINT sections of the Dockerfile should be used to ensure that the container process switches to a non-root user.\\n\\n## Impact\\n\\nRunning as a non-root user can present challenges where you wish to bind mount volumes from the underlying host. In this case, care should be taken to ensure that the user running the contained process can read and write to the bound directory, according to their requirements.\\n\\n## Default Value\\n\\nBy default, containers are run with root privileges and also run as the root user inside the container.\\n\\n## References\\n\\n1. https://github.com/docker/docker/issues/2918\\n2. https://github.com/docker/docker/pull/4572\\n3. https://github.com/docker/docker/issues/7906\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n[1]: https://github.com/tianon/gosu\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605130883,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-4.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"iml-sbn-bao\",\"isDefault\":true,\"name\":\"A user for the container has been created\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.3.6\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnable kubelet server certificate rotation on controller-manager.\\n\\n## Rationale\\n\\n`RotateKubeletServerCertificate` causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad. \\n\\n*Note*: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.\\n\\n## Remediation\\n\\nEdit the Controller Manager pod specification file `/etc/kubernetes/manifests/kube-controller-manager.yaml` on the master node and set the `--feature-gates` parameter to include `RotateKubeletServerCertificate=true`. \\n\\n```\\n--feature-gates=RotateKubeletServerCe`rtificate=true\\n```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `RotateKubeletServerCertificate` is not set.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet-tls-bootstrapping/#approval-controller ][1]\\n2. [https://github.com/kubernetes/features/issues/267 ][2]\\n3. [https://github.com/kubernetes/kubernetes/pull/45059 ][3]\\n4. [https://kubernetes.io/docs/admin/kube-controller-manager/][4]\\n\\n## CIS Controls\\n\\nVersion 6 14.2 Encrypt All Sensitive Information Over Less-trusted Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.               \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet-tls-bootstrapping/#approval-controller \\n[2]: https://github.com/kubernetes/features/issues/267 \\n[3]: https://github.com/kubernetes/kubernetes/pull/45059 \\n[4]: https://kubernetes.io/docs/admin/kube-controller-manager/\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605162809,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.3.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"asw-6hh-yc2\",\"isDefault\":true,\"name\":\"RotateKubeletServerCertificate argument is set to true (Controller Manager)\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the kubelet service file ownership is set to root:root.\\n\\n## Rationale\\n\\nThe kubelet service file controls various parameters that set the behavior of the kubelet service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the each worker node. \\n\\nFor example, `chown root:root /etc/systemd/system/kubelet.service.d/10-kubeadm.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, kubelet service file ownership is set to root:root.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/ ][1]\\n2. [https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#44-joining-your-nodes ][2]\\n3. [https://kubernetes.io/docs/admin/kubeadm/#kubelet-drop-in][3]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.                \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/ \\n[2]: https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#44-joining-your-nodes \\n[3]: https://kubernetes.io/docs/admin/kubeadm/#kubelet-drop-in\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605194356,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"sy4-z1k-udc\",\"isDefault\":true,\"name\":\"Kubelet service file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.8\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that all the registry certificate files, usually found under `/etc/docker/certs.d/<registry-name> directory`, have permissions of 444 or are set more restrictively.\\n\\n## Rationale\\n\\nThe `/etc/docker/certs.d/<registry-name>` directory contains Docker registry certificates. These certificate files must have permissions of 444or more restrictive permissions in order to ensure that unprivileged users do not have full access to them..\\n\\n## Remediation\\n\\nRun the following command: `chmod 444 /etc/docker/certs.d/<registry-name>/*`\\n\\nThis sets the permissions for the registry certificate files to 444.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the permissions for registry certificate files might not be 444. The default file permissions are governed by the system or user specific umask values which are defined within the operating system itself.\\n\\n## References\\n\\n1. https://docs.docker.com/registry/insecure/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605226177,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.8\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"sjq-1m3-njp\",\"isDefault\":true,\"name\":\"Registry certificate file permissions are set to 444 or more restrictively\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.9\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nTurn on Role Based Access Control.\\n\\n## Rationale\\n\\nRole Based Access Control (RBAC) allows fine-grained control over the operations that different entities can perform on different objects in the cluster. It is recommended to use the RBAC authorization mode.\\n\\n## Remediation\\n\\nEdit the API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml` on the master node and set the `--authorization-mode` parameter to a value that includes RBAC, for example: `--authorization-mode=Node,RBAC`\\n\\n## Impact\\n\\nWhen RBAC is enabled you will need to ensure that appropriate RBAC settings (including Roles, RoleBindings and ClusterRoleBindings) are configured to allow appropriate access.\\n\\n## Default Value\\n\\nBy default, RBAC authorization is not enabled.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/reference/access-authn-authz/rbac/][1]\\n\\n## CIS Controls\\n\\nVersion 6.9.1 Limit Open Ports, Protocols, and Services - Ensure that only ports, protocols, and services with validated business needs are running on each system. \\n\\nVersion 7.9.2 Ensure Only Approved Ports, Protocols and Services Are Running - Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.                \\n\\n[1]: https://kubernetes.io/docs/reference/access-authn-authz/rbac/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605257601,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.9\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"bn4-mzo-nyg\",\"isDefault\":true,\"name\":\"--authorization-mode argument includes RBAC\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.18\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the controller-manager.conf file ownership is set to `root:root`.\\n\\n## Rationale\\n\\nThe controller-manager.conf file is the kubeconfig file for the Controller Manager. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chown root:root /etc/kubernetes/controller-manager.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `controller-manager.conf` file ownership is set to `root:root`.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-controller-manager/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605289575,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.18\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"bud-aya-umc\",\"isDefault\":true,\"name\":\"controller-manager.conf file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.3\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the docker.socket file ownership and group ownership are correctly set to root.\\n\\n## Rationale\\n\\nThe docker.socket file contains sensitive parameters that may alter the behavior of the Docker remote API. For this reason, it should be owned and group owned by root in order to ensure that it is not modified by less privileged users.\\n\\n## Remediation\\n\\n1. Find out the file location: `systemctl show -p FragmentPath docker.socket`\\n2. If the file does not exist, this recommendation is not applicable. If the file exists, execute the command below, including the correct file path to set the ownership and group ownership for the file to root. For example, `chown root:root /usr/lib/systemd/system/docker.socket`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nThis file may not be present on the system. In that case, this recommendation is not applicable. By default, if the file is present, the ownership and group ownership for it should be set to root.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option 2. https://github.com/docker/docker-ce/blob/master/components/packaging/deb/systemd/docker.socket\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605321060,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"vc0-12t-fpa\",\"isDefault\":true,\"name\":\"docker.socket file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.11\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnable kubelet client certificate rotation.\\n\\n## Rationale\\n\\nThe `--rotate-certificates` setting causes the kubelet to rotate its client certificates by creating new CSRs as its existing credentials expire. This automated periodic rotation ensures that the there is no downtime due to expired certificates and thus addressing availability in the CIA security triad. \\n\\n*Note*: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself. \\n\\n*Note*: This feature also requires the `RotateKubeletClientCertificate` feature gate to be enabled (which is the default since Kubernetes v1.7)\\n\\n## Remediation\\n\\nIf using a Kubelet config file, edit the file to add the line `rotateCertificates: true` or remove it altogether to use the default value. If using command line arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and remove the `--rotate-certificates=false` argument from the `KUBELET_CERTIFICATE_ARGS` variable. Based on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, kubelet client certificate rotation is enabled.\\n\\n## References\\n\\n1. [https://github.com/kubernetes/kubernetes/pull/41912 ][1]\\n2. [https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#kubelet-configuration ][2]\\n3. [https://kubernetes.io/docs/imported/release/notes/ ][3]\\n4. [https://kubernetes.io/docs/reference/command-line-tools-reference/feature-gates/][4]\\n\\n## CIS Controls\\n\\nVersion 6.14.2 Encrypt All Sensitive Information Over Less-trusted - Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. \\n\\nVersion 7.14.4 Encrypt All Sensitive Information in Transit - Encrypt all sensitive information in transit.   \\n\\n[1]: https://github.com/kubernetes/kubernetes/pull/41912 \\n[2]: https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#kubelet-configuration \\n[3]: https://kubernetes.io/docs/imported/release/notes/ \\n[4]: https://kubernetes.io/docs/reference/command-line-tools-reference/feature-gates/             \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":4,\"createdAt\":1599605353070,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.11\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"9x3-sy5-pte\",\"isDefault\":true,\"name\":\"--rotate-certificates argument is not set to false\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.13\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the `admin.conf` file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe admin.conf is the administrator kubeconfig file defining various settings for the administration of the cluster. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chmod 644 /etc/kubernetes/admin.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, admin.conf has permissions of 640.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":4,\"createdAt\":1599605384539,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.13\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"zlc-pqm-t1x\",\"isDefault\":true,\"name\":\"admin.conf file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.9\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that if the kubelet refers to a configuration file with the `--config` argument, that file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe kubelet reads various parameters, including security settings, from a config file specified by the `--config` argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the following command (using the config file location identied in the Audit step):\\n\\n```\\nchmod 644 /var/lib/kubelet/config.yaml\\n```\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the `/var/lib/kubelet/config.yaml` file as set up by kubeadm has permissions of 644.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.                \\n\\n[1]: https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605416397,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.9\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"tc4-kmy-wlt\",\"isDefault\":true,\"name\":\"Kubelet configuration file has permissions set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.15\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nReject creating objects in a namespace that is undergoing termination.\\n\\n## Rationale\\n\\nSetting admission control policy to NamespaceLifecycle ensures that objects cannot be created in non-existent namespaces, and that namespaces undergoing termination are not used for creating the new objects. This is recommended to enforce the integrity of the namespace termination process and also for the availability of the newer objects.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --disable-admission-plugins parameter to ensure it does not include NamespaceLifecycle.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, NamespaceLifecycle is set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#namespacelifecycle\\n\\n## CIS Controls\\n\\nVersion 6 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know Version 7 4 Controlled Use of Administrative Privileges Controlled Use of Administrative Privileges                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605447784,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.15\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"elk-zj3-p6m\",\"isDefault\":true,\"name\":\"Admission control plugin NamespaceLifecycle is set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not use basic authentication.\\n\\n## Rationale\\n\\nBasic authentication uses plaintext credentials for authentication. Currently, the basic authentication credentials last indefinitely, and the password cannot be changed without restarting the API server. The basic authentication is currently supported for convenience. Hence, basic authentication should not be used.\\n\\n## Remediation\\n\\nFollow the documentation and configure alternate mechanisms for authentication. Then, edit the API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml` on the master node and remove the `--basic-auth-file=<filename>` parameter.\\n\\n## Impact\\n\\nYou will have to configure and use alternate authentication mechanisms such as tokens and certificates. Username and password for basic authentication could no longer be used.\\n\\n## Default Value\\n\\nBy default, basic authentication is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n2. https://kubernetes.io/docs/admin/authentication/#static-password-file\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n16.14 Encrypt/Hash All Authentication Files And Monitor Their Access - Verify that all authentication files are encrypted or hashed and that these files cannot be accessed without root or administrator privileges. Audit all access to password files in the system.\\n\\nVersion 7\\n\\n16.4 Encrypt or Hash all Authentication Credentials - Encrypt or hash with a salt all authentication credentials when stored.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605479472,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"oug-uvq-sti\",\"isDefault\":true,\"name\":\"--basic-auth-file argument is not set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.9\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nWhen the networking mode on a container is set to `--net=host`, the container is not placed inside a separate network stack. Effectively, applying this option instructs Docker to not containerize the container's networking. The consequence of this is that the container lives \\\"outside\\\" in the main Docker host and has full access to its network interfaces.\\n\\n## Rationale\\n\\nSelecting this option is potentially dangerous. It allows the container process to open reserved low numbered ports in the way that any other root process can. It also allows the container to access network services such as D-bus on the Docker host. A container process could potentially carry out undesired actions, such as shutting down the Docker host. This option should not be used unless there is a very specific reason for enabling it.\\n\\n## Remediation\\n\\nYou should not pass the --net=host option when starting any container.\\n\\n## Impact\\n\\nNone.\\n\\n## Default Value\\n\\nBy default, containers connect to the Docker bridge when starting and do not run in the context of the host's network stack.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/userguide/networking/ 2. https://docs.docker.com/engine/reference/run/#network-settings\\n\\n## CIS Controls\\n\\nVersion 6 12 Boundary Defense Boundary Defense                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605510860,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.9\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"1qj-oqa-jau\",\"isDefault\":true,\"name\":\"Host's network namespace is not shared\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.24\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nRetain 10 or an appropriate number of old log files.\\n\\n## Rationale\\n\\nKubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. For example, if you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --audit-log-maxbackup parameter to 10 or to an appropriate value. --audit-log-maxbackup=10\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, auditing is not enabled.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22\\n\\n## CIS Controls\\n\\nVersion 6 6.3 Ensure Audit Logging Systems Are Not Subject To Loss (i.e. rotation/archive) Ensure that all systems that store logs have adequate storage space for the logs generated on a regular basis, so that log files will not fill up between log rotation intervals. The logs must be archived and digitally signed on a periodic basis. Version 7 6.4 Ensure adequate storage for logs Ensure that all systems that store logs have adequate storage space for the logs generated.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605542630,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.24\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"r0g-aai-2xf\",\"isDefault\":true,\"name\":\"--audit-log-maxbackup argument is set to 10 or as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.15\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the Docker socket file is owned by root and group owned by docker.\\n\\n## Rationale\\n\\nThe Docker daemon runs as root. The default Unix socket therefore must be owned by root. If any other user or process owns this socket, it might be possible for that non-privileged user or process to interact with the Docker daemon. Additionally, in this case a non-privileged user or process might be able to interact with containers which is neither a secure nor desired behavior. Additionally, the Docker installer creates a Unix group called docker. You can add users to this group, and in this case, those users would be able to read and write to the default Docker Unix socket. The membership of the docker group is tightly controlled by the system administrator. However, ff any other group owns this socket, then it might be possible for members of that group to interact with the Docker daemon. Such a group might not be as tightly controlled as the docker group. Again, this is not in line with good security practice. For these reason, the default Docker Unix socket file should be owned by root and group owned by docker to maintain the integrity of the socket file.\\n\\n## Remediation\\n\\nRun the following command: `chown root:docker /var/run/docker.sock`\\n\\nThis sets the ownership to root and group ownership to docker for the default Docker socket file.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the ownership and group ownership for the Docker socket file is correctly set to root:docker.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option\\n2. https://docs.docker.com/engine/reference/commandline/dockerd/#bind-docker-to-another-hostport-or-a-unix-socket\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605574088,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.15\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ysh-lkt-poz\",\"isDefault\":true,\"name\":\"Docker socket file ownership is set to root:docker\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.1.7\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that the `/etc/kubernetes/manifests/etcd.yaml` file has permissions of 644 or more restrictive.\\n\\n## Rationale\\n\\nThe etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` controls various parameters that set the behavior of the etcd service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\\n\\n## Remediation\\n\\nRun the below command (based on the file location on your system) on the master node. For example, `chmod 644 /etc/kubernetes/manifests/etcd.yaml`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, `/etc/kubernetes/manifests/etcd.yaml` file has permissions of 640.\\n\\n## References\\n\\n1. https://coreos.com/etcd\\n2. https://kubernetes.io/docs/admin/etcd/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\nVersion 7\\n\\n5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605605880,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.1.7\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"vqc-dps-6tp\",\"isDefault\":true,\"name\":\"etcd pod specification file permissions are set to 644 or more restrictive\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.11\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit `/usr/bin/containerd`, if applicable.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should audit all Docker related files and directories. The Docker daemon runs with root privileges and its behavior depends on some key files and directories, including `/usr/bin/containerd`, so it should be audited.\\n\\n## Remediation\\n\\nYou should add a rule for the `/usr/bin/containerd` file. For example, add the following line to the `/etc/audit/audit.rules` file:\\n\\n```\\n-w /usr/bin/containerd -k docker \\n```\\n\\nThen restart the audit daemon: \\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited. The file `/usr/bin/containerd` may not be present on the system and in that case, this recommendation is not applicable.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n2. [https://github.com/docker/docker/pull/20662][2]\\n3. [https://containerd.tools/][3]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7.14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html \\n[2]: https://github.com/docker/docker/pull/20662 \\n[3]: https://containerd.tools/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605637503,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.11\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"tor-6yx-oyz\",\"isDefault\":true,\"name\":\"/usr/bin/containerd auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.32\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\netcd should be configured to make use of TLS encryption for client connections.\\n\\n## Rationale\\n\\netcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a SSL Certificate Authority file.\\n\\n## Remediation\\n\\nFollow the Kubernetes documentation and set up the TLS connection between the apiserver and etcd. Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the etcd certificate authority file parameter. --etcd-cafile=<path/to/ca-file>\\n\\n## Impact\\n\\nTLS and client certificate authentication must be configured for etcd.\\n\\n## Default Value\\n\\nBy default, --etcd-cafile is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://coreos.com/etcd/docs/latest/op-guide/security.html\\n\\n## CIS Controls\\n\\nVersion 6 14.2 Encrypt All Sensitive Information Over Less-trusted Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. Version 7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605669411,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.32\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"o8k-9hv-rri\",\"isDefault\":true,\"name\":\"--etcd-cafile argument is set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.23\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nRetain the logs for at least 30 days or as appropriate.\\n\\n## Rationale\\n\\nRetaining logs for at least 30 days ensures that you can go back in time and investigate or correlate any events. Set your audit log retention period to 30 days or as per your business requirements.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the --audit-log-maxage parameter to 30 or as an appropriate number of days: --audit-log-maxage=30\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, auditing is not enabled.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22\\n\\n## CIS Controls\\n\\nVersion 6 6.3 Ensure Audit Logging Systems Are Not Subject To Loss (i.e. rotation/archive) Ensure that all systems that store logs have adequate storage space for the logs generated on a regular basis, so that log files will not fill up between log rotation intervals. The logs must be archived and digitally signed on a periodic basis. Version 7 6.4 Ensure adequate storage for logs Ensure that all systems that store logs have adequate storage space for the logs generated.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605700813,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.23\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"jbu-o8v-pku\",\"isDefault\":true,\"name\":\"--audit-log-maxage argument is set to 30 or as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.5\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnable certificate based kubelet authentication.\\n\\n## Rationale\\n\\nThe apiserver, by default, does not authenticate itself to the kubelet's HTTPS endpoints. The requests from the apiserver are treated anonymously. You should set up certificate-based kubelet authentication to ensure that the apiserver authenticates itself to kubelets when submitting requests.\\n\\n## Remediation\\n\\nFollow the Kubernetes documentation and set up the TLS connection between the apiserver and kubelets. Then, edit API server pod specification file `/etc/kubernetes/manifests/kube-apiserver.yaml` on the master node and set the kubelet client certificate and key parameters as below. \\n\\n```\\n--kubelet-client-certificate=<path/to/client-certificate-file> \\n--kubelet-client-key=<path/to/client-key-file>\\n```\\n\\n## Impact\\n\\nYou require TLS to be configured on apiserver as well as kubelets.\\n\\n## Default Value\\n\\nBy default, certificate-based kubelet authentication is not set.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kube-apiserver/ ][1]\\n2. [https://kubernetes.io/docs/admin/kubelet-authentication-authorization/ ][2]\\n3. [https://kubernetes.io/docs/concepts/cluster-administration/master-node-communication/#apiserver---kubelet][3]\\n\\n## CIS Controls\\n\\nVersion 6.3.4 Use Only Secure Channels For Remote System Administration - Perform all remote administration of servers, workstation, network devices, and similar equipment over secure channels. Protocols such as telnet, VNC, RDP, or others that do not actively support strong encryption should only be used if they are performed over a secondary encryption channel, such as SSL, TLS or IPSEC. \\n\\nVersion 7.4.5 Use Multifactor Authentication For All Administrative Access - Use multi-factor authentication and encrypted channels for all administrative account access. \\n\\n[1]: https://kubernetes.io/docs/admin/kube-apiserver/ \\n[2]: https://kubernetes.io/docs/admin/kubelet-authentication-authorization/ \\n[3]: https://kubernetes.io/docs/concepts/cluster-administration/master-node-communication/#apiserver---kubelet\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605732980,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ruj-lze-13b\",\"isDefault\":true,\"name\":\"--kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.6\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAudit the `docker.service` if applicable.\\n\\n## Rationale\\n\\nAs well as auditing Linux file system and system calls, you should also audit all Docker related files and directories. The Docker daemon runs with root privileges and its behavior depends on some key files and directories, including `docker.service`. The `docker.service` file might be present if the daemon parameters have been changed by an administrator. If so, it holds various parameters for the Docker daemon and should be audited.\\n\\n## Remediation\\n\\nIf the file exists, a rule for it should be added. For example, add the following line to the `/etc/audit/audit.rules` file: \\n```\\n-w /usr/lib/systemd/system/docker.service -k docker \\n```\\n\\nThen restart the audit daemon: \\n\\n```\\nservice auditd restart\\n```\\n\\n## Impact\\n\\nAuditing can generate large log files. You should ensure that these are rotated and archived periodically. A separate partition should also be created for audit logs to avoid filling up any other critical partition.\\n\\n## Default Value\\n\\nBy default, Docker related files and directories are not audited. The file `docker.service` may not be present on the system.\\n\\n## References\\n\\n1. [https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html][1]\\n\\n## CIS Controls\\n\\nVersion 6.14.6 Enforce Detailed Audit Logging For Sensitive Information - Enforce detailed audit logging for access to nonpublic data and special authentication for sensitive data. \\n\\nVersion 7.14.9 Enforce Detail Logging for Access or Changes to Sensitive Data - Enforce detailed audit logging for access to sensitive data or changes to sensitive data (utilizing tools such as File Integrity Monitoring or Security Information and Event Monitoring).                \\n\\n[1]: https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605764788,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"myy-dsj-omk\",\"isDefault\":true,\"name\":\"docker.service auditing is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.19\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not bind to insecure port.\\n\\n## Rationale\\n\\nSetting up the apiserver to serve on an insecure port would allow unauthenticated and unencrypted access to your master node. This would allow attackers who could access this port, to easily take control of the cluster.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the below parameter. --insecure-port=0\\n\\n## Impact\\n\\nAll components that use the API must connect via the secured port, authenticate themselves, and be authorized to use the API. This includes: kube-controller-manager kube-proxy kube-scheduler kubelets\\n\\n## Default Value\\n\\nBy default, the insecure port is set to 8080.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6 9.1 Limit Open Ports, Protocols, and Services Ensure that only ports, protocols, and services with validated business needs are running on each system. Version 7 9.2 Ensure Only Approved Ports, Protocols and Services Are Running Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605796539,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.19\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"2ci-yqv-wv0\",\"isDefault\":true,\"name\":\"--insecure-port argument is set to 0\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.1.10\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnsure that if the kubelet refers to a configuration file with the --config argument, that file is owned by root:root.\\n\\n## Rationale\\n\\nThe kubelet reads various parameters, including security settings, from a config file specified by the --config argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be owned by root:root.\\n\\n## Remediation\\n\\nRun the following command (using the config file location identied in the Audit step): `chown root:root /etc/kubernetes/kubelet.conf`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, /var/lib/kubelet/config.yaml file as set up by kubeadm is owned by root:root.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/][1]\\n\\n## CIS Controls\\n\\nVersion 6.5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior. \\n\\nVersion 7.5.2 Maintain Secure Images - Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates.             \\n\\n[1]: https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605828233,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.1.10\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ptl-pla-t0c\",\"isDefault\":true,\"name\":\"Kubelet configuration file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.10\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nBy default, all containers on a Docker host share resources equally. By using the resource management capabilities of the Docker host, you can control the amount of memory that a container is able to use.\\n\\n## Rationale\\n\\nBy default a container can use all of the memory on the host. You can use memory limit mechanisms to prevent a denial of service occurring where one container consumes all of the hosts resources and other containers on the same host are therefore not able to function. Having no limit on memory usage can lead to issues where one container can easily make the whole system unstable and as a result unusable.\\n\\n## Remediation\\n\\nYou should run the container with only as much memory as it requires by using the `--memory argument`. For example, you could run a container using the command `docker run --interactive --tty --memory 256m centos /bin/bash`\\n\\nIn this example, the container is started with a memory limit of 256 MB. Note that the output of the command below returns values in scientific notation if memory limits are in place. `docker inspect --format='{{.Config.Memory}}' 7c5a2d4c7fe0`\\n\\nFor example, if the memory limit is set to 256 MB for a container instance, the output of the command above would be `2.68435456e+08` and NOT `256m`. You should convert this value using a scientific calculator.\\n\\n## Impact\\n\\nIf correct memory limits are not set on each container, one process can expand its usage and cause other containers to run out of resources.\\n\\n## Default Value\\n\\nBy default, all containers on a Docker host share their resources equally and no memory limits are enforced.\\n\\n## References\\n\\n1. https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/\\n2. https://docs.docker.com/engine/reference/commandline/run/#options\\n3. https://docs.docker.com/engine/admin/runmetrics/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605860081,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.10\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"ecn-mmt-tqe\",\"isDefault\":true,\"name\":\"Memory usage for containers is limited\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nEnable client authentication on etcd service.\\n\\n## Rationale\\n\\nEtcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.\\n\\n## Remediation\\n\\nEdit the etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` on the master node and set the below parameter:\\n\\n```\\n--client-cert-auth=\\\"true\\\"\\n```\\n\\n## Impact\\n\\nAll clients attempting to access the etcd server will require a valid client certificate.\\n\\n## Default Value\\n\\nBy default, the etcd service can be queried by unauthenticated clients.\\n\\n## References\\n\\n1. [https://coreos.com/etcd/docs/latest/op-guide/security.html ][`]\\n2. [https://kubernetes.io/docs/admin/etcd/ ][1]\\n3. [https://coreos.com/etcd/docs/latest/op-guide/configuration.html#client-cert-auth][2]\\n\\n## CIS Controls\\n\\nVersion 6 14 Controlled Access Based on the Need to Know Controlled Access Based on the Need to Know Version 7 4 Controlled Use of Administrative Privileges Controlled Use of Administrative Privileges                \\n\\n[1]: https://coreos.com/etcd/docs/latest/op-guide/security.html \\n[2]: https://kubernetes.io/docs/admin/etcd/ \\n[3]: https://coreos.com/etcd/docs/latest/op-guide/configuration.html#client-cert-auth\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605891818,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-2.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"joa-fjx-1li\",\"isDefault\":true,\"name\":\"--client-cert-auth argument is set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.3\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nBy default, Docker starts containers with a restricted set of Linux kernel capabilities. This means that any process can be granted the required capabilities instead of giving it root access. Using Linux kernel capabilities, processes in general do not need to run as the root user.\\n\\n## Rationale\\n\\nDocker supports the addition and removal of capabilities. Remove all capabilities not required for the correct function of the container. Specifically, in the default capability set provided by Docker, the NET_RAW capability should be removed if not explicitly required, as it can give an attacker with access to a container the ability to create spoofed network traffic.\\n\\n## Remediation\\n\\nExecute the command `docker run --cap-add={\\\"Capability 1\\\",\\\"Capability 2\\\"} <Run arguments> <Container Image Name or ID> <Command>` to add required capabilities.\\n\\nExecute the command `docker run --cap-drop={\\\"Capability 1\\\",\\\"Capability 2\\\"} <Run arguments> <Container Image Name or ID> <Command>` to remove unneeded capabilities.\\n\\nAlternatively, remove all the currently configured capabilities and then restore only the ones you specifically use: `docker run --cap-drop=all --cap-add={\\\"Capability 1\\\",\\\"Capability 2\\\"} <Run arguments> <Container Image Name or ID> <Command>`\\n\\n## Impact\\n\\nRestrictions on processes within a container are based on which Linux capabilities are in force. Removal of the `NET_RAW` capability prevents the container from creating raw sockets which is good security practice under most circumstances, but may affect some networking utilities.\\n\\n## Default Value\\n\\nBy default, the capabilities below are applied to containers:\\n\\n* `AUDIT_WRITE`\\n* `CHOWN`\\n* `DAC_OVERRIDE`\\n* `FOWNER`\\n* `FSETID`\\n* `KILL`\\n* `MKNOD`\\n* `NET_BIND_SERVICE`\\n* `NET_RAW`\\n* `SETFCAP`\\n* `SETGID`\\n* `SETPCAP`\\n* `SETUID`\\n* `SYS_CHROOT`\\n\\n## References\\n\\n1. https://docs.docker.com/engine/security/security/#linux-kernel-capabilities\\n2. http://man7.org/linux/man-pages/man7/capabilities.7.html\\n3. http://www.oreilly.com/webops-perf/free/files/docker-security.pdf\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605923399,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"3j5-bun-deq\",\"isDefault\":true,\"name\":\"Linux kernel capabilities are restricted within containers\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.11\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nBy default, all containers on a Docker host share resources equally. By using the resource management capabilities of the Docker host you can control the host CPU resources that a container may consume.\\n\\n## Rationale\\n\\nBy default, CPU time is divided between containers equally. If you wish to control available CPU resources amongst container instances, you can use the CPU sharing feature. CPU sharing allows you to prioritize one container over others and prevents lower priority containers from absorbing CPU resources which may be required by other processes. This ensures that high priority containers are able to claim the CPU runtime they require.\\n\\n## Remediation\\n\\nYou should manage the CPU runtime between your containers dependent on their priority within your organization. To do so, start the container using the `--cpu-shares` argument. For example, you could run a container as `docker run --interactive --tty --cpu-shares 512 centos /bin/bash` The container is started with CPU shares of 50% of what other containers use. So if the other container has CPU shares of 80%, this container will have CPU shares of 40%. Every new container will have 1024 shares of CPU by default. However, this value is shown as 0 if you run the command mentioned in the audit section.\\n\\n\\nAlternatively:\\n\\n1. Navigate to the `/sys/fs/cgroup/cpu/system.slice/` directory.\\n2. Check your container instance ID using docker ps.\\n3. Inside the above directory (in step 1), call a directory. For example: `docker-<Instance ID>.scope` or `docker-4acae729e8659c6be696ee35b2237cc1fe4edd2672e9186434c5116e1a6fbed6.scope`. Navigate to this directory.\\n4. You will find a file named `cpu.shares`. Execute `cat cpu.shares`. This will always give you the CPU share value based on the system. Even if there are no CPU shares configured using the `-c` or `--cpu-shares` argument in the docker run command, this file will have a value of 1024. If you set one containers CPU shares to 512 it will receive half of the CPU time compared to the other containers. So if you take 1024 as 100% you can then derive the number that you should set for respective CPU shares. For example, use 512 if you want to set it to 50% and 256 if you want to set it 25%.\\n\\n## Impact\\n\\nIf you do not correctly assign CPU thresholds, the container process may run out of resources and become unresponsive. If CPU resources on the host are not constrained, CPU shares do not place any restrictions on individual resources.\\n\\n## Default Value\\n\\nBy default, all containers on a Docker host share their resources equally. No CPU shares are enforced.\\n\\n## References\\n\\n1. https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/\\n2. https://docs.docker.com/engine/reference/commandline/run/#options\\n3. https://docs.docker.com/engine/admin/runmetrics/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605955638,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.11\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"gfh-gqy-log\",\"isDefault\":true,\"name\":\"CPU priority is set appropriately on containers\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.20\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nUTS namespaces provide isolation between two system identifiers: the hostname and the NIS domain name. It is used to set the hostname and the domain which are visible to running processes in that namespace. Processes running within containers do not typically require to know either the hostname or the domain name. The UTS namespace should therefore not be shared with the host.\\n\\n## Rationale\\n\\nSharing the UTS namespace with the host provides full permission for each container to change the hostname of the host. This is not in line with good security practice and should not be permitted.\\n\\n## Remediation\\n\\nYou should not start a container with the `--uts=host` argument. For example, do not start a container using the command `docker run --rm --interactive --tty --uts=host rhel7.2`\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, all containers have the UTS namespace enabled and the host UTS namespace is not shared with any containers.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/reference/run/#uts-settings-uts\\n2. http://man7.org/linux/man-pages/man7/namespaces.7.html\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n18 Application Software Security Application Software Security\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599605987292,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-5.20\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"j1n-gsx-mlx\",\"isDefault\":true,\"name\":\"Host's UTS namespace is not shared\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.3\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not use self-signed certificates for TLS.\\n\\n## Rationale\\n\\nEtcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.\\n\\n## Remediation\\n\\nEdit the etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` on the master node and either remove the `--auto-tls` parameter or set it to false:\\n\\n```\\n--auto-tls=false\\n```\\n\\n## Impact\\n\\nClients will not be able to use self-signed certificates for TLS.\\n\\n## Default Value\\n\\nBy default, `--auto-tls` is set to false.\\n\\n## References\\n\\n1. [https://coreos.com/etcd/docs/latest/op-guide/security.html ][1]\\n2. [https://kubernetes.io/docs/admin/etcd/ ][2]\\n3. [https://coreos.com/etcd/docs/latest/op-guide/configuration.html#auto-tls][3]\\n\\n## CIS Controls\\n\\nVersion 6 14.2 Encrypt All Sensitive Information Over Less-trusted Networks All communication of sensitive information over less-trusted networks should be encrypted. Whenever information flows over a network with a lower trust level, the information should be encrypted. Version 7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.                \\n\\n[1]: https://coreos.com/etcd/docs/latest/op-guide/security.html \\n[2]: https://kubernetes.io/docs/admin/etcd/ \\n[3]: https://coreos.com/etcd/docs/latest/op-guide/configuration.html#auto-tls\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599606018741,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-2.3\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"qai-h9s-xgt\",\"isDefault\":true,\"name\":\"--auto-tls argument is not set to true\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:4.2.1\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDisable anonymous requests to the Kubelet server.\\n\\n## Rationale\\n\\nWhen enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. You should rely on authentication to authorize access and disallow anonymous requests.\\n\\n## Remediation\\n\\nIf using a Kubelet config file, edit the file to set `authentication: anonymous: enabled` to false. If using executable arguments, edit the kubelet service file `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf` on each worker node and set the below parameter in `KUBELET_SYSTEM_PODS_ARGS` variable: \\n\\n```\\n--anonymous-auth=false\\n```\\n\\nBased on your system, restart the kubelet service. For example: `systemctl daemon-reload systemctl restart kubelet.service`\\n\\n## Impact\\n\\nAnonymous requests will be rejected.\\n\\n## Default Value\\n\\nBy default, anonymous access is enabled.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/admin/kubelet/ ][1]\\n2. [https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet-authentication][2]\\n\\n## CIS Controls\\n\\nVersion 6.14 Controlled Access Based on the Need to Know\\n\\nVersion 7.14 Controlled Access Based on the Need to Know       \\n\\n[1]: https://kubernetes.io/docs/admin/kubelet/ \\n[2]: https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet-authentication\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599606050277,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-4.2.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"oun-uxo-viy\",\"isDefault\":true,\"name\":\"Anonymous-auth argument is set to false\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.18\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nDo not bind the insecure API service.\\n\\n## Rationale\\n\\nIf you bind the apiserver to an insecure address, basically anyone who could connect to it over the insecure port, would have unauthenticated and unencrypted access to your master node. The apiserver doesn't do any authentication checking for insecure binds and traffic to the Insecure API port is not encrpyted, allowing attackers to potentially read sensitive data in transit.\\n\\n## Remediation\\n\\nEdit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and remove the --insecure-bind-address parameter.\\n\\n## Impact\\n\\nConnections to the API server will require valid authentication credentials.\\n\\n## Default Value\\n\\nBy default, the insecure bind address is not set.\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/\\n\\n## CIS Controls\\n\\nVersion 6 9.1 Limit Open Ports, Protocols, and Services Ensure that only ports, protocols, and services with validated business needs are running on each system. Version 7 9.2 Ensure Only Approved Ports, Protocols and Services Are Running Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599606081666,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.18\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"tzo-x3g-yya\",\"isDefault\":true,\"name\":\"--insecure-bind-address argument is not set\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.29\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\netcd should be configured to make use of TLS encryption for client connections.\\n\\n## Rationale\\n\\netcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a client certificate and key.\\n\\n## Remediation\\n\\nFollow the Kubernetes documentation and set up the TLS connection between the apiserver and etcd. Then, edit the API server pod specification file /etc/kubernetes/manifests/kube-apiserver.yaml on the master node and set the etcd certificate and key file parameters. --etcd-certfile=<path/to/client-certificate-file> --etcd-keyfile=<path/to/client-key-file>\\n\\n## Impact\\n\\nTLS and client certificate authentication must be configured for etcd.\\n\\n## Default Value\\n\\nBy default, --etcd-certfile and --etcd-keyfile arguments are not set\\n\\n## References\\n\\n1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://coreos.com/etcd/docs/latest/op-guide/security.html\\n\\n## CIS Controls\\n\\nVersion 6 9 Limitation and Control of Network Ports, Protocols, and Services Limitation and Control of Network Ports, Protocols, and Services Version 7 9 Limitation and Control of Network Ports, Protocols, and Services Limitation and Control of Network Ports, Protocols, and Services                \\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":3,\"createdAt\":1599606113167,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-1.2.29\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"2xl-vuo-tud\",\"isDefault\":true,\"name\":\"--etcd-certfile and --etcd-keyfile arguments are set as appropriate\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599745165740,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-23589-1599745165\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"tqe-l8o-idl\",\"isDefault\":false,\"name\":\"java-listSignals-23589-1599745165\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599745197731,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-23589-1599745197\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ped-bac-6tj\",\"isDefault\":false,\"name\":\"java-searchSignals-23589-1599745197\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599745641825,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-23603-1599745641\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"4zw-tp1-tzx\",\"isDefault\":false,\"name\":\"java-listSignals-23603-1599745641\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1599745684601,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-23603-1599745684\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"oje-psx-3ad\",\"isDefault\":false,\"name\":\"java-searchSignals-23603-1599745684\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600180779847,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24038-1600180779\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"bo1-dky-uhk\",\"isDefault\":false,\"name\":\"java-listSignals-24038-1600180779\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600180847825,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24038-1600180847\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"vhy-dbn-wte\",\"isDefault\":false,\"name\":\"java-searchSignals-24038-1600180847\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600180927556,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24038-1600180927\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"34u-pjt-dud\",\"isDefault\":false,\"name\":\"java-searchSignals-24038-1600180927\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600180995654,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24038-1600180995\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"xm0-pif-hmr\",\"isDefault\":false,\"name\":\"java-listSignals-24038-1600180995\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600181739537,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1600181738\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dlt-po7-izd\",\"isDefault\":false,\"name\":\"java-listSignals-local-1600181738\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600182213555,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1600182212\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"cor-saf-lx0\",\"isDefault\":false,\"name\":\"java-listSignals-local-1600182212\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600182820838,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1600182819\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"gil-5pq-6tb\",\"isDefault\":false,\"name\":\"java-listSignals-local-1600182819\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600182980888,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1600182979\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"bw2-26t-cxx\",\"isDefault\":false,\"name\":\"java-listSignals-local-1600182979\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600183064114,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24038-1600183063\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"g8c-s17-cmx\",\"isDefault\":false,\"name\":\"java-listSignals-24038-1600183063\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600183132265,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24038-1600183132\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dmk-hso-brm\",\"isDefault\":false,\"name\":\"java-searchSignals-24038-1600183132\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600183205179,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24038-1600183204\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"15k-twp-3ch\",\"isDefault\":false,\"name\":\"java-searchSignals-24038-1600183204\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600183273225,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24038-1600183272\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"oup-sib-iqv\",\"isDefault\":false,\"name\":\"java-listSignals-24038-1600183272\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600183343689,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1600183342\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"sqg-t75-jma\",\"isDefault\":false,\"name\":\"java-listSignals-local-1600183342\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600183570178,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1600183568\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"f6x-anw-hvk\",\"isDefault\":false,\"name\":\"java-listSignals-local-1600183568\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600193342469,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24038-1600193342\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"isq-mga-ta6\",\"isDefault\":false,\"name\":\"java-listSignals-24038-1600193342\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600193417026,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24038-1600193416\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"v5o-pur-btb\",\"isDefault\":false,\"name\":\"java-searchSignals-24038-1600193416\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600193491176,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24038-1600193490\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ep0-pxk-r8f\",\"isDefault\":false,\"name\":\"java-searchSignals-24038-1600193490\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600193560183,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24038-1600193559\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"4bl-cym-2kt\",\"isDefault\":false,\"name\":\"java-listSignals-24038-1600193559\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600248234337,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24038-1600248234\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"tju-6b1-lh8\",\"isDefault\":false,\"name\":\"java-listSignals-24038-1600248234\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600248314467,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24038-1600248314\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"wma-boi-22e\",\"isDefault\":false,\"name\":\"java-searchSignals-24038-1600248314\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600248386776,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24038-1600248386\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"alb-nso-og7\",\"isDefault\":false,\"name\":\"java-listSignals-24038-1600248386\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600248454683,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24038-1600248454\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"oqj-som-yrn\",\"isDefault\":false,\"name\":\"java-searchSignals-24038-1600248454\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600250546497,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24160-1600250544\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ym4-gp0-9eh\",\"isDefault\":false,\"name\":\"java-listSignals-24160-1600250544\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600250615304,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24160-1600250615\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"e1j-inz-b6u\",\"isDefault\":false,\"name\":\"java-searchSignals-24160-1600250615\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600250690696,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24160-1600250690\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"em8-fss-5le\",\"isDefault\":false,\"name\":\"java-listSignals-24160-1600250690\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600250759159,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24160-1600250758\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"scx-xye-5ys\",\"isDefault\":false,\"name\":\"java-searchSignals-24160-1600250758\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600264306372,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24226-1600264306\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"gsg-nug-kio\",\"isDefault\":false,\"name\":\"java-listSignals-24226-1600264306\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600264374488,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24226-1600264374\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"0z3-oia-5yy\",\"isDefault\":false,\"name\":\"java-searchSignals-24226-1600264374\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600264446865,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24226-1600264446\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ro7-yyl-sci\",\"isDefault\":false,\"name\":\"java-listSignals-24226-1600264446\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600264514777,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24226-1600264514\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"sny-pal-r6q\",\"isDefault\":false,\"name\":\"java-searchSignals-24226-1600264514\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600268198853,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24241-1600268198\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"tz2-zdn-obl\",\"isDefault\":false,\"name\":\"java-listSignals-24241-1600268198\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600268267487,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24241-1600268267\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"oe5-8oi-qnn\",\"isDefault\":false,\"name\":\"java-searchSignals-24241-1600268267\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600268340250,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24241-1600268339\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"hft-mns-sfs\",\"isDefault\":false,\"name\":\"java-listSignals-24241-1600268339\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600268408291,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24241-1600268408\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dzv-mb9-gxi\",\"isDefault\":false,\"name\":\"java-searchSignals-24241-1600268408\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600269703305,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24241-1600269703\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"kgg-zc7-lwq\",\"isDefault\":false,\"name\":\"java-listSignals-24241-1600269703\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600269776231,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24241-1600269771\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"es2-hrc-4r8\",\"isDefault\":false,\"name\":\"java-searchSignals-24241-1600269771\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600269849015,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24241-1600269848\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"x4x-xuq-bjl\",\"isDefault\":false,\"name\":\"java-listSignals-24241-1600269848\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600269920264,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24241-1600269920\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ohz-u2z-epj\",\"isDefault\":false,\"name\":\"java-searchSignals-24241-1600269920\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600271168052,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24261-1600271167\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"8ji-12g-rtm\",\"isDefault\":false,\"name\":\"java-listSignals-24261-1600271167\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600271238988,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24261-1600271238\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"lfh-u1r-tkh\",\"isDefault\":false,\"name\":\"java-searchSignals-24261-1600271238\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600271311256,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24261-1600271310\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"af4-7hc-uaa\",\"isDefault\":false,\"name\":\"java-listSignals-24261-1600271310\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600271379348,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24261-1600271379\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"qxx-5hy-qvl\",\"isDefault\":false,\"name\":\"java-searchSignals-24261-1600271379\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600274171458,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1600274169\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"wjc-u9g-vdo\",\"isDefault\":false,\"name\":\"java-listSignals-local-1600274169\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600274249573,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-local-1600274248\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"wsi-jec-7vf\",\"isDefault\":false,\"name\":\"java-listSignals-local-1600274248\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600336484598,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24330-1600336478\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"bep-xeh-shd\",\"isDefault\":false,\"name\":\"java-listSignals-24330-1600336478\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600336554461,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24330-1600336554\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ker-b3k-yyp\",\"isDefault\":false,\"name\":\"java-searchSignals-24330-1600336554\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600336628316,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24330-1600336628\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ewn-rle-xmk\",\"isDefault\":false,\"name\":\"java-searchSignals-24330-1600336628\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600336696688,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24330-1600336696\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"yys-gld-u5y\",\"isDefault\":false,\"name\":\"java-listSignals-24330-1600336696\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600338621977,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24335-1600338621\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"zl6-gun-adw\",\"isDefault\":false,\"name\":\"java-listSignals-24335-1600338621\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600338690097,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24335-1600338689\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"gzo-865-ced\",\"isDefault\":false,\"name\":\"java-searchSignals-24335-1600338689\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600338763036,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24335-1600338762\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"cnz-bnk-m36\",\"isDefault\":false,\"name\":\"java-searchSignals-24335-1600338762\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600338831145,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24335-1600338830\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"om3-8gd-1vp\",\"isDefault\":false,\"name\":\"java-listSignals-24335-1600338830\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600353522041,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24400-1600353521\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"0df-btm-4ws\",\"isDefault\":false,\"name\":\"java-listSignals-24400-1600353521\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600353590731,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24400-1600353590\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ktt-aow-tkb\",\"isDefault\":false,\"name\":\"java-searchSignals-24400-1600353590\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600353663598,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24400-1600353663\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"soq-tob-wvr\",\"isDefault\":false,\"name\":\"java-listSignals-24400-1600353663\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600353731990,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24400-1600353731\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"4jw-xbq-d2t\",\"isDefault\":false,\"name\":\"java-searchSignals-24400-1600353731\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600355135284,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24413-1600355135\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"i3g-af4-qr1\",\"isDefault\":false,\"name\":\"java-listSignals-24413-1600355135\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600355203266,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24413-1600355203\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"fmy-lhu-sye\",\"isDefault\":false,\"name\":\"java-searchSignals-24413-1600355203\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600355281399,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-listSignals-24413-1600355281\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"mjh-f2x-xhc\",\"isDefault\":false,\"name\":\"java-listSignals-24413-1600355281\"},{\"creationAuthorId\":1379811,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1600355356845,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-searchSignals-24413-1600355356\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dk5-xuo-zva\",\"isDefault\":false,\"name\":\"java-searchSignals-24413-1600355356\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.9\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the TLS CA certificate file, the file that is passed along with the `--tlscacert parameter`, is individually owned and group owned by root.\\n\\n## Rationale\\n\\nThe TLS CA certificate file should be protected from any tampering. It is used to authenticate the Docker server based on a given CA certificate. It must be therefore be individually owned and group owned by root to ensure that it cannot be modified by less privileged users.\\n\\n## Remediation\\n\\nRun the following command: `chown root:root <path to TLS CA certificate file>`\\n\\nThis sets the individual ownership and group ownership for the TLS CA certificate file to root.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the ownership and group-ownership for TLS CA certificate file is correctly set to root.\\n\\n## References\\n\\n1. https://docs.docker.com/registry/insecure/\\n2. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602076303298,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.9\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"8nb-ex2-pqe\",\"isDefault\":true,\"name\":\"TLS CA certificate file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.2\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nSet Docker daemon log level to `info`.\\n\\n## Rationale\\n\\nSetting up an appropriate log level configures the Docker daemon to log events that you would want to review later. A base log level of `info` and above captures all logs except `debug` logs. Unless required, you should not run Docker daemon at `debug` log level.\\n\\n## Remediation\\n\\nEnsure that the Docker daemon configuration file has the following configuration included:\\n\\n```\\n\\\"log-level\\\": \\\"info\\\" \\n```\\n\\nAlternatively, run the Docker daemon with the `log-level` specified:\\n\\n```\\ndockerd --log-level=\\\"info\\\"\\n```\\n\\n## Impact\\n\\nNone.\\n\\n## Default Value\\n\\nBy default, Docker daemon is set to log level of `info`.\\n\\n## References\\n\\n1. [https://docs.docker.com/edge/engine/reference/commandline/dockerd/][1]\\n\\n## CIS Controls\\n\\nVersion 6.6.2 Ensure Audit Log Settings Support Appropriate Log Entry Formatting - Validate audit log settings for each hardware device and the software installed on it, ensuring that logs include a date, timestamp, source addresses, destination addresses, and various other useful elements of each packet and/or transaction. Systems should record logs in a standardized format such as syslog entries or those outlined by the Common Event Expression initiative. If systems cannot generate logs in a standardized format, log normalization tools can be deployed to convert logs into such a format. \\n\\nVersion 7.6.2 Activate audit logging - Ensure that local logging has been enabled on all systems and networking devices. \\n\\nVersion 6.3 Enable Detailed Logging - Enable system logging to include detailed information such as an event source, date, user, timestamp, source addresses, destination addresses, and other useful elements.                \\n\\n[1]: https://docs.docker.com/edge/engine/reference/commandline/dockerd/\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602076723155,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-2.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"q6o-wrf-hf4\",\"isDefault\":true,\"name\":\"Logging level is set to 'info'\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.10\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the TLS CA certificate file, the file that is passed along with the `--tlscacert` parameter, has permissions of 444 or is set more restrictively.\\n\\n## Rationale\\n\\nThe TLS CA certificate file should be protected from any tampering. It is used to authenticate the Docker server based on a given CA certificate. It must therefore have permissions of 444, or more restrictive permissions to ensure that the file cannot be modified by a less privileged user.\\n\\n## Remediation\\n\\nRun the following command: `chmod 444 <path to TLS CA certificate file>`\\n\\nThis sets the file permissions on the TLS CA file to 444.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the permissions for the TLS CA certificate file might not be 444. The default file permissions are governed by the operating system or user specific umask values.\\n\\n## References\\n\\n1. https://docs.docker.com/registry/insecure/\\n2. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602076723625,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.10\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"hyd-ar9-kzl\",\"isDefault\":true,\"name\":\"TLS CA certificate file permissions are set to 444 or more restrictively\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.12\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the Docker server certificate file, the file that is passed along with the `--tlscert` parameter, has permissions of 444 or more restrictive permissions.\\n\\n## Rationale\\n\\nThe Docker server certificate file should be protected from any tampering. It is used to authenticate the Docker server based on the given server certificate. It should therefore have permissions of 444 to prevent its modification.\\n\\n## Remediation\\n\\nRun the command below: `chmod 444 <path to Docker server certificate file>`\\n\\nThis sets the file permissions of the Docker server certificate file to 444.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the permissions for the Docker server certificate file might not be 444. The default file permissions are governed by the operating system or user specific umask values.\\n\\n## References\\n\\n1. https://docs.docker.com/registry/insecure/\\n2. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists - All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists - Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602076770300,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.12\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"blu-k6b-re1\",\"isDefault\":true,\"name\":\"Docker server certificate file permissions are set to 444 or more restrictively\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:1.2.1\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nAll Docker containers and their data and metadata are stored in the `/var/lib/docker` directory. By default, `/var/lib/docker` should be mounted under either the `/` or `/var` partitions depending on how the Linux operating system in use is configured.\\n\\n## Rationale\\n\\nDocker depends on `/var/lib/docker` as the default directory where all Docker related files, including the images, are stored. This directory could fill up quickly causing both Docker and the host to become unusable. For this reason, you should create a separate partition (logical volume) for storing Docker files.\\n\\n## Remediation\\n\\nFor new installations, you should create a separate partition for the `/var/lib/docker` mount point. For systems that have already been installed, you should use the Logical Volume Manager (LVM) within Linux to create a new partition.\\n\\n## Impact\\n\\nNone.\\n\\n## Default Value\\n\\nBy default, `/var/lib/docker` is mounted under the `/` or `/var` partitions dependent on how the OS is configured.\\n\\n## References\\n\\n1. [https://www.projectatomic.io/docs/docker-storage-recommendation/][1]\\n\\n## CIS Controls\\n\\nVersion 6.14 Controlled Access Based on the Need to Know                \\n\\n[1]: https://www.projectatomic.io/docs/docker-storage-recommendation/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602076808377,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-1.2.1\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"wcf-c0t-fkz\",\"isDefault\":true,\"name\":\"A separate partition for containers has been created\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.14\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the Docker server certificate key file, the file that is passed along with the `--tlskey` parameter, has permissions of 400.\\n\\n## Rationale\\n\\nThe Docker server certificate key file should be protected from any tampering or unneeded reads. It holds the private key for the Docker server certificate. It must therefore have permissions of 400 to ensure that the certificate key file is not modified.\\n\\n## Remediation\\n\\nYou should execute the following command: `chmod 400 <path to Docker server certificate key file>`\\n\\nThis sets the Docker server certificate key file permissions to 400.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the permissions for the Docker server certificate key file might not be 400. The default file permissions are governed by the operating system or user specific umask values.\\n\\n## References\\n\\n1. https://docs.docker.com/registry/insecure/\\n2. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n14.4 Protect Information With Access Control Lists All information stored on systems shall be protected with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\nVersion 7\\n\\n14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602077570102,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.14\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"z0n-cod-mxi\",\"isDefault\":true,\"name\":\"Docker server certificate key file permissions are set to 400\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:2.6\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nIt is possible to make the Docker daemon available remotely over a TCP port. If this is required, you should ensure that TLS authentication is configured in order to restrict access to the Docker daemon via IP address and port.\\n\\n## Rationale\\n\\nBy default, the Docker daemon binds to a non-networked Unix socket and runs with root privileges. If you change the default Docker daemon binding to a TCP port or any other Unix socket, anyone with access to that port or socket could have full access to the Docker daemon and therefore in turn to the host system. For this reason, you should not bind the Docker daemon to another IP/port or a Unix socket. If you must expose the Docker daemon via a network socket, you should configure TLS authentication for the daemon and for any Docker Swarm APIs (if they are in use). This type of configuration restricts the connections to your Docker daemon over the network to a limited number of clients who have access to the TLS client credentials.\\n\\n## Remediation\\n\\nFollow the steps mentioned in the Docker documentation or other references.\\n\\n## Impact\\n\\nYou would need to manage and guard certificates and keys for the Docker daemon and Docker clients.\\n\\n## Default Value\\n\\nBy default, TLS authentication is not configured.\\n\\n## References\\n\\n1. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n9.1 Limit Open Ports, Protocols, and Services - Ensure that only ports, protocols, and services with validated business needs are running on each system.\\n\\nVersion 7\\n\\n9.2 Ensure Only Approved Ports, Protocols and Services Are Running - Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602077571799,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-2.6\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"rh4-jeh-afu\",\"isDefault\":true,\"name\":\"TLS authentication for Docker daemon is configured\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.13\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the Docker server certificate key file, the file that is passed along with the `--tlskey` parameter, is individually owned and group owned by root.\\n\\n## Rationale\\n\\nThe Docker server certificate key file should be protected from any tampering or unneeded reads/writes. As it holds the private key for the Docker server certificate, it must be individually owned and group owned by root to ensure that it cannot be accessed by less privileged users.\\n\\n## Remediation\\n\\nRun the following command: `chown root:root <path to Docker server certificate key file>`\\n\\nThis sets the individual ownership and group ownership for the Docker server certificate key file to root.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the individual ownership and group ownership for the Docker server certificate key file is correctly set to root.\\n\\n## References\\n\\n1. https://docs.docker.com/registry/insecure/\\n2. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602077710804,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.13\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"oiu-e3x-yg6\",\"isDefault\":true,\"name\":\"Docker server certificate key file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:3.11\",\"framework:cis-docker\",\"framework_version:1.2.0\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nYou should verify that the Docker server certificate file, the file that is passed along with the `--tlscert` parameter, is individual owned and group owned by root.\\n\\n## Rationale\\n\\nThe Docker server certificate file should be protected from any tampering. It is used to authenticate the Docker server based on the given server certificate. It must therefore be individually owned and group owned by root to prevent modification by less privileged users.\\n\\n## Remediation\\n\\nRun the following command: `chown root:root <path to Docker server certificate file>`\\n\\nThis sets the individual ownership and the group ownership for the Docker server certificate file to root.\\n\\n## Impact\\n\\nNone\\n\\n## Default Value\\n\\nBy default, the ownership and group-ownership for Docker server certificate file is correctly set to root.\\n\\n## References\\n\\n1. https://docs.docker.com/registry/insecure/\\n2. https://docs.docker.com/engine/security/https/\\n\\n## CIS Controls\\n\\nVersion 6\\n\\n5.1 Minimize And Sparingly Use Administrative Privileges - Minimize administrative privileges and only use administrative accounts when they are required. Implement focused auditing on the use of administrative privileged functions and monitor for anomalous behavior.\\n\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":2,\"createdAt\":1602077837917,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-docker-1.2.0-3.11\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"tkm-izb-xe1\",\"isDefault\":true,\"name\":\"Docker server certificate file ownership is set to root:root\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0006-credential-access\",\"technique:T1552-unsecured-credentials\",\"source:route53\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a requested domain resolves to the AWS Metadata IP (169.254.169.254).\\n\\n### Strategy\\nInspect the Route 53 logs and determine if the response data for a DNS request matches the AWS Metadata IP (169.254.169.254). This could indicate an attacker is attempting to steal your credentials from the AWS metadata service.\\n\\n### Triage and Response\\n1. Determine which instance is associated with the DNS request.\\n2. Determine whether the domain name which was requested (`dns.question.name`) should be permitted. If not, conduct an investigation and determine what requested the domain and determine if the AWS metadata credentials were accessed by an attacker.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1603296598998,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"domain_resolve_to_metadata_ip\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:route53 @answers.Rdata:169.254.169.254\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"domain_resolve_to_metadata_ip > 0\"}],\"type\":\"threshold\",\"id\":\"mwi-zj7-db9\",\"isDefault\":true,\"name\":\"EC2 instance resolved a suspicious AWS metadata DNS query\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"source:route53\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when a requested domain has a suspicious TLD.\\n\\n### Strategy\\nInspect the Route 53 logs and determine if the TLD of the DNS question (`@dns.question.name`) matches one of the top 5 TLDs on [Spamhaus's Most Abused Top Level Domains list][1].\\n\\n### Triage and Response\\n1. Determine which instance is associated with the DNS request.\\n2. Determine whether the domain name which was requested (`dns.question.name`) should be permitted. If not, conduct an investigation and determine what requested the domain and determine if the AWS metadata credentials were accessed by an attacker.\\n\\n[1]: https://www.spamhaus.org/statistics/tlds/\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":3,\"createdAt\":1603296605789,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"suspicious_tld\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"@dns.question.name:(*.fit. OR *.work. OR *.webcam. OR *.loan. OR *.cf.)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"suspicious_tld > 0\"}],\"type\":\"threshold\",\"id\":\"dus-bf6-3jr\",\"isDefault\":true,\"name\":\"EC2 instance requested a suspicious domain\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.3.2\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nUse network policies to isolate traffic in your cluster network.\\n\\n## Rationale\\n\\nRunning different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. A network policy is a specification of how selections of pods are allowed to communicate with each other and other network endpoints. Network Policies are namespace scoped. When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. However, if there are no network policies in a namespace, all traffic will be allowed into and out of the pods in that namespace.\\n\\n## Remediation\\n\\nFollow the documentation and create network policy objects as you need them.\\n\\n## Impact\\n\\nOnce network policies are in use within a given namespace, traffic not explicitly allowed by a network policy will be denied. It is important to ensure that, when introducing network policies, legitimate traffic is not blocked.\\n\\n## Default Value\\n\\nBy default, network policies are not created.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/concepts/services-networking/networkpolicies/ ][1]\\n2. [https://octetz.com/posts/k8s-network-policy-apis ][2]\\n3. [https://kubernetes.io/docs/tasks/configure-pod-container/declare-network-policy/][3]\\n\\n## CIS Controls\\n\\nVersion 6.14.1 Implement Network Segmentation Based On Information Class Segment - The network based on the label or classification level of the information stored on the servers. Locate all sensitive information on separated VLANS with firewall filtering to ensure that only authorized individuals are only able to communicate with systems necessary to fulfill their specific responsibilities. \\n\\nVersion 7.14.1 Segment the Network Based on Sensitivity - Segment the network based on the label or classification level of the information stored on the servers, locate all sensitive information on separated Virtual Local Area Networks (VLANs).\\n\\nVersion 7.14.2 Enable Firewall Filtering Between VLANs - Enable firewall filtering between VLANs to ensure that only authorized systems are able to communicate with other systems necessary to fulfill their specific responsibilities.      \\n\\n[1]: https://kubernetes.io/docs/concepts/services-networking/networkpolicies/ \\n[2]: https://octetz.com/posts/k8s-network-policy-apis \\n[3]: https://kubernetes.io/docs/tasks/configure-pod-container/declare-network-policy/\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":1,\"createdAt\":1604312181303,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-5.3.2\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"mrw-bae-anz\",\"isDefault\":true,\"name\":\"All namespaces have network policies defined\"},{\"creationAuthorId\":0,\"tags\":[\"source:compliance-agent\",\"security:compliance\",\"control:5.1.5\",\"framework:cis-kubernetes\",\"framework_version:1.5.1\",\"scored:true\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\n\\nThe default service account should not be used to ensure that rights granted to applications can be more easily audited and reviewed.\\n\\n## Rationale\\n\\nKubernetes provides a default service account which is used by cluster workloads where no specific service account is assigned to the pod. Where access to the Kubernetes API from a pod is required, a specific service account should be created for that pod, and rights granted to that service account. The default service account should be configured such that it does not provide a service account token and does not have any explicit rights assignments.\\n\\n## Remediation\\n\\nCreate explicit service accounts wherever a Kubernetes workload requires specific access to the Kubernetes API server. Modify the configuration of each default service account to include this value `automountServiceAccountToken: false`.\\n\\n## Impact\\n\\nAll workloads which require access to the Kubernetes API will require an explicit service account to be created.\\n\\n## Default Value\\n\\nBy default the default service account allows for its service account token to be mounted in pods in its namespace.\\n\\n## References\\n\\n1. [https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/][1]\\n\\n## CIS Controls\\n\\nNone                \\n\\n[1]: https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":7200},\"version\":1,\"createdAt\":1604312204438,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@resource_id\"],\"query\":\"source:compliance-agent @agent_rule_id:\\\"cis-kubernetes-1.5.1-5.1.5\\\" @result:failed\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"Failed\",\"condition\":\"a > 0\"}],\"type\":\"runtime_compliance\",\"id\":\"3yv-aqm-bxc\",\"isDefault\":true,\"name\":\"Default service accounts are not actively used\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1543\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nDetect modifications to system services.\\n\\n## Strategy\\nEspecially in production, systems should be generated based on standard images such as AMIs for Amazon EC2, VM images in Azure, or GCP images. Systemd is the default service manager in many Linux distributions. It manages the lifecycle of background processes and services, and can be used by an attacker to establish persistence in the system. Attackers can do this by injecting code into existing systemd services, or by creating new ones. Systemd services can be started on system boot, and therefore attacker code can persist through system reboots.\\n\\n## Triage & Response\\n1. Check to see what service was modified of created.\\n2. Identify whether it is a known service, being modified by a known user and/or process.\\n3. If these changes are not acceptable, roll back the host in question to an acceptable configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1606142929241,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"systemd_modification\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"vjt-chu-njs\",\"isDefault\":true,\"name\":\"Systemd Modification\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1547\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nDetect modifications made to the `/boot/` directory.\\n\\n## Strategy\\nThe /boot/ directory in Linux contains everything required for the system to boot. This includes the kernel and other important boot files and data. Attackers may attempt to modify the /boot/ directory to inject malicious code or configuration. This can allow the attacker to gain persistence, by running the malicious code or configuration at boot time. It can also allow the attacker to run malicious code with elevated system privileges.\\n\\n## Triage & Response\\n1. Check to see what modifications were made to the `/boot/` directory.\\n2. Cross-check any changes with known system activity, such as startup scripts, or maintenance.\\n3. If these changes are not acceptable, roll back the host or container in question to a known good `/boot/` configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1606142931057,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"kernel_modification\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"9cs-fap-2er\",\"isDefault\":true,\"name\":\"Kernel Modification\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"framework:pci\",\"control:11.5\",\"framework_version:3.2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Description\\nDetect modifications of critical system binaries.\\n\\n## Rationale\\nPCI-DSS is the payment-card industry's compliance framework. Any systems that handle credit card data and transactions from the major credit card companies must be PCI-DSS compliance. Control 11.5 of the PCI-DSS framework states that organizations must \\\"alert personnel to unauthorized modification (including changes, additions, and deletions) of critical system files, configuration files or content files\\\". On Linux, critical system binaries are typically stores in `/bin/`, `/sbin/`, or `/usr/sbin/`. This rule tracks any modifications to those directories.\\n\\n## Remediation\\n1. Check to see which user or process changed the critical system binaries.\\n2. If these changes were not authorized, and you cannot confirm the safety of the changes, roll back the host or container in question to an acceptable configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1606142933669,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"critical_binaries\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"3rk-f4l-c7j\",\"isDefault\":true,\"name\":\"Critical System Binaries\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1556\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nDetect modifications to `pam.d` directory.\\n\\n## Strategy\\nLinux Pluggable Authentication Modules (PAM) provide authentication for applications and services. Authentication modules in the PAM system are setup and configured under the `/etc/pam.d/` directory. An attacker may attempt to modify or add an authentication module in PAM in order to bypass the authentication process, or reveal system credentials.\\n\\n## Triage & Response\\n1. Check to see what changes were made to `/etc/pam.d/`.\\n2. Check whether the changes were a part of known system-setup or maintenance.\\n3. If these changes were unauthorized, roll back the host in question to a known good PAM configuration, or replace the system with a known-good system image.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1606142936138,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"pam_modification\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"59x-93j-pek\",\"isDefault\":true,\"name\":\"PAM Configuration Files Modification\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1098\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nDetect modifications to authorized SSH keys.\\n\\n## Strategy\\nSSH is a commonly used key-based authentication mechanism. In this system, the authorized_keys file specifies SSH keys that can be used to authenticate as a specific user on the system. Attacker's may modify the authorized_keys file to authorize attacker-owned SSH keys. This allows the attacker to maintain persistence on a system as a specific user.\\n\\n## Triage & Response\\n1. Check what changes were made to authorized_keys, and under which user.\\n2. Determine whether any keys were added. If so, determine if the added keys belong to known trusted users.\\n3. If they keys in question are not acceptable, roll back the host or container in question to a known trusted SSH configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1606142954844,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"ssh_authorized_keys\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"iqs-k9p-ivj\",\"isDefault\":true,\"name\":\"SSH Authorized Keys Modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1556\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nDetect modifications to nsswitch.conf.\\n\\n## Strategy\\nThe Name Service Switch (nsswitch) configuration file is used to point\\u00a0system services and other applications to the sources of name-service information. This name-service information includes where the password file is stored, publickey information, and more. An attacker may attempt to modify nsswitch.conf in order to inject attacker-owned information into the authentication process. For instance, the attacker could point to a malicious password file and then login to privileged user accounts.\\n\\n## Triage & Response\\n1. Check to see what changes were made to nsswitch.conf.\\n2. Check if critical name-service sources were changed, and whether the changes were a part of known system-setup or maintenance.\\n3. If these changes are unauthorized, roll back the host in question to a known good nsswitch.conf, or replace the system with a known-good system image.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1606142958657,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"nsswitch_conf_mod\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"djc-3dp-3qm\",\"isDefault\":true,\"name\":\"Nsswitch Configuration Modified\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1053\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nDetect the creation or modification of new cron jobs on a system.\\n\\n## Strategy\\nCron is a task scheduling system that runs tasks on a time-based schedule. Attackers can use cron jobs to gain persistence on a system, or even to run malicious code at system-boot. Cron jobs can also be used for remote code execution, or to run a process under a different user-context.\\n\\n## Triage & Response\\n1. Check to see which cron task was created or modified.\\n2. Check whether the cron task was created or modified by a known user or process.\\n3. If these changes are not acceptable, roll back the host or container in question to an acceptable configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1606142961130,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"cron_at_job_creation\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"qqk-vqp-6xt\",\"isDefault\":true,\"name\":\"Cront AT Job Creation\"},{\"creationAuthorId\":0,\"tags\":[\"source:runtime-security-agent\",\"technique:T1553\",\"security:attack\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"## Goal\\nDetect potential tampering with SSL certificates.\\n\\n## Strategy\\nSSL certificates, and other forms of trust controls establish trust between systems. Attackers may attempt to subvert trust controls such as SSL certificates in order to trick systems or users into trusting attacker-owned assets such as fake websites, or falsely signed applications.\\n\\n## Triage & Response\\n1. Check whether there were any planned changed to the SSL certificates stores in your infrastructure.\\n3. If these changes are not acceptable, roll back the host or container in question to a known trustworthy configuration.\\n\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":86400,\"keepAlive\":3600},\"version\":1,\"createdAt\":1606142980369,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"host\"],\"query\":\"source:runtime-security-agent @agent_rule_id:\\\"ssl_certificate_tampering\\\"\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"runtime_security\",\"id\":\"any-phm-6ub\",\"isDefault\":true,\"name\":\"SSL Certificate Tampering\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218306750,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-0\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"j5h-rp0-iro\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-0\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218307543,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-1\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"x9q-69c-tkx\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-1\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218308231,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-2\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"ywc-kff-uw5\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-2\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218308743,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-3\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"k5k-uzk-gr8\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-3\"},{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":true,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":1,\"createdAt\":1606218309270,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-4\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"dcp-y6y-mpk\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-4\"}]}"
  }
}, {
  "id" : "794fef10-5d0d-4b17-8ae2-e9cc7fea188b",
  "httpRequest" : {
    "method" : "GET",
    "path" : "/api/v2/security_monitoring/rules",
    "queryStringParameters" : {
      "page[size]" : [ "2" ],
      "page[number]" : [ "0" ]
    },
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "listSecurityMonitoringRules" ],
      "Connection" : [ "close" ],
      "content-length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:12 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:12 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "hkXZRrnCTh2pkyHJgLo1+B5+sLp+RYzQrqT867R6UzDvqVGo8Av8yUCpaA0POidP" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "3488" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"meta\":{\"page\":{\"total_filtered_count\":2,\"total_count\":460}},\"data\":[{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0007-discovery\",\"technique:T1069-permission-groups-discovery\",\"source:guardduty\",\"scope:iam\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is enumerating IAM principals.\\n\\n### Strategy\\nThis rule lets you leverage GuardDuty to detect when an attacker is enumerating IAM principals. The GuardDuty Findings which trigger this signal:\\n\\n* [Recon:IAMUser/NetworkPermissions][1]\\n* [Recon:IAMUser/ResourcePermissions][2]\\n* [Recon:IAMUser/UserPermissions][3] \\n\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon7\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon8\\n[3]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_recon.html#recon9\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276065,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@detail.resource.accessKeyDetails.userName\"],\"query\":\"source:guardduty @evt.name:(Recon\\\\:IAMUser\\\\/NetworkPermissions OR Recon\\\\:IAMUser\\\\/ResourcePermissions OR Recon\\\\:IAMUser\\\\/UserPermissions)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"medium\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"u2j-xph-kc7\",\"isDefault\":true,\"name\":\"AWS IAM principal enumeration\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1496-resource-hijacking\",\"source:guardduty\",\"scope:ec2\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an EC2 instance is communicating with a cryptocurrency server\\n\\n### Strategy\\nThis rule lets you leverage GuardDuty to detect when an EC2 instance has made a DNS request or is communicating with an IP that is associated with cryptocurrency operations. The following GuardDuty Findings trigger this signal:\\n\\n* [CryptoCurrency:EC2/BitcoinTool.B!DNS][1]\\n* [CryptoCurrency:EC2/BitcoinTool.B][2]\\n\\n\\n### Triage & Response\\n1. Determine which domain name or IP address triggered the signal. This can be found in the samples. \\n2. If the domain or IP address should not have been requested, open a security investigation, and determine which process requested the domain name or IP address.\\n\\n[1]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_crypto.html#crypto3\\n[2]: https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_crypto.html#crypto4\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276326,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"instance-id\"],\"query\":\"source:guardduty @evt.name:(CryptoCurrency\\\\:EC2\\\\/BitcoinTool.B\\\\!DNS OR CryptoCurrency\\\\:EC2\\\\/BitcoinTool.B)\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"ky3-ds4-ipb\",\"isDefault\":true,\"name\":\"AWS EC2 instance communicating with a cryptocurrency server\"}]}"
  }
}, {
  "id" : "179e9ff2-cf25-401d-a427-cfaaaa6f66fc",
  "httpRequest" : {
    "method" : "GET",
    "path" : "/api/v2/security_monitoring/rules",
    "queryStringParameters" : {
      "page[size]" : [ "2" ],
      "page[number]" : [ "1" ]
    },
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "listSecurityMonitoringRules" ],
      "Connection" : [ "close" ],
      "content-length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:12 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:12 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "Dx/lglfFHSSR55lZZXPJOntjJp7qb35tIKm/SqO1nkg0n+U6yMAlHYP22LPWSHfP" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "2982" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"meta\":{\"page\":{\"total_filtered_count\":2,\"total_count\":460}},\"data\":[{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0040-impact\",\"technique:T1485-data-destruction\",\"source:cloudtrail\",\"scope:rds\"],\"isEnabled\":true,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect when an attacker is destroying a RDS Cluster.\\n\\n### Strategy\\nThis rule lets you monitor this CloudTrail API call to detect if an attacker is deleting a RDS cluster:\\n\\n* [DeleteDBCluster][1]\\n\\n### Triage & Response\\n1. Determine which user in your organization owns the API key that made this API call.\\n2. Contact the user to see if they intended to make this API call.\\n3. If the user did not make the API call:\\n * Rotate the credentials.\\n * Investigate if the same credentials made other unauthorized API calls.\\n\\n[1]: https://docs.aws.amazon.com/cli/latest/reference/rds/delete-db-cluster.html\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":3600,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276546,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"\",\"aggregation\":\"count\",\"groupByFields\":[\"@userIdentity.arn\"],\"query\":\"source:cloudtrail @evt.name:DeleteDBCluster\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[],\"name\":\"\",\"condition\":\"a > 0\"}],\"type\":\"threshold\",\"id\":\"6ng-pk1-ukh\",\"isDefault\":true,\"name\":\"AWS RDS Cluster deleted\"},{\"creationAuthorId\":0,\"tags\":[\"security:attack\",\"tactic:TA0006-credential-access\",\"technique:T1110-brute-force\",\"scope:template\"],\"isEnabled\":false,\"hasExtendedTitle\":true,\"message\":\"### Goal\\nDetect Account Take Over (ATO) through brute force attempts\\n\\n### Strategy\\nTo determine a successful attempt: Detect a high amount of failed logins and at least one successful login for a given user. This will generate a `HIGH` severity signal.\\nTo determine an attempt: Detect a high amount of failed logins. This will generate an `INFO` severity signal.\\n\\n### Triage & Response\\n1. Inspect the logs to see if this was a valid login attempt.\\n2. See if 2FA was authenticated.\\n3. If the user was compromised, rotate user credentials.\",\"options\":{\"evaluationWindow\":300,\"maxSignalDuration\":7200,\"keepAlive\":3600},\"version\":2,\"createdAt\":1585870276794,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"failed_login\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.name\"],\"query\":\"@evt.name:authentication @evt.outcome:failure @usr.name:*\",\"trackType\":\"logs\"},{\"distinctFields\":[],\"name\":\"successful_login\",\"aggregation\":\"count\",\"groupByFields\":[\"@usr.name\"],\"query\":\"@evt.name:authentication @evt.outcome:success @usr.name:*\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"high\",\"notifications\":[\"@slack-secops\"],\"name\":\"Successful\",\"condition\":\"failed_login > 50 && successful_login > 0\"},{\"status\":\"info\",\"notifications\":[\"@slack-secops\"],\"name\":\"Attempt\",\"condition\":\"failed_login > 5\"}],\"type\":\"threshold\",\"id\":\"jhi-klp-smm\",\"isDefault\":true,\"name\":\"TEMPLATE - Brute Force Attack Grouped By User\"}]}"
  }
}, {
  "id" : "c2cec36b-2c06-4a28-b9da-94e4af0370de",
  "httpRequest" : {
    "method" : "PUT",
    "path" : "/api/v2/security_monitoring/rules/j5h-rp0-iro",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "updateSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "426" ]
    },
    "keepAlive" : false,
    "secure" : true,
    "body" : {
      "type" : "JSON",
      "json" : "{\"cases\":[{\"condition\":\"rule > 0\",\"name\":\"rule-case\",\"notifications\":[],\"status\":\"info\"}],\"isEnabled\":false,\"message\":\"Rule message\",\"name\":\"java-rulesCrudTest-local-1606218304-0\",\"options\":{\"evaluationWindow\":0,\"keepAlive\":0,\"maxSignalDuration\":0},\"queries\":[{\"aggregation\":\"count\",\"distinctFields\":[],\"groupByFields\":[],\"name\":\"rule\",\"query\":\"java-rulesCrudTest-local-1606218304-0\"}],\"tags\":[\"datadog-api-client-test-java\"]}"
    }
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:13 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:13 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "yHg1SN54kOfDRp2Aod0BXYSVxFx21V1jRKSkwPBeHEmd2sEVS/QK2WhkC8rNJWsm" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "622" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":false,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":2,\"createdAt\":1606218306750,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-0\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"j5h-rp0-iro\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-0\"}"
  }
}, {
  "id" : "7dc539b4-1d6d-42ec-9355-1f51f4fb2538",
  "httpRequest" : {
    "method" : "GET",
    "path" : "/api/v2/security_monitoring/rules/j5h-rp0-iro",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "getSecurityMonitoringRule" ],
      "Connection" : [ "close" ],
      "content-length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 200,
    "reasonPhrase" : "OK",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:13 GMT" ],
      "Content-Type" : [ "application/json;charset=utf-8" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:13 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "E/n/F3cyfMhzzJeB7O6BVmaq6hO3dCQFUY5AzeSSV4syTTIgel8CkF1YlP8TXzmG" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "622" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    },
    "body" : "{\"creationAuthorId\":1445416,\"tags\":[\"datadog-api-client-test-java\"],\"isEnabled\":false,\"hasExtendedTitle\":false,\"message\":\"Rule message\",\"options\":{\"evaluationWindow\":0,\"maxSignalDuration\":0,\"keepAlive\":0},\"version\":2,\"createdAt\":1606218306750,\"filters\":[],\"queries\":[{\"distinctFields\":[],\"name\":\"rule\",\"aggregation\":\"count\",\"groupByFields\":[],\"query\":\"java-rulesCrudTest-local-1606218304-0\",\"trackType\":\"logs\"}],\"isDeleted\":false,\"cases\":[{\"status\":\"info\",\"notifications\":[],\"name\":\"rule-case\",\"condition\":\"rule > 0\"}],\"type\":\"threshold\",\"id\":\"j5h-rp0-iro\",\"isDefault\":false,\"name\":\"java-rulesCrudTest-local-1606218304-0\"}"
  }
}, {
  "id" : "35a31482-d476-4a56-b67c-992a8cebc6c1",
  "httpRequest" : {
    "method" : "DELETE",
    "path" : "/api/v2/security_monitoring/rules/j5h-rp0-iro",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "deleteSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 204,
    "reasonPhrase" : "No Content",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:14 GMT" ],
      "Content-Length" : [ "2" ],
      "Connection" : [ "keep-alive" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:14 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "chc/Ua/VlFggLuiJmJEWtOjiWKu2FOjUYS91CLY/GE8MSguAZUcjuIV2bgSw80Sv" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    }
  }
}, {
  "id" : "50b4a1f5-231d-40e1-94d8-0a8c0802bf03",
  "httpRequest" : {
    "method" : "GET",
    "path" : "/api/v2/security_monitoring/rules/j5h-rp0-iro",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "getSecurityMonitoringRule" ],
      "Connection" : [ "close" ],
      "content-length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 404,
    "reasonPhrase" : "Not Found",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:14 GMT" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "59" ]
    },
    "body" : "{\"errors\":[\"Threat detection rule not found: j5h-rp0-iro\"]}"
  }
}, {
  "id" : "60211ca5-d871-4d4b-8fe0-37f5ca7ae2c1",
  "httpRequest" : {
    "method" : "DELETE",
    "path" : "/api/v2/security_monitoring/rules/j5h-rp0-iro",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "deleteSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 404,
    "reasonPhrase" : "Not Found",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:15 GMT" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "keep-alive" ],
      "Vary" : [ "Accept-Encoding" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ],
      "content-length" : [ "59" ]
    },
    "body" : "{\"errors\":[\"Threat detection rule not found: j5h-rp0-iro\"]}"
  }
}, {
  "id" : "69db6d7d-cbe9-4413-a132-716b935c6036",
  "httpRequest" : {
    "method" : "DELETE",
    "path" : "/api/v2/security_monitoring/rules/x9q-69c-tkx",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "deleteSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 204,
    "reasonPhrase" : "No Content",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:16 GMT" ],
      "Content-Length" : [ "2" ],
      "Connection" : [ "keep-alive" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:15 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "M5AkO8bVyO5yuX6OQA9nCjANXZokYPd2NqFZwMNyvfQQbQnBskFTa6rdUllh6BsX" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    }
  }
}, {
  "id" : "b8408ba1-1ae9-4be0-833b-afbcc84d7fe2",
  "httpRequest" : {
    "method" : "DELETE",
    "path" : "/api/v2/security_monitoring/rules/ywc-kff-uw5",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "deleteSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 204,
    "reasonPhrase" : "No Content",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:16 GMT" ],
      "Content-Length" : [ "2" ],
      "Connection" : [ "keep-alive" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:16 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "amxMFAqiSVjNyNv9bH0oCnBEjAVk4yOIMrMQTyRWQ0WFa2JUcjQXHejBMO8Fj7RQ" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    }
  }
}, {
  "id" : "345de867-e709-41a0-bb0b-794668e7ef08",
  "httpRequest" : {
    "method" : "DELETE",
    "path" : "/api/v2/security_monitoring/rules/k5k-uzk-gr8",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "deleteSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 204,
    "reasonPhrase" : "No Content",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:17 GMT" ],
      "Content-Length" : [ "2" ],
      "Connection" : [ "keep-alive" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:17 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "H6YNJZe2hxg7AD4MytxnK6WTGV3v238t6qy6wX4rqFlv+Cb0Gp+GU8J41gMZvmVb" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    }
  }
}, {
  "id" : "c36199b3-341c-4a75-a5e7-d3bef3cfa99d",
  "httpRequest" : {
    "method" : "DELETE",
    "path" : "/api/v2/security_monitoring/rules/dcp-y6y-mpk",
    "headers" : {
      "Accept" : [ "application/json" ],
      "JAVA-TEST-NAME" : [ "rulesCrudTest" ],
      "DD-OPERATION-ID" : [ "deleteSecurityMonitoringRule" ],
      "Content-Type" : [ "application/json" ],
      "Connection" : [ "close" ],
      "Content-Length" : [ "0" ]
    },
    "keepAlive" : false,
    "secure" : true
  },
  "times" : {
    "remainingTimes" : 1
  },
  "timeToLive" : {
    "unlimited" : true
  },
  "httpResponse" : {
    "statusCode" : 204,
    "reasonPhrase" : "No Content",
    "headers" : {
      "Date" : [ "Tue, 24 Nov 2020 11:45:17 GMT" ],
      "Content-Length" : [ "2" ],
      "Connection" : [ "keep-alive" ],
      "Pragma" : [ "no-cache" ],
      "Cache-Control" : [ "no-cache" ],
      "Set-Cookie" : [ "DD-PSHARD=233; Max-Age=604800; Path=/; expires=Tue, 01-Dec-2020 11:45:17 GMT; secure; HttpOnly" ],
      "X-DD-VERSION" : [ "35.3423768" ],
      "Content-Disposition" : [ "inline" ],
      "X-DD-Debug" : [ "IEUzjgpnyUrp74lH2dqPweGXNQU7es3CY44HHPIdy7aSNeimMebMvcKCoCgyWWVx" ],
      "DD-POOL" : [ "dogweb" ],
      "Content-Security-Policy" : [ "frame-ancestors 'self'; report-uri https://api.datadoghq.com/csp-report" ],
      "X-Frame-Options" : [ "SAMEORIGIN" ],
      "X-Content-Type-Options" : [ "nosniff" ],
      "Strict-Transport-Security" : [ "max-age=15724800;" ]
    },
    "cookies" : {
      "DD-PSHARD" : "233"
    }
  }
}]