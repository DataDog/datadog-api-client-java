/*
 * Unless explicitly stated otherwise all files in this repository are licensed under the Apache-2.0 License.
 * This product includes software developed at Datadog (https://www.datadoghq.com/).
 * Copyright 2019-Present Datadog, Inc.
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */

package com.datadog.api.v1.client;

import org.apache.commons.io.IOUtils;

import java.io.IOException;
import java.util.function.BooleanSupplier;

public class TestUtils {
    public static class RetryException extends Exception {
        public RetryException(String message){
            super(message);
        }
    }

    public static void retry(int interval, int count, BooleanSupplier call) throws RetryException {
        for(int i = 0; i < count; i++) {
            if(call.getAsBoolean()) {
                return;
            }
            try {
                Thread.sleep(interval * 1000);
            } catch(InterruptedException e) {
                return;
            }
        }
        throw new RetryException(String.format("Retry error: failed to satisfy the condition after %d times", count));
    }

    public static String getFixture(String path) throws IOException {
        return IOUtils.toString(TestUtils.class.getResourceAsStream(path), "UTF-8");
    }
}
